<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Anshull Garg - The Conversational Portfolio</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
/* ========================================
   RESET & BASE
   ======================================== */
*, *::before, *::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

:root {
  --bg-deep: #0A0A0F;
  --bg-chat: #0E0E14;
  --bubble-user: #1E1E2E;
  --bubble-bot: #161620;
  --bubble-bot-border: #2A2A3A;
  --accent: #C87941;
  --accent-glow: rgba(200, 121, 65, 0.25);
  --accent-dim: rgba(200, 121, 65, 0.12);
  --text-primary: #E8E0D0;
  --text-secondary: #9A9AB0;
  --text-muted: #6A6A80;
  --card-bg: #12121C;
  --card-border: #1E1E30;
  --input-bg: #14141E;
  --input-border: #2A2A3A;
  --success: #4ADE80;
  --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  --font-mono: 'JetBrains Mono', 'Fira Code', monospace;
}

html {
  font-size: 16px;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  font-family: var(--font-sans);
  background: var(--bg-deep);
  color: var(--text-primary);
  height: 100vh;
  height: 100dvh;
  overflow: hidden;
  position: relative;
}

/* ========================================
   ANIMATED BACKGROUND
   ======================================== */
.bg-canvas {
  position: fixed;
  inset: 0;
  z-index: 0;
  overflow: hidden;
}

.bg-gradient-orb {
  position: absolute;
  border-radius: 50%;
  filter: blur(120px);
  opacity: 0.08;
  animation: orbFloat 20s ease-in-out infinite;
}

.bg-gradient-orb:nth-child(1) {
  width: 600px;
  height: 600px;
  background: var(--accent);
  top: -200px;
  right: -100px;
  animation-delay: 0s;
}

.bg-gradient-orb:nth-child(2) {
  width: 500px;
  height: 500px;
  background: #5B4FD4;
  bottom: -150px;
  left: -100px;
  animation-delay: -7s;
}

.bg-gradient-orb:nth-child(3) {
  width: 400px;
  height: 400px;
  background: var(--accent);
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  animation-delay: -14s;
  opacity: 0.04;
}

@keyframes orbFloat {
  0%, 100% { transform: translate(0, 0) scale(1); }
  25% { transform: translate(30px, -40px) scale(1.05); }
  50% { transform: translate(-20px, 20px) scale(0.95); }
  75% { transform: translate(15px, 35px) scale(1.02); }
}

/* Noise texture overlay */
.bg-noise {
  position: fixed;
  inset: 0;
  z-index: 1;
  opacity: 0.03;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  pointer-events: none;
}

/* ========================================
   CHAT LAYOUT
   ======================================== */
.chat-app {
  position: relative;
  z-index: 2;
  display: flex;
  flex-direction: column;
  height: 100vh;
  height: 100dvh;
  max-width: 720px;
  margin: 0 auto;
}

/* Header */
.chat-header {
  flex-shrink: 0;
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px 20px;
  border-bottom: 1px solid var(--card-border);
  background: rgba(10, 10, 15, 0.85);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
}

.header-avatar {
  width: 40px;
  height: 40px;
  border-radius: 12px;
  background: linear-gradient(135deg, var(--accent), #A0612E);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 14px;
  color: #fff;
  flex-shrink: 0;
  letter-spacing: 0.5px;
}

.header-info h1 {
  font-size: 15px;
  font-weight: 600;
  color: var(--text-primary);
  line-height: 1.3;
}

.header-status {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  color: var(--text-secondary);
}

.status-dot {
  width: 7px;
  height: 7px;
  border-radius: 50%;
  background: var(--success);
  animation: statusPulse 2s ease-in-out infinite;
}

@keyframes statusPulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.4; }
}

/* Messages area */
.chat-messages {
  flex: 1;
  overflow-y: auto;
  padding: 20px 16px;
  scroll-behavior: smooth;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.chat-messages::-webkit-scrollbar {
  width: 5px;
}

.chat-messages::-webkit-scrollbar-track {
  background: transparent;
}

.chat-messages::-webkit-scrollbar-thumb {
  background: var(--input-border);
  border-radius: 10px;
}

/* Message rows */
.message-row {
  display: flex;
  gap: 10px;
  max-width: 92%;
  animation: msgSlideIn 0.35s cubic-bezier(0.22, 0.61, 0.36, 1) forwards;
  opacity: 0;
}

.message-row.user {
  align-self: flex-end;
  flex-direction: row-reverse;
}

.message-row.bot {
  align-self: flex-start;
}

@keyframes msgSlideIn {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Avatar in messages */
.msg-avatar {
  width: 32px;
  height: 32px;
  border-radius: 10px;
  background: linear-gradient(135deg, var(--accent), #A0612E);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 11px;
  color: #fff;
  flex-shrink: 0;
  margin-top: 2px;
  letter-spacing: 0.3px;
}

/* Bubbles */
.msg-bubble {
  padding: 12px 16px;
  border-radius: 16px;
  line-height: 1.6;
  font-size: 14.5px;
  position: relative;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

.user .msg-bubble {
  background: var(--bubble-user);
  border-top-right-radius: 4px;
  color: var(--text-primary);
}

.bot .msg-bubble {
  background: var(--bubble-bot);
  border: 1px solid var(--bubble-bot-border);
  border-top-left-radius: 4px;
  color: var(--text-primary);
}

.msg-timestamp {
  font-size: 11px;
  color: var(--text-muted);
  margin-top: 4px;
  padding: 0 4px;
}

.user .msg-timestamp {
  text-align: right;
}

/* ========================================
   TYPING INDICATOR
   ======================================== */
.typing-indicator {
  display: flex;
  gap: 5px;
  padding: 16px 18px;
  align-items: center;
}

.typing-indicator span {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--text-muted);
  animation: typingBounce 1.4s ease-in-out infinite;
}

.typing-indicator span:nth-child(2) {
  animation-delay: 0.15s;
}

.typing-indicator span:nth-child(3) {
  animation-delay: 0.3s;
}

@keyframes typingBounce {
  0%, 60%, 100% {
    transform: translateY(0);
    opacity: 0.4;
  }
  30% {
    transform: translateY(-8px);
    opacity: 1;
  }
}

/* ========================================
   RICH CONTENT: CARDS
   ======================================== */
.rich-card {
  background: var(--card-bg);
  border: 1px solid var(--card-border);
  border-radius: 12px;
  padding: 16px;
  margin-top: 12px;
  transition: border-color 0.3s ease;
}

.rich-card:hover {
  border-color: rgba(200, 121, 65, 0.3);
}

/* About card */
.about-card .about-header {
  display: flex;
  align-items: center;
  gap: 14px;
  margin-bottom: 12px;
}

.about-card .about-avatar {
  width: 52px;
  height: 52px;
  border-radius: 14px;
  background: linear-gradient(135deg, var(--accent), #A0612E);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 18px;
  color: #fff;
  flex-shrink: 0;
}

.about-card .about-name {
  font-size: 17px;
  font-weight: 600;
}

.about-card .about-role {
  font-size: 13px;
  color: var(--accent);
  font-weight: 500;
  margin-top: 2px;
}

.about-card .about-bio {
  font-size: 13.5px;
  line-height: 1.7;
  color: var(--text-secondary);
  margin-bottom: 14px;
}

.social-links {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.social-link {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  background: rgba(200, 121, 65, 0.08);
  border: 1px solid rgba(200, 121, 65, 0.2);
  border-radius: 8px;
  color: var(--accent);
  font-size: 12.5px;
  font-weight: 500;
  text-decoration: none;
  transition: all 0.2s ease;
  cursor: pointer;
}

.social-link:hover {
  background: rgba(200, 121, 65, 0.15);
  border-color: var(--accent);
}

/* Project cards */
.project-cards {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-top: 12px;
}

.project-card {
  background: var(--card-bg);
  border: 1px solid var(--card-border);
  border-radius: 12px;
  padding: 16px;
  opacity: 0;
  animation: cardFadeIn 0.4s ease forwards;
  transition: border-color 0.3s ease, transform 0.2s ease;
}

.project-card:hover {
  border-color: rgba(200, 121, 65, 0.3);
  transform: translateY(-1px);
}

.project-card:nth-child(1) { animation-delay: 0.1s; }
.project-card:nth-child(2) { animation-delay: 0.3s; }
.project-card:nth-child(3) { animation-delay: 0.5s; }

@keyframes cardFadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.project-card .project-title {
  font-size: 15px;
  font-weight: 600;
  margin-bottom: 6px;
  color: var(--text-primary);
}

.project-card .project-desc {
  font-size: 13px;
  color: var(--text-secondary);
  line-height: 1.6;
  margin-bottom: 12px;
}

.project-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-bottom: 12px;
}

.project-tag {
  font-size: 11.5px;
  padding: 3px 9px;
  border-radius: 6px;
  background: rgba(200, 121, 65, 0.1);
  color: var(--accent);
  font-family: var(--font-mono);
  font-weight: 500;
  border: 1px solid rgba(200, 121, 65, 0.15);
}

.project-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 7px 14px;
  background: var(--accent);
  color: #fff;
  border: none;
  border-radius: 8px;
  font-size: 12.5px;
  font-weight: 600;
  cursor: pointer;
  font-family: var(--font-sans);
  transition: all 0.2s ease;
}

.project-btn:hover {
  background: #D4884E;
  transform: translateY(-1px);
}

.project-btn svg {
  width: 14px;
  height: 14px;
}

/* ========================================
   RICH CONTENT: SKILLS
   ======================================== */
.skills-section {
  margin-top: 12px;
}

.skill-category {
  margin-bottom: 14px;
  opacity: 0;
  animation: cardFadeIn 0.4s ease forwards;
}

.skill-category:nth-child(1) { animation-delay: 0.1s; }
.skill-category:nth-child(2) { animation-delay: 0.25s; }
.skill-category:nth-child(3) { animation-delay: 0.4s; }
.skill-category:nth-child(4) { animation-delay: 0.55s; }

.skill-category-title {
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1.2px;
  color: var(--text-muted);
  margin-bottom: 8px;
}

.skill-pills {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.skill-pill {
  font-size: 12.5px;
  padding: 5px 12px;
  border-radius: 8px;
  background: var(--card-bg);
  border: 1px solid var(--card-border);
  color: var(--text-primary);
  font-weight: 500;
  transition: all 0.25s ease;
  cursor: default;
  position: relative;
  overflow: hidden;
}

.skill-pill::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at center, var(--accent-glow), transparent 70%);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.skill-pill:hover {
  border-color: var(--accent);
  color: var(--accent);
}

.skill-pill:hover::before {
  opacity: 1;
}

/* ========================================
   RICH CONTENT: TIMELINE
   ======================================== */
.timeline {
  margin-top: 12px;
  position: relative;
  padding-left: 20px;
}

.timeline::before {
  content: '';
  position: absolute;
  left: 4px;
  top: 8px;
  bottom: 8px;
  width: 2px;
  background: var(--card-border);
  border-radius: 1px;
}

.timeline-entry {
  position: relative;
  padding-bottom: 20px;
  opacity: 0;
  animation: cardFadeIn 0.4s ease forwards;
}

.timeline-entry:last-child {
  padding-bottom: 0;
}

.timeline-entry:nth-child(1) { animation-delay: 0.15s; }
.timeline-entry:nth-child(2) { animation-delay: 0.35s; }
.timeline-entry:nth-child(3) { animation-delay: 0.55s; }

.timeline-entry::before {
  content: '';
  position: absolute;
  left: -20px;
  top: 7px;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--accent);
  border: 2px solid var(--bg-deep);
  z-index: 1;
}

.timeline-entry:first-child::before {
  box-shadow: 0 0 0 3px var(--accent-glow);
}

.timeline-role {
  font-size: 14.5px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 2px;
}

.timeline-company {
  font-size: 13px;
  color: var(--accent);
  font-weight: 500;
  margin-bottom: 3px;
}

.timeline-period {
  font-size: 12px;
  color: var(--text-muted);
  font-family: var(--font-mono);
  margin-bottom: 6px;
}

.timeline-desc {
  font-size: 13px;
  color: var(--text-secondary);
  line-height: 1.6;
}

/* ========================================
   RICH CONTENT: CONTACT CARD
   ======================================== */
.contact-card {
  background: var(--card-bg);
  border: 1px solid var(--card-border);
  border-radius: 12px;
  padding: 18px;
  margin-top: 12px;
}

.contact-card .contact-row {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 0;
  font-size: 13.5px;
  color: var(--text-secondary);
}

.contact-card .contact-row + .contact-row {
  border-top: 1px solid var(--card-border);
}

.contact-card .contact-label {
  color: var(--text-muted);
  font-size: 12px;
  min-width: 60px;
  flex-shrink: 0;
}

.contact-card .contact-value {
  color: var(--accent);
  font-weight: 500;
  word-break: break-all;
}

.contact-card .contact-value a {
  color: var(--accent);
  text-decoration: none;
  transition: opacity 0.2s;
}

.contact-card .contact-value a:hover {
  opacity: 0.8;
  text-decoration: underline;
}

.schedule-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  width: 100%;
  margin-top: 14px;
  padding: 11px 20px;
  background: linear-gradient(135deg, var(--accent), #A0612E);
  color: #fff;
  border: none;
  border-radius: 10px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  font-family: var(--font-sans);
  transition: all 0.25s ease;
}

.schedule-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 6px 20px var(--accent-glow);
}

/* Resume download */
.download-btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  margin-top: 12px;
  padding: 10px 18px;
  background: var(--card-bg);
  border: 1px solid var(--accent);
  color: var(--accent);
  border-radius: 10px;
  font-size: 13.5px;
  font-weight: 600;
  cursor: pointer;
  font-family: var(--font-sans);
  transition: all 0.25s ease;
}

.download-btn:hover {
  background: var(--accent);
  color: #fff;
}

.download-btn svg {
  width: 16px;
  height: 16px;
}

/* ========================================
   SUGGESTED CHIPS
   ======================================== */
.suggestions-bar {
  flex-shrink: 0;
  padding: 8px 16px;
  display: flex;
  gap: 8px;
  overflow-x: auto;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.suggestions-bar::-webkit-scrollbar {
  display: none;
}

.suggestion-chip {
  flex-shrink: 0;
  padding: 7px 14px;
  border-radius: 20px;
  border: 1px solid var(--input-border);
  background: var(--input-bg);
  color: var(--text-secondary);
  font-size: 13px;
  font-family: var(--font-sans);
  cursor: pointer;
  transition: all 0.2s ease;
  white-space: nowrap;
}

.suggestion-chip:hover {
  border-color: var(--accent);
  color: var(--accent);
  background: var(--accent-dim);
}

/* ========================================
   INPUT BAR
   ======================================== */
.chat-input-bar {
  flex-shrink: 0;
  padding: 12px 16px 20px;
  background: rgba(10, 10, 15, 0.85);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-top: 1px solid var(--card-border);
}

.input-wrapper {
  display: flex;
  align-items: center;
  gap: 10px;
  background: var(--input-bg);
  border: 1px solid var(--input-border);
  border-radius: 14px;
  padding: 4px 6px 4px 16px;
  transition: border-color 0.2s ease;
}

.input-wrapper:focus-within {
  border-color: var(--accent);
}

.chat-input {
  flex: 1;
  background: transparent;
  border: none;
  outline: none;
  color: var(--text-primary);
  font-size: 14.5px;
  font-family: var(--font-sans);
  padding: 10px 0;
  caret-color: var(--accent);
}

.chat-input::placeholder {
  color: var(--text-muted);
}

.send-btn {
  width: 38px;
  height: 38px;
  border-radius: 10px;
  border: none;
  background: var(--accent);
  color: #fff;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  transition: all 0.2s ease;
}

.send-btn:hover {
  background: #D4884E;
}

.send-btn:disabled {
  opacity: 0.35;
  cursor: not-allowed;
}

.send-btn svg {
  width: 18px;
  height: 18px;
}

/* ========================================
   INLINE CHIPS IN BOT MESSAGES
   ======================================== */
.inline-chips {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-top: 12px;
}

.inline-chip {
  padding: 6px 12px;
  border-radius: 16px;
  border: 1px solid var(--input-border);
  background: var(--card-bg);
  color: var(--text-secondary);
  font-size: 12.5px;
  font-family: var(--font-sans);
  cursor: pointer;
  transition: all 0.2s ease;
}

.inline-chip:hover {
  border-color: var(--accent);
  color: var(--accent);
}

/* ========================================
   CODE BLOCKS
   ======================================== */
code {
  font-family: var(--font-mono);
  background: rgba(200, 121, 65, 0.1);
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 13px;
  color: var(--accent);
}

/* ========================================
   FUN FACT CARD
   ======================================== */
.fun-fact-card {
  background: var(--card-bg);
  border: 1px solid var(--card-border);
  border-radius: 12px;
  padding: 16px;
  margin-top: 12px;
  border-left: 3px solid var(--accent);
}

.fun-fact-label {
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1.2px;
  color: var(--accent);
  margin-bottom: 8px;
}

.fun-fact-text {
  font-size: 14px;
  color: var(--text-primary);
  line-height: 1.6;
}

/* ========================================
   RESPONSIVE
   ======================================== */
@media (max-width: 600px) {
  .chat-header {
    padding: 12px 14px;
  }

  .chat-messages {
    padding: 14px 10px;
  }

  .msg-bubble {
    padding: 10px 14px;
    font-size: 14px;
  }

  .message-row {
    max-width: 96%;
  }

  .suggestions-bar {
    padding: 6px 10px;
  }

  .chat-input-bar {
    padding: 10px 10px 16px;
  }

  .msg-avatar {
    width: 28px;
    height: 28px;
    font-size: 10px;
  }

  .project-card {
    padding: 14px;
  }
}

/* Ensure safe area for iOS */
@supports (padding-bottom: env(safe-area-inset-bottom)) {
  .chat-input-bar {
    padding-bottom: calc(16px + env(safe-area-inset-bottom));
  }
}
</style>
</head>
<body>

<!-- Background -->
<div class="bg-canvas">
  <div class="bg-gradient-orb"></div>
  <div class="bg-gradient-orb"></div>
  <div class="bg-gradient-orb"></div>
</div>
<div class="bg-noise"></div>

<!-- Chat App -->
<div class="chat-app">
  <!-- Header -->
  <header class="chat-header">
    <div class="header-avatar">AG</div>
    <div class="header-info">
      <h1>Anshull Garg</h1>
      <div class="header-status">
        <span class="status-dot"></span>
        <span>Online now</span>
      </div>
    </div>
  </header>

  <!-- Messages -->
  <div class="chat-messages" id="chatMessages"></div>

  <!-- Suggestions -->
  <div class="suggestions-bar" id="suggestionsBar">
    <button class="suggestion-chip" data-msg="Who are you?">Who are you?</button>
    <button class="suggestion-chip" data-msg="Show me your projects">Show me your projects</button>
    <button class="suggestion-chip" data-msg="What's your tech stack?">What's your tech stack?</button>
    <button class="suggestion-chip" data-msg="Tell me about Walmart">Tell me about Walmart</button>
    <button class="suggestion-chip" data-msg="How can I hire you?">How can I hire you?</button>
  </div>

  <!-- Input -->
  <div class="chat-input-bar">
    <div class="input-wrapper">
      <input
        type="text"
        class="chat-input"
        id="chatInput"
        placeholder="Ask me anything..."
        autocomplete="off"
        aria-label="Type a message"
      />
      <button class="send-btn" id="sendBtn" aria-label="Send message">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M22 2L11 13"/>
          <path d="M22 2L15 22L11 13L2 9L22 2Z"/>
        </svg>
      </button>
    </div>
  </div>
</div>

<script>
// ============================================================
// CONVERSATIONAL PORTFOLIO ENGINE
// ============================================================

const messagesContainer = document.getElementById('chatMessages');
const chatInput = document.getElementById('chatInput');
const sendBtn = document.getElementById('sendBtn');
const suggestionsBar = document.getElementById('suggestionsBar');

let isTyping = false;
let funFactIndex = 0;

// ---- Time Formatting ----
function getTimestamp() {
  const now = new Date();
  return now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
}

// ---- Scroll to bottom ----
function scrollToBottom() {
  requestAnimationFrame(() => {
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
  });
}

// ---- Add user message ----
function addUserMessage(text) {
  const row = document.createElement('div');
  row.className = 'message-row user';
  row.innerHTML = `
    <div>
      <div class="msg-bubble">${escapeHTML(text)}</div>
      <div class="msg-timestamp">${getTimestamp()}</div>
    </div>
  `;
  messagesContainer.appendChild(row);
  scrollToBottom();
}

// ---- Add bot message ----
function addBotMessage(html) {
  const row = document.createElement('div');
  row.className = 'message-row bot';
  row.innerHTML = `
    <div class="msg-avatar">AG</div>
    <div>
      <div class="msg-bubble">${html}</div>
      <div class="msg-timestamp">${getTimestamp()}</div>
    </div>
  `;
  messagesContainer.appendChild(row);
  scrollToBottom();

  // Bind inline chips if any
  row.querySelectorAll('.inline-chip').forEach(chip => {
    chip.addEventListener('click', () => {
      if (!isTyping) sendMessage(chip.textContent);
    });
  });

  // Bind project buttons (mock)
  row.querySelectorAll('.project-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      btn.textContent = 'Coming Soon';
      btn.style.opacity = '0.6';
      btn.style.cursor = 'default';
    });
  });

  // Bind download button (mock)
  row.querySelectorAll('.download-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      btn.innerHTML = `
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        Download Started
      `;
      btn.style.background = 'var(--accent)';
      btn.style.color = '#fff';
    });
  });

  // Schedule button (mock)
  row.querySelectorAll('.schedule-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      btn.textContent = 'Request Sent!';
      btn.style.opacity = '0.7';
    });
  });
}

// ---- Show typing indicator ----
function showTypingIndicator() {
  const row = document.createElement('div');
  row.className = 'message-row bot';
  row.id = 'typingRow';
  row.innerHTML = `
    <div class="msg-avatar">AG</div>
    <div>
      <div class="msg-bubble">
        <div class="typing-indicator">
          <span></span><span></span><span></span>
        </div>
      </div>
    </div>
  `;
  messagesContainer.appendChild(row);
  scrollToBottom();
}

function removeTypingIndicator() {
  const el = document.getElementById('typingRow');
  if (el) el.remove();
}

// ---- HTML escape ----
function escapeHTML(str) {
  const div = document.createElement('div');
  div.textContent = str;
  return div.innerHTML;
}

// ---- Response Matching ----
function getResponse(input) {
  const q = input.toLowerCase().trim();

  // Greeting
  if (/^(hi|hello|hey|sup|yo|greetings|howdy|hola|what'?s up|whats up)/.test(q)) {
    return {
      delay: 1000,
      html: `Hey! I'm <strong style="color:var(--accent)">Anshull Garg</strong>, Software Developer at <strong>Walmart</strong>. I build systems that serve millions. Ask me anything -- my projects, skills, experience, or even fun facts about me.`
    };
  }

  // About / Who
  if (/who|about|yourself|introduce|tell me about you|background/.test(q)) {
    return {
      delay: 1500,
      html: `
        Here's a bit about me:
        <div class="rich-card about-card">
          <div class="about-header">
            <div class="about-avatar">AG</div>
            <div>
              <div class="about-name">Anshull Garg</div>
              <div class="about-role">Software Developer @ Walmart</div>
            </div>
          </div>
          <div class="about-bio">
            I'm a software developer who thrives at the intersection of scale and craft. At Walmart, I work on systems that handle millions of requests daily -- building reliable, performant backend services and the frontends that bring them to life. I care deeply about clean architecture, developer experience, and shipping products that genuinely help people. Outside of work, I'm endlessly curious about distributed systems, open-source tooling, and the art of writing code that reads like prose.
          </div>
          <div class="social-links">
            <a class="social-link" href="https://github.com/anshullgarg" target="_blank" rel="noopener">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/></svg>
              GitHub
            </a>
            <a class="social-link" href="https://linkedin.com/in/anshullgarg" target="_blank" rel="noopener">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
              LinkedIn
            </a>
            <a class="social-link" href="mailto:anshullgarg@gmail.com">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M22 7l-10 7L2 7"/></svg>
              Email
            </a>
          </div>
        </div>
      `
    };
  }

  // Projects
  if (/project|work|built|portfolio|ship|made|create/.test(q)) {
    return {
      delay: 1800,
      html: `
        Here are some of the things I've built:
        <div class="project-cards">
          <div class="project-card">
            <div class="project-title">Real-Time Inventory Sync Engine</div>
            <div class="project-desc">Built a high-throughput event-driven system at Walmart that synchronizes inventory data across 4,700+ stores in near real-time. Handles millions of state transitions daily with sub-second latency.</div>
            <div class="project-tags">
              <span class="project-tag">Java</span>
              <span class="project-tag">Kafka</span>
              <span class="project-tag">Redis</span>
              <span class="project-tag">Kubernetes</span>
            </div>
            <button class="project-btn">
              View Details
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="M12 5l7 7-7 7"/></svg>
            </button>
          </div>
          <div class="project-card">
            <div class="project-title">Developer Portal & Internal Tools</div>
            <div class="project-desc">Designed and developed a unified developer experience platform serving 2,000+ engineers. Features API documentation, service health dashboards, and one-click deployment workflows.</div>
            <div class="project-tags">
              <span class="project-tag">React</span>
              <span class="project-tag">TypeScript</span>
              <span class="project-tag">Node.js</span>
              <span class="project-tag">GraphQL</span>
            </div>
            <button class="project-btn">
              View Details
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="M12 5l7 7-7 7"/></svg>
            </button>
          </div>
          <div class="project-card">
            <div class="project-title">Smart Pricing Optimization Service</div>
            <div class="project-desc">Contributed to a ML-backed pricing service that dynamically adjusts product prices based on demand signals, competitor data, and inventory levels. Improved margin efficiency by 12%.</div>
            <div class="project-tags">
              <span class="project-tag">Python</span>
              <span class="project-tag">FastAPI</span>
              <span class="project-tag">PostgreSQL</span>
              <span class="project-tag">Docker</span>
            </div>
            <button class="project-btn">
              View Details
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="M12 5l7 7-7 7"/></svg>
            </button>
          </div>
        </div>
      `
    };
  }

  // Skills
  if (/skill|tech|stack|technolog|language|framework|tool/.test(q)) {
    return {
      delay: 1400,
      html: `
        Here's my current tech stack, broken down by domain:
        <div class="skills-section">
          <div class="skill-category">
            <div class="skill-category-title">Frontend</div>
            <div class="skill-pills">
              <span class="skill-pill">React</span>
              <span class="skill-pill">TypeScript</span>
              <span class="skill-pill">Next.js</span>
              <span class="skill-pill">Tailwind CSS</span>
              <span class="skill-pill">Redux</span>
              <span class="skill-pill">HTML/CSS</span>
              <span class="skill-pill">JavaScript</span>
            </div>
          </div>
          <div class="skill-category">
            <div class="skill-category-title">Backend</div>
            <div class="skill-pills">
              <span class="skill-pill">Java</span>
              <span class="skill-pill">Spring Boot</span>
              <span class="skill-pill">Node.js</span>
              <span class="skill-pill">Python</span>
              <span class="skill-pill">GraphQL</span>
              <span class="skill-pill">REST APIs</span>
              <span class="skill-pill">FastAPI</span>
            </div>
          </div>
          <div class="skill-category">
            <div class="skill-category-title">Infrastructure</div>
            <div class="skill-pills">
              <span class="skill-pill">Kubernetes</span>
              <span class="skill-pill">Docker</span>
              <span class="skill-pill">Kafka</span>
              <span class="skill-pill">Redis</span>
              <span class="skill-pill">PostgreSQL</span>
              <span class="skill-pill">Azure</span>
              <span class="skill-pill">CI/CD</span>
              <span class="skill-pill">Terraform</span>
            </div>
          </div>
          <div class="skill-category">
            <div class="skill-category-title">Practices</div>
            <div class="skill-pills">
              <span class="skill-pill">System Design</span>
              <span class="skill-pill">Agile/Scrum</span>
              <span class="skill-pill">TDD</span>
              <span class="skill-pill">Code Review</span>
              <span class="skill-pill">Observability</span>
              <span class="skill-pill">Microservices</span>
            </div>
          </div>
        </div>
      `
    };
  }

  // Experience / Walmart
  if (/experience|career|walmart|job|history|resume|employ|where.*work|company/.test(q) && !/download|cv/.test(q)) {
    return {
      delay: 1600,
      html: `
        Here's my professional journey so far:
        <div class="timeline">
          <div class="timeline-entry">
            <div class="timeline-role">Software Developer</div>
            <div class="timeline-company">Walmart Global Tech</div>
            <div class="timeline-period">2022 -- Present</div>
            <div class="timeline-desc">Building large-scale distributed systems that power Walmart's supply chain and e-commerce infrastructure. Working across the full stack -- from React frontends to Java/Kafka backend services -- handling millions of transactions daily across 4,700+ stores.</div>
          </div>
          <div class="timeline-entry">
            <div class="timeline-role">Software Engineering Intern</div>
            <div class="timeline-company">Walmart Global Tech</div>
            <div class="timeline-period">Summer 2021</div>
            <div class="timeline-desc">Developed internal tooling for the logistics team. Built a dashboard that reduced manual reporting time by 40% and was adopted by three cross-functional teams within the first month of launch.</div>
          </div>
          <div class="timeline-entry">
            <div class="timeline-role">Freelance Developer</div>
            <div class="timeline-company">Independent</div>
            <div class="timeline-period">2019 -- 2021</div>
            <div class="timeline-desc">Worked with startups and small businesses to design and ship web applications. Built everything from landing pages to full-stack SaaS products. Learned the value of shipping fast and iterating based on real user feedback.</div>
          </div>
        </div>
      `
    };
  }

  // Contact / Hire
  if (/hire|contact|email|reach|connect|call|meet|available|open to/.test(q)) {
    return {
      delay: 1200,
      html: `
        I'd love to connect. Here's how you can reach me:
        <div class="contact-card">
          <div class="contact-row">
            <span class="contact-label">Email</span>
            <span class="contact-value"><a href="mailto:anshullgarg@gmail.com">anshullgarg@gmail.com</a></span>
          </div>
          <div class="contact-row">
            <span class="contact-label">GitHub</span>
            <span class="contact-value"><a href="https://github.com/anshullgarg" target="_blank" rel="noopener">github.com/anshullgarg</a></span>
          </div>
          <div class="contact-row">
            <span class="contact-label">LinkedIn</span>
            <span class="contact-value"><a href="https://linkedin.com/in/anshullgarg" target="_blank" rel="noopener">linkedin.com/in/anshullgarg</a></span>
          </div>
          <button class="schedule-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4"/><path d="M8 2v4"/><path d="M3 10h18"/></svg>
            Schedule a Call
          </button>
        </div>
        <div style="margin-top:10px; font-size:13px; color:var(--text-secondary);">I typically respond within 24 hours. Looking forward to hearing from you.</div>
      `
    };
  }

  // Fun facts
  if (/fun|hobby|interesting|secret|random|fact|personal|outside work|free time/.test(q)) {
    const facts = [
      "I once debugged a production issue at 3 AM by reading Kafka consumer lag metrics like tea leaves. Fixed it in 20 minutes. Couldn't fall back asleep for three hours because the adrenaline was unreal.",
      "I have a rule: if I write the same script three times, it becomes a CLI tool. My dotfiles repo has over 40 custom aliases and shell functions at this point.",
      "My first 'real' program was a text-based RPG in Python when I was 16. The combat system was absurdly unbalanced, but I was hooked on the feeling of building something from nothing.",
      "I genuinely enjoy reading system design papers on weekends. The Google Spanner paper changed how I think about distributed consistency. I know that sounds intense, but it's the truth.",
      "I keep a 'lessons learned' journal for every major project. It's not glamorous, but looking back at past mistakes has saved me from repeating them more times than I can count.",
      "I can type at 130 WPM. Not because I practiced -- years of competitive online gaming just trained my fingers to move faster than my brain sometimes.",
      "Coffee preference: black, no sugar. I've calculated that I consume approximately 1,100 cups per year. I refuse to do the math on lifetime spending."
    ];
    const fact = facts[funFactIndex % facts.length];
    funFactIndex++;
    return {
      delay: 1300,
      html: `
        <div class="fun-fact-card">
          <div class="fun-fact-label">Fun Fact #${funFactIndex}</div>
          <div class="fun-fact-text">${fact}</div>
        </div>
        <div style="margin-top:10px; font-size:13px; color:var(--text-secondary);">Ask again for another one. I've got a few.</div>
      `
    };
  }

  // Resume / CV / Download
  if (/resume|cv|download|pdf/.test(q)) {
    return {
      delay: 1100,
      html: `
        Here's my resume. It covers my experience, education, skills, and key projects in a single page.
        <div style="margin-top:12px;">
          <button class="download-btn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
            Download Resume (PDF)
          </button>
        </div>
        <div style="margin-top:10px; font-size:13px; color:var(--text-secondary);">If you'd prefer a tailored version for a specific role, just let me know -- I'm happy to put one together.</div>
      `
    };
  }

  // Philosophy / approach / how do you work
  if (/philosophy|approach|how.*work|process|principle|value|believe/.test(q)) {
    return {
      delay: 1500,
      html: `
        My engineering philosophy boils down to a few core beliefs:
        <div class="rich-card" style="margin-top:12px;">
          <div style="margin-bottom:12px;">
            <strong style="color:var(--accent);">Ship, then iterate.</strong>
            <div style="font-size:13px; color:var(--text-secondary); margin-top:4px;">Perfect is the enemy of shipped. I'd rather get something into users' hands and improve it based on real feedback than polish it in isolation.</div>
          </div>
          <div style="margin-bottom:12px;">
            <strong style="color:var(--accent);">Readability over cleverness.</strong>
            <div style="font-size:13px; color:var(--text-secondary); margin-top:4px;">Code is read 10x more than it's written. I optimize for clarity -- future me (and my teammates) will thank present me.</div>
          </div>
          <div style="margin-bottom:12px;">
            <strong style="color:var(--accent);">Own the outcome, not just the ticket.</strong>
            <div style="font-size:13px; color:var(--text-secondary); margin-top:4px;">I think beyond the JIRA task. If something adjacent is broken or could be better, I'll raise it and often fix it.</div>
          </div>
          <div>
            <strong style="color:var(--accent);">Measure everything.</strong>
            <div style="font-size:13px; color:var(--text-secondary); margin-top:4px;">Intuition is valuable, but data wins arguments. I instrument my code, track metrics, and let numbers guide decisions.</div>
          </div>
        </div>
      `
    };
  }

  // Education
  if (/education|university|college|degree|study|school|academic/.test(q)) {
    return {
      delay: 1200,
      html: `
        <div class="timeline" style="margin-top:4px;">
          <div class="timeline-entry">
            <div class="timeline-role">Bachelor of Technology, Computer Science</div>
            <div class="timeline-company">Relevant University</div>
            <div class="timeline-period">2018 -- 2022</div>
            <div class="timeline-desc">Graduated with a strong foundation in data structures, algorithms, operating systems, and distributed computing. Participated in hackathons, contributed to open-source projects, and served as a teaching assistant for the intro to programming course.</div>
          </div>
        </div>
      `
    };
  }

  // Default fallback
  return {
    delay: 1000,
    html: `
      I'm not sure I have a specific answer for that, but here are some things you can ask me about:
      <div class="inline-chips">
        <button class="inline-chip">Who are you?</button>
        <button class="inline-chip">Show me your projects</button>
        <button class="inline-chip">What's your tech stack?</button>
        <button class="inline-chip">Tell me about Walmart</button>
        <button class="inline-chip">How can I hire you?</button>
        <button class="inline-chip">Fun facts</button>
        <button class="inline-chip">Your philosophy</button>
        <button class="inline-chip">Download resume</button>
      </div>
    `
  };
}

// ---- Send message flow ----
function sendMessage(text) {
  if (!text || !text.trim() || isTyping) return;

  const cleanText = text.trim();
  chatInput.value = '';
  isTyping = true;
  sendBtn.disabled = true;

  addUserMessage(cleanText);

  const response = getResponse(cleanText);

  // Show typing indicator after a brief pause
  setTimeout(() => {
    showTypingIndicator();
  }, 300);

  // Show response after delay
  setTimeout(() => {
    removeTypingIndicator();
    addBotMessage(response.html);
    isTyping = false;
    sendBtn.disabled = false;
    chatInput.focus();
  }, response.delay + 300);
}

// ---- Event Listeners ----
sendBtn.addEventListener('click', () => {
  sendMessage(chatInput.value);
});

chatInput.addEventListener('keydown', (e) => {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    sendMessage(chatInput.value);
  }
});

// Suggestion chips
suggestionsBar.querySelectorAll('.suggestion-chip').forEach(chip => {
  chip.addEventListener('click', () => {
    if (!isTyping) {
      sendMessage(chip.dataset.msg);
    }
  });
});

// ---- Welcome Message on Load ----
window.addEventListener('DOMContentLoaded', () => {
  setTimeout(() => {
    showTypingIndicator();
    setTimeout(() => {
      removeTypingIndicator();
      addBotMessage(`
        Welcome. I'm <strong style="color:var(--accent)">Anshull Garg</strong> -- a Software Developer at <strong>Walmart</strong>, where I build systems that handle scale most people only read about.
        <br><br>
        This isn't a typical portfolio. Think of it as a conversation. Ask me anything -- who I am, what I've built, my tech stack, or how to work together. Or just pick one of the suggestions below.
        <div class="inline-chips" style="margin-top:14px;">
          <button class="inline-chip">Who are you?</button>
          <button class="inline-chip">Show me your projects</button>
          <button class="inline-chip">What's your tech stack?</button>
          <button class="inline-chip">Fun facts</button>
        </div>
      `);
      chatInput.focus();
    }, 1500);
  }, 500);
});
</script>
</body>
</html>
