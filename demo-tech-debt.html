<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Anshull Garg | Software Developer</title>
<style>
/* ============================================================
   SECTION 0: BASE STYLES (the "clean" foundation)
   ============================================================ */

@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Comic+Neue:wght@700&family=Paprika&display=swap');

*, *::before, *::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

:root {
  --bg: #FFFFFF;
  --text: #1A1A1A;
  --accent: #2563EB;
  --accent-light: #DBEAFE;
  --gray-100: #F3F4F6;
  --gray-200: #E5E7EB;
  --gray-300: #D1D5DB;
  --gray-400: #9CA3AF;
  --gray-500: #6B7280;
  --gray-600: #4B5563;
  --gray-700: #374151;
  --radius: 12px;
  --shadow: 0 1px 3px rgba(0,0,0,0.08), 0 1px 2px rgba(0,0,0,0.06);
  --shadow-lg: 0 10px 25px rgba(0,0,0,0.08), 0 4px 10px rgba(0,0,0,0.04);
  --font-main: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  --font-mono: 'JetBrains Mono', monospace;
  --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

html {
  scroll-behavior: smooth;
  font-size: 16px;
}

body {
  font-family: var(--font-main);
  background: var(--bg);
  color: var(--text);
  line-height: 1.6;
  overflow-x: hidden;
  transition: all 0.8s ease;
}

body.refactored {
  background: var(--bg) !important;
  color: var(--text) !important;
}

a {
  color: var(--accent);
  text-decoration: none;
  transition: color var(--transition);
}

a:hover { color: #1D4ED8; }

/* ============================================================
   NAVIGATION
   ============================================================ */

nav {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  background: rgba(255,255,255,0.92);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border-bottom: 1px solid var(--gray-200);
  padding: 0 2rem;
  height: 64px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  transition: all var(--transition);
}

nav .logo {
  font-weight: 700;
  font-size: 1.125rem;
  letter-spacing: -0.02em;
  color: var(--text);
}

nav .nav-links {
  display: flex;
  gap: 2rem;
  list-style: none;
}

nav .nav-links a {
  color: var(--gray-600);
  font-size: 0.875rem;
  font-weight: 500;
  transition: color var(--transition);
}

nav .nav-links a:hover { color: var(--text); }

/* Debt meter in nav */
.debt-meter {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.75rem;
  font-family: var(--font-mono);
  color: var(--gray-500);
}

.debt-meter-bar {
  width: 80px;
  height: 6px;
  background: var(--gray-200);
  border-radius: 3px;
  overflow: hidden;
  position: relative;
}

.debt-meter-fill {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, #22C55E, #EAB308, #EF4444);
  border-radius: 3px;
  transition: width 0.5s ease;
}

/* ============================================================
   CODE COMMENT OVERLAYS (visible "tech debt" annotations)
   ============================================================ */

.code-comment {
  font-family: var(--font-mono);
  font-size: 0.7rem;
  color: #6A9955;
  background: rgba(30, 30, 30, 0.92);
  padding: 4px 10px;
  border-radius: 4px;
  position: absolute;
  white-space: nowrap;
  pointer-events: none;
  opacity: 0;
  transform: translateY(4px);
  transition: opacity 0.5s ease, transform 0.5s ease;
  z-index: 50;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  border-left: 2px solid #6A9955;
}

.code-comment.error {
  color: #F44747;
  border-left-color: #F44747;
}

.code-comment.warning {
  color: #CCA700;
  border-left-color: #CCA700;
}

.code-comment.hack {
  color: #CE9178;
  border-left-color: #CE9178;
}

.code-comment.visible {
  opacity: 1;
  transform: translateY(0);
}

/* Console log overlay */
.console-overlay {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: rgba(30, 30, 30, 0.95);
  font-family: var(--font-mono);
  font-size: 0.7rem;
  padding: 0;
  transform: translateY(100%);
  transition: transform 0.6s ease;
  z-index: 900;
  max-height: 200px;
  overflow-y: auto;
  border-top: 2px solid #333;
}

.console-overlay.visible {
  transform: translateY(0);
}

.console-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 6px 12px;
  background: #252526;
  border-bottom: 1px solid #333;
  position: sticky;
  top: 0;
}

.console-header span {
  color: #CCCCCC;
  font-size: 0.7rem;
}

.console-tab {
  padding: 2px 8px;
  color: #CCCCCC;
  border-bottom: 1px solid #007ACC;
}

.console-line {
  padding: 2px 12px;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  display: flex;
  align-items: flex-start;
  gap: 8px;
}

.console-line .prefix {
  color: #569CD6;
  flex-shrink: 0;
}

.console-line .msg { color: #CCCCCC; }
.console-line.warn .prefix { color: #CCA700; }
.console-line.warn .msg { color: #CCA700; }
.console-line.error .prefix { color: #F44747; }
.console-line.error .msg { color: #F44747; }
.console-line .source {
  margin-left: auto;
  color: #666;
  flex-shrink: 0;
}

/* Inline style tag that becomes visible */
.visible-style-tag {
  font-family: var(--font-mono);
  font-size: 0.65rem;
  color: #CE9178;
  background: rgba(30,30,30,0.88);
  padding: 2px 6px;
  border-radius: 3px;
  position: absolute;
  opacity: 0;
  transition: opacity 0.5s ease;
  pointer-events: none;
  z-index: 40;
}

.visible-style-tag.visible { opacity: 1; }

/* ============================================================
   SECTION 1: HERO (PIXEL-PERFECT)
   ============================================================ */

.section {
  min-height: 100vh;
  position: relative;
  overflow: hidden;
}

#hero {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 8rem 2rem 6rem;
  background: var(--bg);
}

.hero-badge {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.375rem 1rem;
  background: var(--accent-light);
  color: var(--accent);
  font-size: 0.8125rem;
  font-weight: 500;
  border-radius: 100px;
  margin-bottom: 2rem;
}

.hero-badge .dot {
  width: 6px;
  height: 6px;
  background: #22C55E;
  border-radius: 50%;
  animation: pulse-dot 2s ease infinite;
}

@keyframes pulse-dot {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.4; }
}

#hero h1 {
  font-size: clamp(3rem, 7vw, 5.5rem);
  font-weight: 700;
  letter-spacing: -0.04em;
  line-height: 1.05;
  margin-bottom: 1.5rem;
  color: var(--text);
}

#hero h1 .accent { color: var(--accent); }

#hero .subtitle {
  font-size: 1.25rem;
  color: var(--gray-500);
  max-width: 540px;
  line-height: 1.6;
  margin-bottom: 2.5rem;
  font-weight: 400;
}

.hero-cta {
  display: flex;
  gap: 1rem;
  align-items: center;
}

.btn-primary {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.875rem 2rem;
  background: var(--text);
  color: var(--bg);
  font-size: 0.9375rem;
  font-weight: 500;
  border-radius: 100px;
  border: none;
  cursor: pointer;
  transition: all var(--transition);
  font-family: var(--font-main);
}

.btn-primary:hover {
  background: var(--gray-700);
  transform: translateY(-1px);
  box-shadow: var(--shadow-lg);
}

.btn-secondary {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.875rem 2rem;
  background: transparent;
  color: var(--text);
  font-size: 0.9375rem;
  font-weight: 500;
  border-radius: 100px;
  border: 1.5px solid var(--gray-300);
  cursor: pointer;
  transition: all var(--transition);
  font-family: var(--font-main);
}

.btn-secondary:hover {
  border-color: var(--text);
  background: var(--gray-100);
}

.scroll-indicator {
  position: absolute;
  bottom: 2rem;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.5rem;
  color: var(--gray-400);
  font-size: 0.75rem;
  font-weight: 500;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  animation: float-down 2s ease infinite;
}

@keyframes float-down {
  0%, 100% { transform: translateX(-50%) translateY(0); }
  50% { transform: translateX(-50%) translateY(6px); }
}

.scroll-arrow {
  width: 20px;
  height: 20px;
  border-right: 2px solid var(--gray-400);
  border-bottom: 2px solid var(--gray-400);
  transform: rotate(45deg);
}

/* ============================================================
   SECTION 2: ABOUT (slight issues)
   ============================================================ */

#about {
  padding: 8rem 2rem;
  background: var(--gray-100);
  position: relative;
}

.section-header {
  text-align: center;
  margin-bottom: 4rem;
}

.section-header .label {
  font-family: var(--font-mono);
  font-size: 0.8125rem;
  color: var(--accent);
  font-weight: 500;
  margin-bottom: 0.75rem;
  display: block;
}

.section-header h2 {
  font-size: clamp(2rem, 4vw, 3rem);
  font-weight: 700;
  letter-spacing: -0.03em;
  line-height: 1.1;
}

.about-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 4rem;
  max-width: 1000px;
  margin: 0 auto;
  align-items: center;
}

.about-photo {
  width: 100%;
  aspect-ratio: 4/5;
  background: linear-gradient(135deg, var(--gray-200), var(--gray-300));
  border-radius: var(--radius);
  position: relative;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
}

.about-photo-initials {
  font-size: 4rem;
  font-weight: 700;
  color: var(--gray-400);
  letter-spacing: -0.02em;
}

.about-text h3 {
  font-size: 1.5rem;
  font-weight: 600;
  margin-bottom: 1rem;
  letter-spacing: -0.02em;
}

.about-text p {
  color: var(--gray-600);
  line-height: 1.75;
  margin-bottom: 1rem;
}

.about-stats {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1.5rem;
  margin-top: 2rem;
  padding-top: 2rem;
  border-top: 1px solid var(--gray-300);
}

.stat-item .stat-number {
  font-size: 1.75rem;
  font-weight: 700;
  color: var(--text);
  letter-spacing: -0.03em;
}

.stat-item .stat-label {
  font-size: 0.8125rem;
  color: var(--gray-500);
  margin-top: 0.25rem;
}

/* About - debt: misalignment class */
.about-debt .about-photo {
  transition: transform 0.5s ease;
}

.about-debt.active .about-photo {
  transform: translateY(2px);
}

/* ============================================================
   SECTION 3: PROJECTS (getting worse)
   ============================================================ */

#projects {
  padding: 8rem 2rem;
  background: var(--bg);
  position: relative;
}

.projects-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 2rem;
  max-width: 1100px;
  margin: 0 auto;
}

.project-card {
  background: var(--bg);
  border: 1px solid var(--gray-200);
  border-radius: var(--radius);
  overflow: hidden;
  transition: all var(--transition);
  position: relative;
}

.project-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-lg);
}

.project-card-image {
  height: 200px;
  background: linear-gradient(135deg, var(--accent-light), #C7D2FE);
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.project-card-image .project-icon {
  font-size: 3rem;
  opacity: 0.5;
}

.project-card-body {
  padding: 1.5rem;
}

.project-card-body h3 {
  font-size: 1.125rem;
  font-weight: 600;
  margin-bottom: 0.5rem;
  letter-spacing: -0.01em;
}

.project-card-body p {
  font-size: 0.875rem;
  color: var(--gray-500);
  line-height: 1.6;
  margin-bottom: 1rem;
}

.project-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.project-tag {
  padding: 0.25rem 0.75rem;
  background: var(--gray-100);
  color: var(--gray-600);
  font-size: 0.75rem;
  font-weight: 500;
  border-radius: 100px;
}

/* Projects - debt: broken card */
.project-card.debt-broken {
  transition: all 0.8s ease;
}

.projects-debt.active .project-card.debt-broken {
  border-color: #FCA5A5;
  background: #FFF7ED;
}

.projects-debt.active .project-card.debt-broken .project-card-image {
  background: linear-gradient(135deg, #FED7AA, #FDBA74);
}

.projects-debt.active .project-card.debt-wrong-font .project-card-body h3 {
  font-family: 'Comic Neue', cursive;
  font-size: 1.3rem;
}

/* ============================================================
   SECTION 4: SKILLS (bad)
   ============================================================ */

#skills {
  padding: 8rem 2rem;
  background: var(--gray-100);
  position: relative;
}

.skills-container {
  max-width: 900px;
  margin: 0 auto;
}

.skills-category {
  margin-bottom: 3rem;
}

.skills-category h3 {
  font-size: 1.125rem;
  font-weight: 600;
  margin-bottom: 1.25rem;
  letter-spacing: -0.01em;
}

.skills-list {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
}

.skill-chip {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.625rem 1.25rem;
  background: var(--bg);
  border: 1px solid var(--gray-200);
  border-radius: 100px;
  font-size: 0.875rem;
  font-weight: 500;
  color: var(--text);
  transition: all var(--transition);
  position: relative;
}

.skill-chip:hover {
  border-color: var(--accent);
  color: var(--accent);
  background: var(--accent-light);
}

.skill-bar-container {
  display: grid;
  grid-template-columns: 140px 1fr 40px;
  align-items: center;
  gap: 1rem;
  margin-bottom: 1rem;
}

.skill-bar-label {
  font-size: 0.875rem;
  font-weight: 500;
  color: var(--text);
}

.skill-bar {
  height: 8px;
  background: var(--gray-200);
  border-radius: 4px;
  overflow: hidden;
}

.skill-bar-fill {
  height: 100%;
  background: var(--accent);
  border-radius: 4px;
  transition: width 1s ease;
}

.skill-bar-value {
  font-size: 0.8125rem;
  font-weight: 600;
  color: var(--gray-600);
  font-family: var(--font-mono);
}

/* Skills debt: overlapping, z-index chaos */
.skills-debt.active .skills-category:nth-child(2) {
  transform: translateY(-20px);
  transition: transform 0.8s ease;
}

.skills-debt.active .skill-chip.debt-overlap {
  position: relative;
  z-index: 10;
  transform: translate(8px, -12px);
  transition: transform 0.8s ease;
}

.skills-debt.active .skill-chip.debt-zindex {
  z-index: 100;
  box-shadow: 0 4px 20px rgba(0,0,0,0.15);
  transform: scale(1.1) rotate(-2deg);
  transition: all 0.8s ease;
}

/* ============================================================
   SECTION 5: EXPERIENCE (disaster)
   ============================================================ */

#experience {
  padding: 8rem 2rem;
  background: var(--bg);
  position: relative;
  transition: all 0.8s ease;
}

.experience-container {
  max-width: 800px;
  margin: 0 auto;
}

.timeline {
  position: relative;
  padding-left: 2rem;
}

.timeline::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 2px;
  background: var(--gray-200);
}

.timeline-item {
  position: relative;
  padding-bottom: 3rem;
  padding-left: 2rem;
  transition: all 0.8s ease;
}

.timeline-item::before {
  content: '';
  position: absolute;
  left: -2rem;
  top: 6px;
  width: 12px;
  height: 12px;
  background: var(--accent);
  border-radius: 50%;
  border: 3px solid var(--bg);
  box-shadow: 0 0 0 2px var(--accent);
  transition: all 0.8s ease;
}

.timeline-item .company {
  font-size: 0.8125rem;
  font-weight: 600;
  color: var(--accent);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 0.25rem;
}

.timeline-item h3 {
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 0.25rem;
  letter-spacing: -0.01em;
}

.timeline-item .period {
  font-size: 0.8125rem;
  color: var(--gray-400);
  margin-bottom: 0.75rem;
  font-family: var(--font-mono);
}

.timeline-item p {
  color: var(--gray-600);
  font-size: 0.9375rem;
  line-height: 1.7;
}

.timeline-item .tech-list {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-top: 0.75rem;
}

.timeline-item .tech-tag {
  padding: 0.2rem 0.6rem;
  background: var(--gray-100);
  color: var(--gray-600);
  font-size: 0.7rem;
  font-weight: 500;
  border-radius: 4px;
  font-family: var(--font-mono);
}

/* Experience debt: full chaos */
.exp-debt.active .timeline-item:nth-child(1) {
  transform: rotate(-0.5deg) translateX(10px);
}

.exp-debt.active .timeline-item:nth-child(2) {
  transform: translateX(-15px) translateY(-8px);
}

.exp-debt.active .timeline-item:nth-child(2) h3 {
  color: #DC2626;
  transition: color 0.8s ease;
}

.exp-debt.active .timeline-item:nth-child(3) {
  transform: rotate(0.8deg);
  overflow: visible;
}

.exp-debt.active .timeline::before {
  background: linear-gradient(180deg, var(--gray-200), #F87171, #FCD34D, #4ADE80);
  transition: background 1s ease;
}

.exp-debt.active .timeline-item:nth-child(2)::before {
  background: #EF4444;
  box-shadow: 0 0 0 2px #EF4444, 0 0 12px rgba(239,68,68,0.4);
  transform: scale(1.5);
  transition: all 0.8s ease;
}

/* ============================================================
   SECTION 6: CONTACT (redemption)
   ============================================================ */

#contact {
  padding: 8rem 2rem;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  position: relative;
  background: var(--bg);
  transition: all 1s ease;
}

.contact-debt-message {
  max-width: 600px;
  margin-bottom: 3rem;
}

.contact-debt-message h2 {
  font-size: clamp(1.75rem, 4vw, 2.5rem);
  font-weight: 700;
  letter-spacing: -0.03em;
  line-height: 1.15;
  margin-bottom: 1rem;
}

.contact-debt-message p {
  font-size: 1.125rem;
  color: var(--gray-500);
  line-height: 1.7;
}

.refactor-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.75rem;
  padding: 1.125rem 3rem;
  background: linear-gradient(135deg, #22C55E, #16A34A);
  color: #FFFFFF;
  font-size: 1.125rem;
  font-weight: 600;
  border: none;
  border-radius: 100px;
  cursor: pointer;
  font-family: var(--font-mono);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
  box-shadow: 0 4px 15px rgba(34,197,94,0.3);
}

.refactor-btn:hover {
  transform: translateY(-2px) scale(1.02);
  box-shadow: 0 8px 25px rgba(34,197,94,0.4);
}

.refactor-btn:active {
  transform: translateY(0) scale(0.98);
}

.refactor-btn .spinner {
  display: none;
  width: 20px;
  height: 20px;
  border: 2px solid rgba(255,255,255,0.3);
  border-top-color: #fff;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Post-refactor clean state */
.clean-contact {
  opacity: 0;
  transform: translateY(30px);
  transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  pointer-events: none;
  position: absolute;
  width: 100%;
  padding: 2rem;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.clean-contact.visible {
  opacity: 1;
  transform: translateY(0);
  pointer-events: all;
  position: relative;
}

.clean-contact h2 {
  font-size: clamp(2rem, 5vw, 3rem);
  font-weight: 700;
  letter-spacing: -0.03em;
  line-height: 1.1;
  margin-bottom: 1rem;
}

.clean-contact p {
  font-size: 1.125rem;
  color: var(--gray-500);
  max-width: 500px;
  margin-bottom: 0.75rem;
  line-height: 1.7;
}

.clean-contact .lesson {
  font-size: 0.9375rem;
  color: var(--gray-400);
  font-style: italic;
  max-width: 460px;
  margin-top: 1.5rem;
  padding-top: 1.5rem;
  border-top: 1px solid var(--gray-200);
  line-height: 1.7;
}

.clean-links {
  display: flex;
  gap: 1rem;
  margin-top: 2.5rem;
  flex-wrap: wrap;
  justify-content: center;
}

.clean-links a {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.75rem 1.5rem;
  border: 1.5px solid var(--gray-200);
  border-radius: 100px;
  color: var(--text);
  font-size: 0.875rem;
  font-weight: 500;
  transition: all var(--transition);
}

.clean-links a:hover {
  border-color: var(--text);
  background: var(--text);
  color: var(--bg);
}

/* Refactoring animation overlay */
.refactor-overlay {
  position: fixed;
  inset: 0;
  background: #1E1E1E;
  z-index: 10000;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.5s ease;
}

.refactor-overlay.visible {
  opacity: 1;
  pointer-events: all;
}

.refactor-terminal {
  width: min(600px, 90vw);
  background: #1E1E1E;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 25px 60px rgba(0,0,0,0.5);
  border: 1px solid #333;
}

.refactor-terminal-header {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 10px 14px;
  background: #2D2D2D;
}

.refactor-terminal-header .dot-r { width: 12px; height: 12px; border-radius: 50%; background: #FF5F56; }
.refactor-terminal-header .dot-y { width: 12px; height: 12px; border-radius: 50%; background: #FFBD2E; }
.refactor-terminal-header .dot-g { width: 12px; height: 12px; border-radius: 50%; background: #27C93F; }
.refactor-terminal-header .title {
  margin-left: 8px;
  color: #999;
  font-family: var(--font-mono);
  font-size: 0.75rem;
}

.refactor-terminal-body {
  padding: 1.25rem;
  font-family: var(--font-mono);
  font-size: 0.8rem;
  line-height: 1.8;
  color: #CCCCCC;
  min-height: 300px;
}

.refactor-terminal-body .line {
  opacity: 0;
  transform: translateY(4px);
}

.refactor-terminal-body .line.visible {
  opacity: 1;
  transform: translateY(0);
  transition: all 0.3s ease;
}

.refactor-terminal-body .prompt { color: #27C93F; }
.refactor-terminal-body .cmd { color: #E5E5E5; }
.refactor-terminal-body .success { color: #27C93F; }
.refactor-terminal-body .warning { color: #FFBD2E; }
.refactor-terminal-body .info { color: #569CD6; }
.refactor-terminal-body .removed { color: #F44747; }
.refactor-terminal-body .added { color: #27C93F; }
.refactor-terminal-body .progress-bar {
  display: inline-block;
  color: #27C93F;
}

/* ============================================================
   RESPONSIVE
   ============================================================ */

@media (max-width: 768px) {
  nav .nav-links { display: none; }
  .about-grid { grid-template-columns: 1fr; gap: 2rem; }
  .about-photo { max-height: 300px; }
  .projects-grid { grid-template-columns: 1fr; }
  .skill-bar-container { grid-template-columns: 100px 1fr 36px; }
  .hero-cta { flex-direction: column; }
}

/* ============================================================
   REFACTORED STATE (when everything is clean again)
   ============================================================ */

body.refactored .code-comment,
body.refactored .visible-style-tag {
  opacity: 0 !important;
  pointer-events: none;
}

body.refactored .console-overlay {
  transform: translateY(100%) !important;
}

body.refactored #about .about-photo {
  transform: none !important;
}

body.refactored .project-card.debt-broken {
  border-color: var(--gray-200) !important;
  background: var(--bg) !important;
}

body.refactored .project-card.debt-broken .project-card-image {
  background: linear-gradient(135deg, var(--accent-light), #C7D2FE) !important;
}

body.refactored .project-card.debt-wrong-font .project-card-body h3 {
  font-family: var(--font-main) !important;
  font-size: 1.125rem !important;
}

body.refactored .skills-category:nth-child(2) {
  transform: none !important;
}

body.refactored .skill-chip.debt-overlap,
body.refactored .skill-chip.debt-zindex {
  transform: none !important;
  z-index: auto !important;
  box-shadow: none !important;
}

body.refactored .timeline-item {
  transform: none !important;
}

body.refactored .timeline-item h3 {
  color: var(--text) !important;
}

body.refactored .timeline::before {
  background: var(--gray-200) !important;
}

body.refactored .timeline-item::before {
  background: var(--accent) !important;
  box-shadow: 0 0 0 2px var(--accent) !important;
  transform: none !important;
}

body.refactored #experience {
  background: var(--bg) !important;
}

body.refactored .debt-message-container {
  display: none;
}
</style>
</head>
<body>

<!-- ============================================================
     NAVIGATION
     ============================================================ -->
<nav>
  <div class="logo">Anshull Garg</div>
  <ul class="nav-links">
    <li><a href="#hero">Home</a></li>
    <li><a href="#about">About</a></li>
    <li><a href="#projects">Projects</a></li>
    <li><a href="#skills">Skills</a></li>
    <li><a href="#experience">Experience</a></li>
    <li><a href="#contact">Contact</a></li>
  </ul>
  <div class="debt-meter">
    <span>Tech Debt:</span>
    <div class="debt-meter-bar">
      <div class="debt-meter-fill" id="debtFill"></div>
    </div>
    <span id="debtPercent">0%</span>
  </div>
</nav>

<!-- ============================================================
     SECTION 1: HERO (PIXEL-PERFECT)
     ============================================================ -->
<section id="hero" class="section">
  <div class="hero-badge">
    <span class="dot"></span>
    Available for opportunities
  </div>
  <h1>
    Anshull <span class="accent">Garg</span>
  </h1>
  <p class="subtitle">
    Software Developer at Walmart. Building scalable systems,
    clean interfaces, and occasionally writing code that works
    on the first try.
  </p>
  <div class="hero-cta">
    <button class="btn-primary" onclick="document.getElementById('projects').scrollIntoView({behavior:'smooth'})">
      View My Work
      <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M7 17L17 7M17 7H7M17 7v10"/></svg>
    </button>
    <button class="btn-secondary" onclick="document.getElementById('contact').scrollIntoView({behavior:'smooth'})">
      Get in Touch
    </button>
  </div>
  <div class="scroll-indicator">
    <span>Scroll to explore</span>
    <div class="scroll-arrow"></div>
  </div>
</section>

<!-- ============================================================
     SECTION 2: ABOUT (slight issues begin)
     ============================================================ -->
<section id="about" class="section about-debt">
  <!-- TODO: update this bio before the portfolio review -->
  <div class="section-header">
    <span class="label">01 / About</span>
    <h2>A bit about me</h2>
  </div>

  <div class="about-grid" style="max-width:1000px;margin:0 auto;">
    <div class="about-photo">
      <span class="about-photo-initials">AG</span>
    </div>
    <div class="about-text">
      <h3>Software Developer based in Bentonville, AR</h3>
      <p>
        I'm a developer who believes in writing code that humans can read,
        not just machines. At Walmart, I work on systems that serve millions
        of users, building with React, Java, and cloud-native architectures.
      </p>
      <p>
        When I'm not shipping features, I'm exploring system design patterns,
        contributing to open source, and trying to convince my team that
        "we'll refactor it later" is not a viable strategy.
      </p>
      <div class="about-stats">
        <div class="stat-item">
          <div class="stat-number">3+</div>
          <div class="stat-label">Years Experience</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">50+</div>
          <div class="stat-label">Projects Shipped</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">1M+</div>
          <div class="stat-label">Users Impacted</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Code comments that appear as you scroll -->
  <div class="code-comment" id="about-todo" style="top:12px;right:20px;">
    &lt;!-- TODO: update this bio before the portfolio review --&gt;
  </div>
  <div class="code-comment" id="about-console" style="bottom:20px;left:20px;">
    console.log("about section rendered", { renderCount: 47 });
  </div>
</section>

<!-- ============================================================
     SECTION 3: PROJECTS (getting worse)
     ============================================================ -->
<section id="projects" class="section projects-debt">
  <div class="section-header">
    <span class="label">02 / Projects</span>
    <h2>Selected Work</h2>
  </div>

  <div class="projects-grid">
    <!-- Project 1: Clean -->
    <div class="project-card">
      <div class="project-card-image">
        <span class="project-icon">&#9881;</span>
      </div>
      <div class="project-card-body">
        <h3>Inventory Sync Engine</h3>
        <p>Real-time inventory management system handling 10K+ SKU updates per second across distributed warehouses.</p>
        <div class="project-tags">
          <span class="project-tag">Java</span>
          <span class="project-tag">Kafka</span>
          <span class="project-tag">Redis</span>
        </div>
      </div>
    </div>

    <!-- Project 2: Wrong colors (debt-broken) -->
    <div class="project-card debt-broken">
      <div class="project-card-image">
        <span class="project-icon">&#9733;</span>
      </div>
      <div class="project-card-body">
        <h3>Customer Analytics Dashboard</h3>
        <p>Interactive analytics platform with real-time data visualization for business intelligence teams.</p>
        <div class="project-tags">
          <span class="project-tag">React</span>
          <span class="project-tag">D3.js</span>
          <span class="project-tag">GraphQL</span>
        </div>
      </div>
      <div class="code-comment warning" id="proj-fixme" style="top:-28px;left:10px;">
        /* FIXME: this animation is janky */
      </div>
    </div>

    <!-- Project 3: Wrong font -->
    <div class="project-card debt-wrong-font">
      <div class="project-card-image">
        <span class="project-icon">&#9878;</span>
      </div>
      <div class="project-card-body">
        <h3>Supply Chain Optimizer</h3>
        <p>ML-powered route optimization reducing delivery times by 23% across the last-mile network.</p>
        <div class="project-tags">
          <span class="project-tag">Python</span>
          <span class="project-tag">TensorFlow</span>
          <span class="project-tag">AWS</span>
        </div>
      </div>
      <div class="code-comment" id="proj-idk" style="bottom:-28px;right:10px;">
        // this works but I don't know why
      </div>
    </div>
  </div>

  <div class="code-comment warning" id="proj-todo" style="top:60px;left:30px;">
    /* TODO: add more projects... eventually */
  </div>
</section>

<!-- ============================================================
     SECTION 4: SKILLS (bad)
     ============================================================ -->
<section id="skills" class="section skills-debt">
  <div class="section-header">
    <span class="label">03 / Skills</span>
    <h2>Technical Toolkit</h2>
  </div>

  <div class="skills-container">
    <div class="skills-category">
      <h3>Languages & Frameworks</h3>
      <div class="skills-list">
        <span class="skill-chip">JavaScript / TypeScript</span>
        <span class="skill-chip">React.js</span>
        <span class="skill-chip debt-overlap">Node.js</span>
        <span class="skill-chip">Java</span>
        <span class="skill-chip debt-zindex">Spring Boot</span>
        <span class="skill-chip">Python</span>
        <span class="skill-chip">SQL</span>
      </div>
    </div>

    <div class="skills-category">
      <h3>Infrastructure & Tools</h3>
      <div class="skills-list">
        <span class="skill-chip">AWS</span>
        <span class="skill-chip">Docker</span>
        <span class="skill-chip">Kubernetes</span>
        <span class="skill-chip debt-overlap">CI/CD</span>
        <span class="skill-chip">Kafka</span>
        <span class="skill-chip">Redis</span>
        <span class="skill-chip debt-zindex">Terraform</span>
      </div>
    </div>

    <div class="skills-category">
      <h3>Proficiency</h3>
      <div>
        <div class="skill-bar-container">
          <span class="skill-bar-label">Frontend</span>
          <div class="skill-bar"><div class="skill-bar-fill" style="width:92%"></div></div>
          <span class="skill-bar-value">92%</span>
        </div>
        <div class="skill-bar-container">
          <span class="skill-bar-label">Backend</span>
          <div class="skill-bar"><div class="skill-bar-fill" style="width:88%"></div></div>
          <span class="skill-bar-value">88%</span>
        </div>
        <div class="skill-bar-container">
          <span class="skill-bar-label">DevOps</span>
          <div class="skill-bar"><div class="skill-bar-fill" style="width:75%"></div></div>
          <span class="skill-bar-value">75%</span>
        </div>
        <div class="skill-bar-container">
          <span class="skill-bar-label">System Design</span>
          <div class="skill-bar"><div class="skill-bar-fill" style="width:85%"></div></div>
          <span class="skill-bar-value">85%</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Debt annotations -->
  <div class="code-comment warning" id="skills-refactor" style="top:20px;right:20px;">
    /* TODO: refactor this entire section */
  </div>
  <div class="code-comment" id="skills-stackoverflow" style="bottom:80px;left:20px;">
    // copied from Stack Overflow - last edited 2 years ago
  </div>
  <div class="code-comment hack" id="skills-hack" style="top:50%;right:30px;">
    // HACK: z-index: 9999 to fix overlap
  </div>
  <div class="visible-style-tag" id="skills-inline" style="bottom:40px;right:40px;">
    style="margin-top: -10px !important"
  </div>
</section>

<!-- ============================================================
     SECTION 5: EXPERIENCE (disaster)
     ============================================================ -->
<section id="experience" class="section exp-debt">
  <div class="section-header">
    <span class="label">04 / Experience</span>
    <h2>Where I've Worked</h2>
  </div>

  <div class="experience-container">
    <div class="timeline">
      <div class="timeline-item">
        <span class="company">Walmart Global Tech</span>
        <h3>Software Developer</h3>
        <span class="period">2022 - Present</span>
        <p>
          Building and scaling backend microservices for Walmart's e-commerce platform.
          Leading migration from monolithic architecture to event-driven microservices,
          improving system reliability from 99.5% to 99.95% uptime.
        </p>
        <div class="tech-list">
          <span class="tech-tag">Java</span>
          <span class="tech-tag">Spring Boot</span>
          <span class="tech-tag">Kafka</span>
          <span class="tech-tag">React</span>
          <span class="tech-tag">Azure</span>
        </div>
      </div>

      <div class="timeline-item">
        <span class="company">Walmart Global Tech</span>
        <h3>Software Engineering Intern</h3>
        <span class="period">Summer 2021</span>
        <p>
          Developed internal tooling for supply chain analytics. Built a dashboard
          that reduced manual reporting time by 60% for operations teams.
          Implemented automated data pipelines using Python and Spark.
        </p>
        <div class="tech-list">
          <span class="tech-tag">Python</span>
          <span class="tech-tag">Apache Spark</span>
          <span class="tech-tag">React</span>
          <span class="tech-tag">SQL</span>
        </div>
      </div>

      <div class="timeline-item">
        <span class="company">University Projects</span>
        <h3>Academic & Open Source Work</h3>
        <span class="period">2019 - 2022</span>
        <p>
          Led development of a campus event management platform serving 5,000+ students.
          Contributed to open-source projects in the React ecosystem.
          Teaching assistant for Data Structures and Algorithms.
        </p>
        <div class="tech-list">
          <span class="tech-tag">React</span>
          <span class="tech-tag">Node.js</span>
          <span class="tech-tag">MongoDB</span>
          <span class="tech-tag">Firebase</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Disaster-level debt annotations -->
  <div class="code-comment error" id="exp-fix-later" style="top:20px;left:20px;">
    /* I'll fix this later - wrote this 2 years ago */
  </div>
  <div class="code-comment error" id="exp-hack" style="top:40%;right:20px;">
    // HACK: overriding 3 layers of CSS specificity
  </div>
  <div class="code-comment hack" id="exp-temp" style="bottom:120px;left:20px;">
    // TEMPORARY FIX: DO NOT SHIP THIS (committed 18 months ago)
  </div>
  <div class="code-comment error" id="exp-important" style="bottom:60px;right:30px;">
    !important !important !important !important
  </div>
  <div class="visible-style-tag" id="exp-inline1" style="top:35%;left:30px;">
    style="position:relative; top:-15px; z-index:999 !important"
  </div>
  <div class="visible-style-tag" id="exp-inline2" style="bottom:180px;right:20px;">
    style="float:left; clear:both; overflow:hidden !important"
  </div>
</section>

<!-- ============================================================
     SECTION 6: CONTACT (redemption)
     ============================================================ -->
<section id="contact" class="section">
  <div class="debt-message-container contact-debt-message">
    <h2>OK, you've seen the tech debt.</h2>
    <p>
      This portfolio started clean and gradually accumulated the kind of mess
      every developer knows too well -- TODO comments, CSS hacks, z-index wars,
      and code that "works but nobody knows why."
    </p>
    <p style="margin-top:1rem;color:var(--gray-400);font-size:0.9375rem;">
      But great developers know what to do next.
    </p>
    <br>
    <button class="refactor-btn" id="refactorBtn" onclick="startRefactor()">
      <span class="spinner" id="refactorSpinner"></span>
      <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg>
      git refactor --force
    </button>
  </div>

  <div class="clean-contact" id="cleanContact">
    <h2>Let's Build Something<br>Together</h2>
    <p>
      I'm Anshull Garg, Software Developer at Walmart Global Tech.
      I write clean, maintainable code (most of the time) and
      I'm always open to interesting conversations and opportunities.
    </p>
    <p class="lesson">
      "Every codebase has tech debt. Great developers don't pretend
      it doesn't exist -- they acknowledge it and pay it down."
    </p>
    <div class="clean-links">
      <a href="mailto:anshull.garg@example.com">
        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
        Email
      </a>
      <a href="https://github.com/anshullgarg" target="_blank">
        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
        GitHub
      </a>
      <a href="https://linkedin.com/in/anshullgarg" target="_blank">
        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
        LinkedIn
      </a>
      <a href="#hero" onclick="event.preventDefault();document.getElementById('hero').scrollIntoView({behavior:'smooth'});">
        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M5 10l7-7m0 0l7 7m-7-7v18"/></svg>
        Back to Top
      </a>
    </div>
  </div>
</section>

<!-- ============================================================
     CONSOLE OVERLAY (appears as debt grows)
     ============================================================ -->
<div class="console-overlay" id="consoleOverlay">
  <div class="console-header">
    <span class="console-tab">Console</span>
    <span style="margin-left:auto;color:#666;cursor:pointer" onclick="document.getElementById('consoleOverlay').classList.remove('visible')">x</span>
  </div>
  <div class="console-line">
    <span class="prefix">></span>
    <span class="msg">Page loaded in 2.3s</span>
    <span class="source">app.js:1</span>
  </div>
  <div class="console-line warn">
    <span class="prefix">&#9888;</span>
    <span class="msg">useEffect has a missing dependency: 'userData'. Either include it or remove the dependency array.</span>
    <span class="source">About.jsx:47</span>
  </div>
  <div class="console-line">
    <span class="prefix">></span>
    <span class="msg">console.log("about section rendered", { renderCount: 47 })</span>
    <span class="source">About.jsx:12</span>
  </div>
  <div class="console-line warn">
    <span class="prefix">&#9888;</span>
    <span class="msg">Each child in a list should have a unique "key" prop. Check the render method of `ProjectGrid`.</span>
    <span class="source">Projects.jsx:83</span>
  </div>
  <div class="console-line error" id="consoleFetchError" style="display:none">
    <span class="prefix">&#10008;</span>
    <span class="msg">Uncaught TypeError: Cannot read properties of undefined (reading 'map') at Skills.jsx:29</span>
    <span class="source">Skills.jsx:29</span>
  </div>
  <div class="console-line error" id="console404" style="display:none">
    <span class="prefix">&#10008;</span>
    <span class="msg">GET https://api.example.com/v2/experience 404 (Not Found)</span>
    <span class="source">Experience.jsx:15</span>
  </div>
  <div class="console-line error" id="consoleMaxUpdate" style="display:none">
    <span class="prefix">&#10008;</span>
    <span class="msg">Warning: Maximum update depth exceeded. This can happen when a component calls setState inside useEffect.</span>
    <span class="source">Experience.jsx:44</span>
  </div>
  <div class="console-line warn" id="consoleDeprecated" style="display:none">
    <span class="prefix">&#9888;</span>
    <span class="msg">componentWillMount has been renamed, and is not recommended for use. Move code to componentDidMount instead.</span>
    <span class="source">legacy/OldComponent.js:8</span>
  </div>
</div>

<!-- ============================================================
     REFACTOR OVERLAY
     ============================================================ -->
<div class="refactor-overlay" id="refactorOverlay">
  <div class="refactor-terminal">
    <div class="refactor-terminal-header">
      <div class="dot-r"></div>
      <div class="dot-y"></div>
      <div class="dot-g"></div>
      <span class="title">zsh -- refactor-portfolio</span>
    </div>
    <div class="refactor-terminal-body" id="terminalBody">
      <div class="line" id="tl0"><span class="prompt">$ </span><span class="cmd">npx refactor-portfolio --fix-all</span></div>
      <div class="line" id="tl1"><br></div>
      <div class="line" id="tl2"><span class="info">Scanning for tech debt...</span></div>
      <div class="line" id="tl3"><span class="removed">  - Found 12 TODO comments</span></div>
      <div class="line" id="tl4"><span class="removed">  - Found 7 HACK/FIXME annotations</span></div>
      <div class="line" id="tl5"><span class="removed">  - Found 4 z-index violations</span></div>
      <div class="line" id="tl6"><span class="removed">  - Found 9 !important overrides</span></div>
      <div class="line" id="tl7"><span class="removed">  - Found 3 Stack Overflow copy-pastes</span></div>
      <div class="line" id="tl8"><span class="removed">  - Found 1 "works but nobody knows why"</span></div>
      <div class="line" id="tl9"><br></div>
      <div class="line" id="tl10"><span class="warning">Refactoring in progress...</span></div>
      <div class="line" id="tl11"><span class="progress-bar" id="progressBar"></span></div>
      <div class="line" id="tl12"><br></div>
      <div class="line" id="tl13"><span class="added">  + Removed all TODO/FIXME/HACK comments</span></div>
      <div class="line" id="tl14"><span class="added">  + Fixed CSS specificity issues</span></div>
      <div class="line" id="tl15"><span class="added">  + Normalized z-index values</span></div>
      <div class="line" id="tl16"><span class="added">  + Replaced !important with proper cascade</span></div>
      <div class="line" id="tl17"><span class="added">  + Cleaned console.log statements</span></div>
      <div class="line" id="tl18"><span class="added">  + Restored consistent typography</span></div>
      <div class="line" id="tl19"><br></div>
      <div class="line" id="tl20"><span class="success">Refactor complete. 0 issues remaining.</span></div>
      <div class="line" id="tl21"><span class="success">Tech debt: 87% -> 0%</span></div>
      <div class="line" id="tl22"><br></div>
      <div class="line" id="tl23"><span class="prompt">$ </span><span class="cmd">git commit -m "refactor: pay down all tech debt"</span></div>
      <div class="line" id="tl24"><span class="info">[main a3f7c2d] refactor: pay down all tech debt</span></div>
      <div class="line" id="tl25"><span class="info"> 6 files changed, 42 insertions(+), 187 deletions(-)</span></div>
    </div>
  </div>
</div>

<!-- ============================================================
     JAVASCRIPT
     ============================================================ -->
<script>
(function() {
  'use strict';

  // ---- STATE ----
  let debtLevel = 0;
  let isRefactored = false;
  let consoleVisible = false;

  const debtFill = document.getElementById('debtFill');
  const debtPercent = document.getElementById('debtPercent');
  const consoleOverlay = document.getElementById('consoleOverlay');

  // ---- SECTION POSITIONS ----
  function getSectionProgress(sectionId) {
    const el = document.getElementById(sectionId);
    if (!el) return 0;
    const rect = el.getBoundingClientRect();
    const viewH = window.innerHeight;
    // 0 = section top is at viewport bottom, 1 = section bottom is at viewport top
    const progress = 1 - (rect.top / (viewH + rect.height));
    return Math.max(0, Math.min(1, progress));
  }

  // ---- DEBT METER ----
  function updateDebtMeter(level) {
    const pct = Math.round(level * 100);
    debtFill.style.width = pct + '%';
    debtPercent.textContent = pct + '%';

    if (pct > 60) {
      debtPercent.style.color = '#EF4444';
      debtPercent.style.fontWeight = '700';
    } else if (pct > 30) {
      debtPercent.style.color = '#EAB308';
      debtPercent.style.fontWeight = '600';
    } else {
      debtPercent.style.color = '';
      debtPercent.style.fontWeight = '';
    }
  }

  // ---- SHOW/HIDE CODE COMMENTS ----
  function showComment(id, shouldShow) {
    const el = document.getElementById(id);
    if (!el) return;
    if (shouldShow) {
      el.classList.add('visible');
    } else {
      el.classList.remove('visible');
    }
  }

  function showStyleTag(id, shouldShow) {
    const el = document.getElementById(id);
    if (!el) return;
    if (shouldShow) {
      el.classList.add('visible');
    } else {
      el.classList.remove('visible');
    }
  }

  // ---- ACTIVATE SECTION DEBT ----
  function activateSection(sectionId, shouldActivate) {
    const el = document.getElementById(sectionId);
    if (!el) return;
    const wrapper = el.closest('.about-debt, .projects-debt, .skills-debt, .exp-debt') || el;
    if (shouldActivate) {
      wrapper.classList.add('active');
    } else {
      wrapper.classList.remove('active');
    }
  }

  // ---- CONSOLE OVERLAY ----
  function updateConsole(debt) {
    if (isRefactored) return;

    if (debt > 0.15 && !consoleVisible) {
      consoleOverlay.classList.add('visible');
      consoleVisible = true;
    }

    // Show additional errors as debt grows
    if (debt > 0.45) {
      document.getElementById('consoleFetchError').style.display = 'flex';
    }
    if (debt > 0.6) {
      document.getElementById('console404').style.display = 'flex';
      document.getElementById('consoleDeprecated').style.display = 'flex';
    }
    if (debt > 0.75) {
      document.getElementById('consoleMaxUpdate').style.display = 'flex';
    }
  }

  // ---- EXPERIENCE SECTION EXTRA CHAOS ----
  function updateExperienceChaos(progress) {
    if (isRefactored) return;
    const section = document.getElementById('experience');
    if (progress > 0.3) {
      // Background starts shifting
      const hue = Math.round(progress * 8);
      const sat = Math.round(progress * 3);
      section.style.background = `hsl(${hue}, ${sat}%, 99%)`;
    }
  }

  // ---- MAIN SCROLL HANDLER ----
  function onScroll() {
    if (isRefactored) return;

    const aboutP = getSectionProgress('about');
    const projectsP = getSectionProgress('projects');
    const skillsP = getSectionProgress('skills');
    const expP = getSectionProgress('experience');
    const contactP = getSectionProgress('contact');

    // Calculate overall debt level (0 to ~0.87 before contact)
    let debt = 0;
    if (aboutP > 0.2) debt += 0.08;
    if (projectsP > 0.2) debt += 0.15;
    if (skillsP > 0.2) debt += 0.25;
    if (expP > 0.2) debt += 0.22;
    if (expP > 0.5) debt += 0.17;

    // Smooth it
    debt = Math.min(debt, 0.87);
    debtLevel = debt;

    updateDebtMeter(debt);

    // --- SECTION 2: ABOUT ---
    if (aboutP > 0.25) {
      showComment('about-todo', true);
      activateSection('about', true);
    }
    if (aboutP > 0.45) {
      showComment('about-console', true);
    }

    // --- SECTION 3: PROJECTS ---
    if (projectsP > 0.2) {
      activateSection('projects', true);
      showComment('proj-todo', true);
    }
    if (projectsP > 0.35) {
      showComment('proj-fixme', true);
    }
    if (projectsP > 0.5) {
      showComment('proj-idk', true);
    }

    // --- SECTION 4: SKILLS ---
    if (skillsP > 0.15) {
      activateSection('skills', true);
      showComment('skills-refactor', true);
    }
    if (skillsP > 0.3) {
      showComment('skills-stackoverflow', true);
    }
    if (skillsP > 0.45) {
      showComment('skills-hack', true);
      showStyleTag('skills-inline', true);
    }

    // --- SECTION 5: EXPERIENCE ---
    if (expP > 0.1) {
      activateSection('experience', true);
      showComment('exp-fix-later', true);
    }
    if (expP > 0.25) {
      showComment('exp-hack', true);
      showStyleTag('exp-inline1', true);
    }
    if (expP > 0.4) {
      showComment('exp-temp', true);
      showStyleTag('exp-inline2', true);
    }
    if (expP > 0.55) {
      showComment('exp-important', true);
    }

    updateExperienceChaos(expP);
    updateConsole(debt);
  }

  // ---- THROTTLED SCROLL ----
  let ticking = false;
  window.addEventListener('scroll', function() {
    if (!ticking) {
      window.requestAnimationFrame(function() {
        onScroll();
        ticking = false;
      });
      ticking = true;
    }
  });

  // ---- REFACTOR ANIMATION ----
  window.startRefactor = function() {
    const btn = document.getElementById('refactorBtn');
    const spinner = document.getElementById('refactorSpinner');
    const overlay = document.getElementById('refactorOverlay');

    // Disable button, show spinner
    btn.disabled = true;
    btn.style.opacity = '0.7';
    spinner.style.display = 'block';

    // After a beat, show terminal overlay
    setTimeout(function() {
      overlay.classList.add('visible');

      // Animate terminal lines
      const totalLines = 26;
      let currentLine = 0;
      const progressEl = document.getElementById('progressBar');
      let progressStr = '';

      function showNextLine() {
        if (currentLine >= totalLines) {
          // Done -- close overlay and clean up
          setTimeout(function() {
            overlay.classList.remove('visible');
            completeRefactor();
          }, 1200);
          return;
        }

        const lineEl = document.getElementById('tl' + currentLine);
        if (lineEl) {
          lineEl.classList.add('visible');
        }

        // Progress bar animation for line 11
        if (currentLine === 11) {
          let pCount = 0;
          const pInterval = setInterval(function() {
            pCount++;
            progressStr += '#';
            const pctDone = Math.round((pCount / 30) * 100);
            progressEl.textContent = '  [' + progressStr.padEnd(30, '-') + '] ' + pctDone + '%';
            if (pCount >= 30) {
              clearInterval(pInterval);
              currentLine++;
              setTimeout(showNextLine, 200);
            }
          }, 50);
          return;
        }

        currentLine++;
        // Vary timing for dramatic effect
        let delay = 120;
        if (currentLine <= 2) delay = 400;
        if (currentLine >= 3 && currentLine <= 8) delay = 250;
        if (currentLine >= 13 && currentLine <= 18) delay = 200;
        if (currentLine >= 20) delay = 350;

        setTimeout(showNextLine, delay);
      }

      setTimeout(showNextLine, 500);
    }, 600);
  };

  function completeRefactor() {
    isRefactored = true;

    // Add refactored class to body
    document.body.classList.add('refactored');

    // Reset debt meter
    updateDebtMeter(0);

    // Hide console
    consoleOverlay.classList.remove('visible');

    // Reset experience background
    document.getElementById('experience').style.background = '';

    // Hide debt message, show clean contact
    document.querySelector('.contact-debt-message').style.display = 'none';
    const cleanContact = document.getElementById('cleanContact');
    cleanContact.classList.add('visible');

    // Smooth scroll to contact
    setTimeout(function() {
      document.getElementById('contact').scrollIntoView({ behavior: 'smooth' });
    }, 300);
  }

  // ---- INITIAL STATE ----
  onScroll();

})();
</script>

</body>
</html>
