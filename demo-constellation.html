<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Anshull Garg - Constellation Portfolio</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --bg: #050510;
  --gold: #D4A853;
  --gold-dim: rgba(212, 168, 83, 0.4);
  --blue: #7EB8DA;
  --blue-dim: rgba(126, 184, 218, 0.15);
  --line: rgba(160, 200, 240, 0.25);
  --line-hover: rgba(200, 220, 255, 0.7);
  --text: #c8d4e0;
  --text-dim: rgba(200, 212, 224, 0.4);
}

html, body {
  width: 100%; height: 100%;
  overflow: hidden;
  background: var(--bg);
  font-family: 'Inter', sans-serif;
  color: var(--text);
  cursor: crosshair;
  -webkit-font-smoothing: antialiased;
}

canvas#starfield {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  z-index: 1;
}

/* Nebula layers */
.nebula {
  position: fixed;
  z-index: 2;
  pointer-events: none;
  border-radius: 50%;
  filter: blur(120px);
  opacity: 0;
  transition: opacity 2s ease;
}
.nebula.visible { opacity: 1; }
.nebula-1 {
  width: 600px; height: 600px;
  background: radial-gradient(circle, rgba(100, 60, 180, 0.08), transparent 70%);
  top: 10%; left: 20%;
  animation: nebulaDrift1 40s ease-in-out infinite;
}
.nebula-2 {
  width: 500px; height: 400px;
  background: radial-gradient(circle, rgba(40, 100, 180, 0.06), transparent 70%);
  top: 50%; right: 10%;
  animation: nebulaDrift2 35s ease-in-out infinite;
}
.nebula-3 {
  width: 700px; height: 500px;
  background: radial-gradient(circle, rgba(180, 60, 80, 0.05), transparent 70%);
  bottom: 5%; left: 40%;
  animation: nebulaDrift3 45s ease-in-out infinite;
}

@keyframes nebulaDrift1 {
  0%, 100% { transform: translate(0, 0) scale(1); }
  33% { transform: translate(30px, -20px) scale(1.05); }
  66% { transform: translate(-20px, 15px) scale(0.95); }
}
@keyframes nebulaDrift2 {
  0%, 100% { transform: translate(0, 0) scale(1); }
  50% { transform: translate(-40px, 25px) scale(1.08); }
}
@keyframes nebulaDrift3 {
  0%, 100% { transform: translate(0, 0) scale(1); }
  40% { transform: translate(25px, -30px) scale(1.03); }
  70% { transform: translate(-15px, 20px) scale(0.97); }
}

/* Shooting stars */
.shooting-star {
  position: fixed;
  z-index: 3;
  pointer-events: none;
  width: 120px; height: 1px;
  background: linear-gradient(90deg, rgba(255,255,255,0.8), transparent);
  opacity: 0;
  transform-origin: left center;
}
.shooting-star.active {
  animation: shoot 1.2s ease-out forwards;
}
@keyframes shoot {
  0% { opacity: 0; transform: translateX(0) scaleX(0.3); }
  10% { opacity: 1; }
  100% { opacity: 0; transform: translateX(500px) scaleX(1); }
}

/* UI overlay */
#ui-layer {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  z-index: 10;
  pointer-events: none;
}

/* Header */
.site-header {
  position: fixed;
  top: 0; left: 0; right: 0;
  z-index: 100;
  padding: 24px 40px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  pointer-events: none;
  opacity: 1;
  transition: opacity 0.6s ease;
}
.site-header.hidden { opacity: 0; }
.site-header > * { pointer-events: auto; }

.logo {
  font-family: 'Space Grotesk', sans-serif;
  font-weight: 300;
  font-size: 18px;
  letter-spacing: 4px;
  text-transform: uppercase;
  color: rgba(255,255,255,0.6);
}
.logo span { color: var(--gold); font-weight: 500; }

.header-subtitle {
  font-size: 11px;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--text-dim);
  margin-top: 2px;
}

/* Legend / mini-map */
.legend {
  position: fixed;
  bottom: 30px;
  left: 30px;
  z-index: 100;
  pointer-events: auto;
  background: rgba(5, 5, 16, 0.7);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 12px;
  padding: 16px 20px;
  min-width: 180px;
  transition: opacity 0.5s ease, transform 0.5s ease;
}
.legend.hidden {
  opacity: 0;
  transform: translateY(20px);
  pointer-events: none;
}
.legend-title {
  font-family: 'Space Grotesk', sans-serif;
  font-size: 10px;
  letter-spacing: 3px;
  text-transform: uppercase;
  color: var(--text-dim);
  margin-bottom: 12px;
}
.legend-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 6px 4px;
  cursor: pointer;
  border-radius: 6px;
  transition: background 0.3s ease;
  font-size: 13px;
  color: rgba(200, 212, 224, 0.5);
  letter-spacing: 0.5px;
}
.legend-item:hover {
  background: rgba(255,255,255,0.04);
  color: rgba(255,255,255,0.9);
}
.legend-item.active { color: var(--gold); }
.legend-dot {
  width: 6px; height: 6px;
  border-radius: 50%;
  background: rgba(200, 220, 255, 0.4);
  flex-shrink: 0;
  transition: background 0.3s ease, box-shadow 0.3s ease;
}
.legend-item:hover .legend-dot,
.legend-item.active .legend-dot {
  background: var(--gold);
  box-shadow: 0 0 8px var(--gold-dim);
}

/* Instructions */
.instructions {
  position: fixed;
  bottom: 30px;
  right: 30px;
  z-index: 100;
  font-size: 11px;
  letter-spacing: 1px;
  color: var(--text-dim);
  text-align: right;
  line-height: 1.8;
  transition: opacity 0.5s ease;
}
.instructions.hidden { opacity: 0; pointer-events: none; }
.instructions kbd {
  display: inline-block;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 4px;
  padding: 1px 6px;
  font-family: 'Space Grotesk', sans-serif;
  font-size: 10px;
  color: rgba(255,255,255,0.5);
}

/* Detail panel */
.detail-panel {
  position: fixed;
  z-index: 50;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.8s ease, transform 0.8s ease;
  transform: translateY(20px);
}
.detail-panel.visible {
  pointer-events: auto;
  opacity: 1;
  transform: translateY(0);
}

.panel-inner {
  background: rgba(5, 5, 16, 0.85);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 16px;
  padding: 36px 40px;
  max-width: 460px;
  max-height: 70vh;
  overflow-y: auto;
}
.panel-inner::-webkit-scrollbar { width: 4px; }
.panel-inner::-webkit-scrollbar-track { background: transparent; }
.panel-inner::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 2px; }

.panel-label {
  font-family: 'Space Grotesk', sans-serif;
  font-size: 10px;
  letter-spacing: 4px;
  text-transform: uppercase;
  color: var(--gold);
  margin-bottom: 8px;
}
.panel-title {
  font-family: 'Space Grotesk', sans-serif;
  font-size: 32px;
  font-weight: 600;
  color: #fff;
  margin-bottom: 20px;
  line-height: 1.2;
}
.panel-text {
  font-size: 14px;
  line-height: 1.8;
  color: rgba(200, 212, 224, 0.75);
  margin-bottom: 16px;
}
.panel-text strong {
  color: rgba(255,255,255,0.9);
  font-weight: 500;
}

.panel-divider {
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(212,168,83,0.2), transparent);
  margin: 20px 0;
}

.panel-tag {
  display: inline-block;
  background: rgba(212, 168, 83, 0.1);
  border: 1px solid rgba(212, 168, 83, 0.2);
  color: var(--gold);
  font-size: 11px;
  letter-spacing: 0.5px;
  padding: 4px 12px;
  border-radius: 20px;
  margin: 3px 4px 3px 0;
}

.panel-link {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  color: var(--gold);
  text-decoration: none;
  font-size: 13px;
  letter-spacing: 0.5px;
  margin-top: 8px;
  transition: color 0.3s ease;
}
.panel-link:hover { color: #fff; }

.timeline-item {
  padding-left: 20px;
  border-left: 1px solid rgba(212,168,83,0.2);
  margin-bottom: 20px;
  position: relative;
}
.timeline-item::before {
  content: '';
  position: absolute;
  left: -4px; top: 6px;
  width: 7px; height: 7px;
  background: var(--gold);
  border-radius: 50%;
  box-shadow: 0 0 8px var(--gold-dim);
}
.timeline-role {
  font-family: 'Space Grotesk', sans-serif;
  font-weight: 500;
  font-size: 15px;
  color: #fff;
}
.timeline-company {
  font-size: 13px;
  color: var(--gold);
  margin-bottom: 4px;
}
.timeline-date {
  font-size: 11px;
  color: var(--text-dim);
  letter-spacing: 1px;
  margin-bottom: 6px;
}
.timeline-desc {
  font-size: 13px;
  color: rgba(200, 212, 224, 0.6);
  line-height: 1.6;
}

/* Back button */
.back-btn {
  position: fixed;
  top: 30px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 200;
  background: rgba(5, 5, 16, 0.7);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(212, 168, 83, 0.25);
  color: var(--gold);
  font-family: 'Space Grotesk', sans-serif;
  font-size: 12px;
  letter-spacing: 3px;
  text-transform: uppercase;
  padding: 10px 28px;
  border-radius: 30px;
  cursor: pointer;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.5s ease, background 0.3s ease, transform 0.5s ease;
}
.back-btn.visible {
  opacity: 1;
  pointer-events: auto;
}
.back-btn:hover {
  background: rgba(212, 168, 83, 0.12);
}

/* Skill bars */
.skill-group { margin-bottom: 18px; }
.skill-group-title {
  font-family: 'Space Grotesk', sans-serif;
  font-size: 12px;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--gold);
  margin-bottom: 10px;
}
.skill-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 6px;
  font-size: 13px;
  color: rgba(200,212,224,0.7);
}
.skill-bar-bg {
  width: 100px;
  height: 3px;
  background: rgba(255,255,255,0.06);
  border-radius: 2px;
  overflow: hidden;
}
.skill-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--gold-dim), var(--gold));
  border-radius: 2px;
  transition: width 1.2s ease;
  width: 0;
}

/* Contact form area */
.contact-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 0;
  border-bottom: 1px solid rgba(255,255,255,0.04);
}
.contact-icon {
  width: 36px; height: 36px;
  border-radius: 50%;
  background: rgba(212, 168, 83, 0.08);
  border: 1px solid rgba(212, 168, 83, 0.15);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  flex-shrink: 0;
}
.contact-label {
  font-size: 11px;
  color: var(--text-dim);
  letter-spacing: 1px;
  text-transform: uppercase;
}
.contact-value {
  font-size: 14px;
  color: rgba(255,255,255,0.8);
}
.contact-value a {
  color: var(--gold);
  text-decoration: none;
  transition: color 0.3s;
}
.contact-value a:hover { color: #fff; }

/* Project card */
.project-card {
  background: rgba(255,255,255,0.02);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 12px;
  padding: 20px;
  margin-bottom: 16px;
  transition: border-color 0.3s ease;
}
.project-card:hover {
  border-color: rgba(212, 168, 83, 0.25);
}
.project-name {
  font-family: 'Space Grotesk', sans-serif;
  font-size: 16px;
  font-weight: 500;
  color: #fff;
  margin-bottom: 6px;
}
.project-desc {
  font-size: 13px;
  color: rgba(200,212,224,0.6);
  line-height: 1.6;
  margin-bottom: 10px;
}
.project-tech { display: flex; flex-wrap: wrap; gap: 4px; }

/* Achievement item */
.achievement-item {
  display: flex;
  gap: 14px;
  padding: 12px 0;
  border-bottom: 1px solid rgba(255,255,255,0.04);
}
.achievement-icon {
  font-size: 22px;
  flex-shrink: 0;
  line-height: 1.4;
}
.achievement-title {
  font-family: 'Space Grotesk', sans-serif;
  font-size: 14px;
  font-weight: 500;
  color: rgba(255,255,255,0.9);
  margin-bottom: 2px;
}
.achievement-desc {
  font-size: 12px;
  color: rgba(200,212,224,0.5);
  line-height: 1.5;
}

/* Loading overlay */
#loading {
  position: fixed;
  inset: 0;
  z-index: 9999;
  background: var(--bg);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  transition: opacity 1s ease;
}
#loading.fade-out { opacity: 0; pointer-events: none; }
#loading .loader-text {
  font-family: 'Space Grotesk', sans-serif;
  font-size: 14px;
  letter-spacing: 6px;
  text-transform: uppercase;
  color: var(--text-dim);
  animation: loadPulse 1.5s ease-in-out infinite;
}
@keyframes loadPulse {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 1; }
}

/* Responsive */
@media (max-width: 768px) {
  .site-header { padding: 16px 20px; }
  .logo { font-size: 14px; letter-spacing: 2px; }
  .legend { display: none; }
  .instructions { display: none; }
  .panel-inner { padding: 24px; max-width: 90vw; }
  .panel-title { font-size: 24px; }
  .back-btn { font-size: 11px; padding: 8px 20px; }
}
</style>
</head>
<body>

<div id="loading">
  <div class="loader-text">Mapping Constellations</div>
</div>

<canvas id="starfield"></canvas>

<div class="nebula nebula-1 visible"></div>
<div class="nebula nebula-2 visible"></div>
<div class="nebula nebula-3 visible"></div>

<div class="shooting-star" id="shootingStar1"></div>
<div class="shooting-star" id="shootingStar2"></div>

<div id="ui-layer">
  <header class="site-header" id="siteHeader">
    <div>
      <div class="logo"><span>Anshull</span> Garg</div>
      <div class="header-subtitle">Software Developer &middot; Walmart</div>
    </div>
  </header>

  <nav class="legend" id="legend">
    <div class="legend-title">Constellations</div>
    <div class="legend-item" data-constellation="about">
      <div class="legend-dot"></div> The Developer
    </div>
    <div class="legend-item" data-constellation="projects">
      <div class="legend-dot"></div> The Forge
    </div>
    <div class="legend-item" data-constellation="experience">
      <div class="legend-dot"></div> The Path
    </div>
    <div class="legend-item" data-constellation="skills">
      <div class="legend-dot"></div> The Arsenal
    </div>
    <div class="legend-item" data-constellation="achievements">
      <div class="legend-dot"></div> The Crown
    </div>
    <div class="legend-item" data-constellation="contact">
      <div class="legend-dot"></div> The Beacon
    </div>
  </nav>

  <div class="instructions" id="instructions">
    <kbd>Click</kbd> constellation to explore<br>
    <kbd>Scroll</kbd> to zoom &middot; <kbd>Drag</kbd> to pan<br>
    <kbd>Esc</kbd> to return to sky view
  </div>
</div>

<button class="back-btn" id="backBtn">Return to Sky</button>

<!-- Detail Panels -->
<div class="detail-panel" id="panel-about">
  <div class="panel-inner">
    <div class="panel-label">The Developer</div>
    <div class="panel-title">Anshull Garg</div>
    <div class="panel-text">
      A passionate <strong>Software Developer</strong> at <strong>Walmart Global Tech</strong>,
      building scalable systems that serve millions of users. With a deep love for clean
      architecture and elegant solutions, I transform complex business requirements into
      performant, maintainable code.
    </div>
    <div class="panel-divider"></div>
    <div class="panel-text">
      My journey through the tech cosmos has been driven by curiosity and a relentless
      pursuit of engineering excellence. I believe in the power of <strong>well-crafted software</strong>
      to solve real-world problems at scale.
    </div>
    <div class="panel-text">
      When not coding, you can find me exploring new technologies, contributing to
      open-source, and mentoring aspiring developers.
    </div>
  </div>
</div>

<div class="detail-panel" id="panel-projects">
  <div class="panel-inner">
    <div class="panel-label">The Forge</div>
    <div class="panel-title">Projects</div>
    <div class="project-card">
      <div class="project-name">Inventory Intelligence Platform</div>
      <div class="project-desc">Real-time inventory management system handling millions of SKUs across Walmart's supply chain, with predictive analytics for demand forecasting.</div>
      <div class="project-tech">
        <span class="panel-tag">Java</span>
        <span class="panel-tag">Kafka</span>
        <span class="panel-tag">React</span>
        <span class="panel-tag">ML</span>
      </div>
    </div>
    <div class="project-card">
      <div class="project-name">Checkout Optimization Engine</div>
      <div class="project-desc">High-throughput payment processing pipeline reducing checkout latency by 40%, serving peak holiday traffic seamlessly.</div>
      <div class="project-tech">
        <span class="panel-tag">Microservices</span>
        <span class="panel-tag">Node.js</span>
        <span class="panel-tag">Redis</span>
      </div>
    </div>
    <div class="project-card">
      <div class="project-name">Developer Experience Toolkit</div>
      <div class="project-desc">Internal CLI and dashboard tools that reduced deployment friction and improved team velocity by 30%.</div>
      <div class="project-tech">
        <span class="panel-tag">TypeScript</span>
        <span class="panel-tag">Go</span>
        <span class="panel-tag">Docker</span>
      </div>
    </div>
  </div>
</div>

<div class="detail-panel" id="panel-experience">
  <div class="panel-inner">
    <div class="panel-label">The Path</div>
    <div class="panel-title">Experience</div>
    <div class="timeline-item">
      <div class="timeline-role">Software Developer</div>
      <div class="timeline-company">Walmart Global Tech</div>
      <div class="timeline-date">2023 - Present</div>
      <div class="timeline-desc">Building enterprise-grade distributed systems for one of the world's largest retailers. Focus on backend services, API design, and performance optimization at massive scale.</div>
    </div>
    <div class="timeline-item">
      <div class="timeline-role">Software Engineering Intern</div>
      <div class="timeline-company">Walmart Global Tech</div>
      <div class="timeline-date">Summer 2022</div>
      <div class="timeline-desc">Developed automation tools for the supply chain team, reducing manual processes by 60%. Received a full-time return offer.</div>
    </div>
    <div class="timeline-item">
      <div class="timeline-role">Freelance Developer</div>
      <div class="timeline-company">Independent</div>
      <div class="timeline-date">2020 - 2022</div>
      <div class="timeline-desc">Built full-stack web applications for small businesses. Gained hands-on experience with React, Node.js, and cloud deployment.</div>
    </div>
  </div>
</div>

<div class="detail-panel" id="panel-skills">
  <div class="panel-inner">
    <div class="panel-label">The Arsenal</div>
    <div class="panel-title">Skills</div>
    <div class="skill-group">
      <div class="skill-group-title">Languages</div>
      <div class="skill-item"><span>Java</span><div class="skill-bar-bg"><div class="skill-bar-fill" data-width="92%"></div></div></div>
      <div class="skill-item"><span>JavaScript / TypeScript</span><div class="skill-bar-bg"><div class="skill-bar-fill" data-width="90%"></div></div></div>
      <div class="skill-item"><span>Python</span><div class="skill-bar-bg"><div class="skill-bar-fill" data-width="82%"></div></div></div>
      <div class="skill-item"><span>Go</span><div class="skill-bar-bg"><div class="skill-bar-fill" data-width="70%"></div></div></div>
      <div class="skill-item"><span>SQL</span><div class="skill-bar-bg"><div class="skill-bar-fill" data-width="88%"></div></div></div>
    </div>
    <div class="skill-group">
      <div class="skill-group-title">Frameworks & Tools</div>
      <div class="skill-item"><span>React / Next.js</span><div class="skill-bar-bg"><div class="skill-bar-fill" data-width="88%"></div></div></div>
      <div class="skill-item"><span>Spring Boot</span><div class="skill-bar-bg"><div class="skill-bar-fill" data-width="90%"></div></div></div>
      <div class="skill-item"><span>Node.js</span><div class="skill-bar-bg"><div class="skill-bar-fill" data-width="85%"></div></div></div>
      <div class="skill-item"><span>Kafka / RabbitMQ</span><div class="skill-bar-bg"><div class="skill-bar-fill" data-width="78%"></div></div></div>
    </div>
    <div class="skill-group">
      <div class="skill-group-title">Infrastructure</div>
      <div class="skill-item"><span>AWS / Azure</span><div class="skill-bar-bg"><div class="skill-bar-fill" data-width="82%"></div></div></div>
      <div class="skill-item"><span>Docker / Kubernetes</span><div class="skill-bar-bg"><div class="skill-bar-fill" data-width="80%"></div></div></div>
      <div class="skill-item"><span>CI/CD Pipelines</span><div class="skill-bar-bg"><div class="skill-bar-fill" data-width="85%"></div></div></div>
    </div>
  </div>
</div>

<div class="detail-panel" id="panel-achievements">
  <div class="panel-inner">
    <div class="panel-label">The Crown</div>
    <div class="panel-title">Achievements</div>
    <div class="achievement-item">
      <div class="achievement-icon">*</div>
      <div>
        <div class="achievement-title">Hackathon Winner - Walmart Converge</div>
        <div class="achievement-desc">First place in company-wide hackathon for building an AI-powered inventory forecasting tool that was adopted into production.</div>
      </div>
    </div>
    <div class="achievement-item">
      <div class="achievement-icon">*</div>
      <div>
        <div class="achievement-title">Performance Excellence Award</div>
        <div class="achievement-desc">Recognized for reducing API response times by 65% across critical payment services during peak season.</div>
      </div>
    </div>
    <div class="achievement-item">
      <div class="achievement-icon">*</div>
      <div>
        <div class="achievement-title">Open Source Contributor</div>
        <div class="achievement-desc">Active contributor to multiple open-source projects with 500+ GitHub stars across personal repositories.</div>
      </div>
    </div>
    <div class="achievement-item">
      <div class="achievement-icon">*</div>
      <div>
        <div class="achievement-title">Tech Talk Speaker</div>
        <div class="achievement-desc">Presented on distributed systems patterns and event-driven architecture at internal engineering summits.</div>
      </div>
    </div>
  </div>
</div>

<div class="detail-panel" id="panel-contact">
  <div class="panel-inner">
    <div class="panel-label">The Beacon</div>
    <div class="panel-title">Get in Touch</div>
    <div class="panel-text">
      I am always open to discussing new opportunities, interesting projects,
      or just connecting with fellow developers.
    </div>
    <div class="panel-divider"></div>
    <div class="contact-item">
      <div class="contact-icon">@</div>
      <div>
        <div class="contact-label">Email</div>
        <div class="contact-value"><a href="mailto:anshull.garg@gmail.com">anshull.garg@gmail.com</a></div>
      </div>
    </div>
    <div class="contact-item">
      <div class="contact-icon">in</div>
      <div>
        <div class="contact-label">LinkedIn</div>
        <div class="contact-value"><a href="https://linkedin.com/in/anshullgarg" target="_blank">linkedin.com/in/anshullgarg</a></div>
      </div>
    </div>
    <div class="contact-item">
      <div class="contact-icon">&lt;/&gt;</div>
      <div>
        <div class="contact-label">GitHub</div>
        <div class="contact-value"><a href="https://github.com/anshullgarg" target="_blank">github.com/anshullgarg</a></div>
      </div>
    </div>
    <div class="contact-item">
      <div class="contact-icon">X</div>
      <div>
        <div class="contact-label">Twitter</div>
        <div class="contact-value"><a href="https://twitter.com/anshullgarg" target="_blank">@anshullgarg</a></div>
      </div>
    </div>
  </div>
</div>

<script>
(function() {
  'use strict';

  // ========== CANVAS SETUP ==========
  const canvas = document.getElementById('starfield');
  const ctx = canvas.getContext('2d');
  let W, H;

  function resize() {
    W = canvas.width = window.innerWidth;
    H = canvas.height = window.innerHeight;
  }
  resize();
  window.addEventListener('resize', resize);

  // ========== STATE ==========
  const state = {
    camera: { x: 0, y: 0, zoom: 1, targetX: 0, targetY: 0, targetZoom: 1 },
    mouse: { x: W / 2, y: H / 2, worldX: 0, worldY: 0 },
    dragging: false,
    dragStart: { x: 0, y: 0 },
    activeConstellation: null,
    hoveredConstellation: null,
    time: 0,
    loaded: false
  };

  // ========== WORLD SPACE ==========
  // World is 3000x2000 centered at (1500, 1000)
  const WORLD_W = 3000;
  const WORLD_H = 2000;

  // ========== BACKGROUND STARS ==========
  const bgStars = [];
  for (let i = 0; i < 350; i++) {
    bgStars.push({
      x: Math.random() * WORLD_W,
      y: Math.random() * WORLD_H,
      r: Math.random() * 1.3 + 0.3,
      brightness: Math.random(),
      twinkleSpeed: Math.random() * 2 + 0.5,
      twinkleOffset: Math.random() * Math.PI * 2,
      color: Math.random() < 0.6 ? '#fff' : Math.random() < 0.5 ? '#b0d4f1' : '#f0e0a0',
      layer: Math.random() < 0.3 ? 0.6 : Math.random() < 0.6 ? 0.8 : 1
    });
  }

  // ========== CONSTELLATION DATA ==========
  // Each constellation: array of {x, y, r} for stars, and lines connecting them
  const constellations = {
    about: {
      name: 'The Developer',
      label: 'ABOUT',
      color: '#7EB8DA',
      nebulaColor: 'rgba(60, 120, 200, 0.06)',
      panelPosition: 'right',
      stars: [
        { x: 350, y: 280, r: 3.5 },   // head
        { x: 350, y: 360, r: 2.5 },   // neck
        { x: 350, y: 460, r: 3 },     // torso center
        { x: 280, y: 400, r: 2 },     // left shoulder
        { x: 420, y: 400, r: 2 },     // right shoulder
        { x: 240, y: 500, r: 2.5 },   // left hand
        { x: 460, y: 500, r: 2.5 },   // right hand
        { x: 320, y: 580, r: 2 },     // left hip
        { x: 380, y: 580, r: 2 },     // right hip
        { x: 290, y: 700, r: 2.5 },   // left foot
        { x: 410, y: 700, r: 2.5 },   // right foot
        { x: 350, y: 230, r: 1.5 },   // top of head sparkle
      ],
      lines: [
        [0, 1], [1, 2], [1, 3], [1, 4], [3, 5], [4, 6],
        [2, 7], [2, 8], [7, 9], [8, 10], [0, 11]
      ],
      center: { x: 350, y: 460 }
    },
    projects: {
      name: 'The Forge',
      label: 'PROJECTS',
      color: '#E8A040',
      nebulaColor: 'rgba(200, 140, 40, 0.06)',
      panelPosition: 'right',
      stars: [
        { x: 850, y: 300, r: 3 },     // hammer top
        { x: 900, y: 340, r: 2 },
        { x: 950, y: 380, r: 2.5 },   // hammer head joint
        { x: 1020, y: 360, r: 3.5 },  // hammer head right
        { x: 1020, y: 400, r: 3 },    // hammer head bottom right
        { x: 950, y: 420, r: 2.5 },   // hammer head bottom joint
        { x: 900, y: 480, r: 2 },     // handle
        { x: 870, y: 550, r: 2 },     // handle lower
        { x: 850, y: 620, r: 3 },     // anvil top left
        { x: 950, y: 620, r: 2.5 },   // anvil top right
        { x: 820, y: 670, r: 2.5 },   // anvil base left
        { x: 980, y: 670, r: 2.5 },   // anvil base right
        { x: 1060, y: 340, r: 1.5 },  // spark
        { x: 1050, y: 420, r: 1.5 },  // spark
      ],
      lines: [
        [0, 1], [1, 2], [2, 3], [3, 4], [4, 5], [5, 2],
        [5, 6], [6, 7], [7, 8], [8, 9], [8, 10], [9, 11], [10, 11],
        [3, 12], [4, 13]
      ],
      center: { x: 930, y: 480 }
    },
    experience: {
      name: 'The Path',
      label: 'EXPERIENCE',
      color: '#A87ED4',
      nebulaColor: 'rgba(140, 80, 200, 0.06)',
      panelPosition: 'left',
      stars: [
        { x: 1650, y: 250, r: 3.5 },  // start of path
        { x: 1720, y: 320, r: 2.5 },
        { x: 1680, y: 400, r: 2 },
        { x: 1750, y: 460, r: 3 },
        { x: 1820, y: 420, r: 2.5 },
        { x: 1880, y: 480, r: 2 },
        { x: 1840, y: 560, r: 2.5 },
        { x: 1900, y: 630, r: 3 },
        { x: 1950, y: 700, r: 3.5 },  // end of path (present)
        { x: 1600, y: 280, r: 1.5 },  // side sparkle
        { x: 1960, y: 650, r: 1.5 },  // end sparkle
      ],
      lines: [
        [0, 1], [1, 2], [2, 3], [3, 4], [4, 5], [5, 6], [6, 7], [7, 8],
        [0, 9], [8, 10]
      ],
      center: { x: 1780, y: 470 }
    },
    skills: {
      name: 'The Arsenal',
      label: 'SKILLS',
      color: '#5EC4A0',
      nebulaColor: 'rgba(60, 180, 140, 0.06)',
      panelPosition: 'left',
      stars: [
        { x: 2450, y: 350, r: 3.5 },  // shield top
        { x: 2350, y: 430, r: 2.5 },  // left upper
        { x: 2550, y: 430, r: 2.5 },  // right upper
        { x: 2320, y: 530, r: 2 },    // left mid
        { x: 2580, y: 530, r: 2 },    // right mid
        { x: 2360, y: 630, r: 2.5 },  // left lower
        { x: 2540, y: 630, r: 2.5 },  // right lower
        { x: 2450, y: 720, r: 3 },    // bottom point
        { x: 2450, y: 480, r: 2 },    // center emblem
        { x: 2450, y: 560, r: 2 },    // center lower
      ],
      lines: [
        [0, 1], [0, 2], [1, 3], [2, 4], [3, 5], [4, 6], [5, 7], [6, 7],
        [0, 8], [8, 9], [9, 7], [1, 2], [3, 4], [5, 6]
      ],
      center: { x: 2450, y: 530 }
    },
    achievements: {
      name: 'The Crown',
      label: 'ACHIEVEMENTS',
      color: '#D4A853',
      nebulaColor: 'rgba(212, 168, 83, 0.07)',
      panelPosition: 'right',
      stars: [
        { x: 700, y: 1100, r: 3 },    // base left
        { x: 900, y: 1100, r: 3 },    // base right
        { x: 680, y: 1020, r: 2.5 },  // left prong base
        { x: 920, y: 1020, r: 2.5 },  // right prong base
        { x: 650, y: 920, r: 3 },     // left prong tip
        { x: 800, y: 880, r: 3.5 },   // center prong tip (brightest)
        { x: 950, y: 920, r: 3 },     // right prong tip
        { x: 730, y: 960, r: 2 },     // inner left
        { x: 870, y: 960, r: 2 },     // inner right
        { x: 800, y: 1000, r: 2 },    // center band
        { x: 800, y: 840, r: 1.5 },   // top jewel sparkle
      ],
      lines: [
        [0, 1], [0, 2], [1, 3], [2, 4], [2, 7], [7, 5], [5, 8], [8, 3], [3, 6],
        [4, 7], [6, 8], [7, 9], [8, 9], [5, 10]
      ],
      center: { x: 800, y: 1000 }
    },
    contact: {
      name: 'The Beacon',
      label: 'CONTACT',
      color: '#DA7E7E',
      nebulaColor: 'rgba(200, 80, 80, 0.06)',
      panelPosition: 'left',
      stars: [
        { x: 2200, y: 1050, r: 3.5 },  // beacon light (top)
        { x: 2170, y: 1120, r: 2.5 },  // tower upper left
        { x: 2230, y: 1120, r: 2.5 },  // tower upper right
        { x: 2160, y: 1200, r: 2 },    // tower mid left
        { x: 2240, y: 1200, r: 2 },    // tower mid right
        { x: 2140, y: 1300, r: 2.5 },  // base left
        { x: 2260, y: 1300, r: 2.5 },  // base right
        { x: 2200, y: 1330, r: 2 },    // base center
        { x: 2130, y: 1020, r: 1.5 },  // light ray left
        { x: 2270, y: 1020, r: 1.5 },  // light ray right
        { x: 2200, y: 980, r: 2 },     // light ray top
      ],
      lines: [
        [0, 1], [0, 2], [1, 3], [2, 4], [3, 5], [4, 6], [5, 7], [6, 7],
        [1, 2], [3, 4], [0, 8], [0, 9], [0, 10]
      ],
      center: { x: 2200, y: 1150 }
    }
  };

  // Precompute constellation bounding boxes for hit testing
  Object.keys(constellations).forEach(key => {
    const c = constellations[key];
    let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;
    c.stars.forEach(s => {
      minX = Math.min(minX, s.x);
      minY = Math.min(minY, s.y);
      maxX = Math.max(maxX, s.x);
      maxY = Math.max(maxY, s.y);
    });
    c.bounds = { x: minX - 40, y: minY - 40, w: maxX - minX + 80, h: maxY - minY + 80 };
  });

  // ========== COORDINATE TRANSFORMS ==========
  function worldToScreen(wx, wy) {
    const sx = (wx - state.camera.x) * state.camera.zoom + W / 2;
    const sy = (wy - state.camera.y) * state.camera.zoom + H / 2;
    return { x: sx, y: sy };
  }

  function screenToWorld(sx, sy) {
    const wx = (sx - W / 2) / state.camera.zoom + state.camera.x;
    const wy = (sy - H / 2) / state.camera.zoom + state.camera.y;
    return { x: wx, y: wy };
  }

  // ========== HIT TESTING ==========
  function hitTestConstellations(wx, wy) {
    for (const key of Object.keys(constellations)) {
      const c = constellations[key];
      const b = c.bounds;
      if (wx >= b.x && wx <= b.x + b.w && wy >= b.y && wy <= b.y + b.h) {
        // More precise: check distance to any star
        for (const star of c.stars) {
          const dx = wx - star.x;
          const dy = wy - star.y;
          const hitRadius = Math.max(30, 50 / state.camera.zoom);
          if (dx * dx + dy * dy < hitRadius * hitRadius) {
            return key;
          }
        }
        // Check if near any line
        for (const [a, b2] of c.lines) {
          const sa = c.stars[a], sb = c.stars[b2];
          const dist = distToSegment(wx, wy, sa.x, sa.y, sb.x, sb.y);
          const hitRadius = Math.max(15, 25 / state.camera.zoom);
          if (dist < hitRadius) return key;
        }
      }
    }
    return null;
  }

  function distToSegment(px, py, x1, y1, x2, y2) {
    const dx = x2 - x1, dy = y2 - y1;
    const len2 = dx * dx + dy * dy;
    if (len2 === 0) return Math.hypot(px - x1, py - y1);
    let t = ((px - x1) * dx + (py - y1) * dy) / len2;
    t = Math.max(0, Math.min(1, t));
    return Math.hypot(px - (x1 + t * dx), py - (y1 + t * dy));
  }

  // ========== CAMERA ==========
  function setCameraTarget(x, y, zoom) {
    state.camera.targetX = x;
    state.camera.targetY = y;
    state.camera.targetZoom = zoom;
  }

  function updateCamera() {
    const lerp = 0.05;
    state.camera.x += (state.camera.targetX - state.camera.x) * lerp;
    state.camera.y += (state.camera.targetY - state.camera.y) * lerp;
    state.camera.zoom += (state.camera.targetZoom - state.camera.zoom) * lerp;
  }

  function resetCamera() {
    const scaleX = W / WORLD_W;
    const scaleY = H / WORLD_H;
    const zoom = Math.min(scaleX, scaleY) * 0.85;
    setCameraTarget(WORLD_W / 2, WORLD_H / 2, zoom);
  }

  function zoomToConstellation(key) {
    const c = constellations[key];
    const b = c.bounds;
    const cx = b.x + b.w / 2;
    const cy = b.y + b.h / 2;
    const padding = 200;
    const scaleX = W / (b.w + padding);
    const scaleY = H / (b.h + padding);
    let zoom = Math.min(scaleX, scaleY) * 0.55;
    zoom = Math.min(zoom, 3);
    zoom = Math.max(zoom, 1.2);

    // Offset camera so panel has room
    const panelOffset = c.panelPosition === 'right' ? -120 : 120;
    setCameraTarget(cx + panelOffset / zoom, cy, zoom);
  }

  // ========== DRAWING ==========
  function drawStar(x, y, r, color, alpha) {
    const s = worldToScreen(x, y);
    const screenR = r * state.camera.zoom;
    if (s.x < -20 || s.x > W + 20 || s.y < -20 || s.y > H + 20) return;
    if (screenR < 0.3) return;

    ctx.globalAlpha = alpha;

    // Glow
    if (screenR > 1.5) {
      const grd = ctx.createRadialGradient(s.x, s.y, 0, s.x, s.y, screenR * 4);
      grd.addColorStop(0, color);
      grd.addColorStop(0.3, color.replace(')', ', 0.15)').replace('rgb', 'rgba'));
      grd.addColorStop(1, 'transparent');
      ctx.fillStyle = grd;
      ctx.beginPath();
      ctx.arc(s.x, s.y, screenR * 4, 0, Math.PI * 2);
      ctx.fill();
    }

    // Core
    ctx.fillStyle = color;
    ctx.beginPath();
    ctx.arc(s.x, s.y, Math.max(screenR, 0.5), 0, Math.PI * 2);
    ctx.fill();

    // Bright center
    if (screenR > 2) {
      ctx.globalAlpha = alpha * 0.8;
      ctx.fillStyle = '#fff';
      ctx.beginPath();
      ctx.arc(s.x, s.y, screenR * 0.4, 0, Math.PI * 2);
      ctx.fill();
    }

    ctx.globalAlpha = 1;
  }

  function drawLine(x1, y1, x2, y2, color, alpha, width) {
    const s1 = worldToScreen(x1, y1);
    const s2 = worldToScreen(x2, y2);
    ctx.globalAlpha = alpha;
    ctx.strokeStyle = color;
    ctx.lineWidth = width * state.camera.zoom;
    ctx.beginPath();
    ctx.moveTo(s1.x, s1.y);
    ctx.lineTo(s2.x, s2.y);
    ctx.stroke();
    ctx.globalAlpha = 1;
  }

  function drawConstellationLabel(key) {
    const c = constellations[key];
    const isHovered = state.hoveredConstellation === key;
    const isActive = state.activeConstellation === key;
    const s = worldToScreen(c.center.x, c.center.y - 20);

    if (isActive && state.camera.zoom > 1.5) return; // Hide label when zoomed in, panel shows instead

    ctx.save();
    ctx.font = `${isHovered || isActive ? '500' : '300'} ${11 / Math.max(state.camera.zoom, 0.5)}px "Space Grotesk", sans-serif`;
    ctx.textAlign = 'center';
    ctx.textBaseline = 'top';

    // Name
    const alpha = isHovered || isActive ? 0.9 : 0.35;
    ctx.globalAlpha = alpha;
    ctx.fillStyle = isHovered || isActive ? c.color : '#c8d4e0';
    const fontSize = Math.max(12, 14 * state.camera.zoom);
    ctx.font = `${isHovered || isActive ? '500' : '300'} ${fontSize}px "Space Grotesk", sans-serif`;
    ctx.fillText(c.name, s.x, s.y + c.bounds.h * state.camera.zoom * 0.45 + 10);

    ctx.globalAlpha = 1;
    ctx.restore();
  }

  // ========== RENDER LOOP ==========
  function render() {
    state.time += 0.016;
    updateCamera();

    ctx.clearRect(0, 0, W, H);

    // Background gradient
    const bgGrad = ctx.createRadialGradient(W/2, H/2, 0, W/2, H/2, Math.max(W, H));
    bgGrad.addColorStop(0, '#0a0a1a');
    bgGrad.addColorStop(1, '#050510');
    ctx.fillStyle = bgGrad;
    ctx.fillRect(0, 0, W, H);

    // Draw background stars with parallax + twinkling
    for (const star of bgStars) {
      const parallaxX = star.x + (state.mouse.x - W/2) * 0.01 * (1 - star.layer);
      const parallaxY = star.y + (state.mouse.y - H/2) * 0.01 * (1 - star.layer);
      const twinkle = 0.4 + 0.6 * (0.5 + 0.5 * Math.sin(state.time * star.twinkleSpeed + star.twinkleOffset));
      const alpha = star.brightness * twinkle;
      drawStar(parallaxX, parallaxY, star.r * star.layer, star.color, alpha);
    }

    // Draw constellation lines and stars
    const constellationKeys = Object.keys(constellations);
    for (const key of constellationKeys) {
      const c = constellations[key];
      const isHovered = state.hoveredConstellation === key;
      const isActive = state.activeConstellation === key;
      const dimOthers = state.activeConstellation && !isActive;

      // Lines
      const lineAlpha = dimOthers ? 0.04 : isHovered || isActive ? 0.6 : 0.18;
      const lineWidth = isHovered || isActive ? 1.2 : 0.6;
      const lineColor = isHovered || isActive ? c.color : 'rgba(160, 200, 240, 0.6)';

      for (const [a, b] of c.lines) {
        const sa = c.stars[a], sb = c.stars[b];
        drawLine(sa.x, sa.y, sb.x, sb.y, lineColor, lineAlpha, lineWidth);
      }

      // Stars
      for (const star of c.stars) {
        const twinkle = 0.6 + 0.4 * Math.sin(state.time * 1.5 + star.x * 0.01 + star.y * 0.01);
        const baseAlpha = dimOthers ? 0.1 : isHovered || isActive ? 0.95 : 0.6;
        const alpha = baseAlpha * twinkle;
        const color = isHovered || isActive ? c.color : '#d0dce8';
        const sizeMultiplier = isActive ? 1.3 : isHovered ? 1.15 : 1;
        drawStar(star.x, star.y, star.r * sizeMultiplier, color, alpha);
      }

      // Constellation label
      if (!dimOthers || isActive) {
        drawConstellationLabel(key);
      }
    }

    // Active constellation: draw extra glow on lines
    if (state.activeConstellation) {
      const c = constellations[state.activeConstellation];
      const pulse = 0.3 + 0.15 * Math.sin(state.time * 2);
      for (const [a, b] of c.lines) {
        const sa = c.stars[a], sb = c.stars[b];
        const s1 = worldToScreen(sa.x, sa.y);
        const s2 = worldToScreen(sb.x, sb.y);
        ctx.globalAlpha = pulse;
        ctx.strokeStyle = c.color;
        ctx.lineWidth = 3 * state.camera.zoom;
        ctx.shadowColor = c.color;
        ctx.shadowBlur = 12;
        ctx.beginPath();
        ctx.moveTo(s1.x, s1.y);
        ctx.lineTo(s2.x, s2.y);
        ctx.stroke();
        ctx.shadowBlur = 0;
      }
      ctx.globalAlpha = 1;
    }

    requestAnimationFrame(render);
  }

  // ========== PANELS ==========
  function showPanel(key) {
    const panel = document.getElementById('panel-' + key);
    if (!panel) return;

    const c = constellations[key];

    // Position panel on correct side
    if (c.panelPosition === 'right') {
      panel.style.right = '40px';
      panel.style.left = 'auto';
    } else {
      panel.style.left = '40px';
      panel.style.right = 'auto';
    }
    panel.style.top = '50%';
    panel.style.transform = 'translateY(-50%)';

    setTimeout(() => {
      panel.classList.add('visible');
      // Animate skill bars if skills panel
      if (key === 'skills') {
        panel.querySelectorAll('.skill-bar-fill').forEach(bar => {
          bar.style.width = bar.getAttribute('data-width');
        });
      }
    }, 600);
  }

  function hideAllPanels() {
    document.querySelectorAll('.detail-panel').forEach(p => {
      p.classList.remove('visible');
      // Reset skill bars
      p.querySelectorAll('.skill-bar-fill').forEach(bar => {
        bar.style.width = '0';
      });
    });
  }

  function activateConstellation(key) {
    if (state.activeConstellation === key) return;
    state.activeConstellation = key;
    hideAllPanels();
    zoomToConstellation(key);
    setTimeout(() => showPanel(key), 300);
    document.getElementById('backBtn').classList.add('visible');
    document.getElementById('legend').classList.add('hidden');
    document.getElementById('instructions').classList.add('hidden');

    // Update legend active state
    document.querySelectorAll('.legend-item').forEach(item => {
      item.classList.toggle('active', item.dataset.constellation === key);
    });
  }

  function deactivate() {
    state.activeConstellation = null;
    state.hoveredConstellation = null;
    hideAllPanels();
    resetCamera();
    document.getElementById('backBtn').classList.remove('visible');
    setTimeout(() => {
      document.getElementById('legend').classList.remove('hidden');
      document.getElementById('instructions').classList.remove('hidden');
    }, 400);
    document.querySelectorAll('.legend-item').forEach(item => item.classList.remove('active'));
  }

  // ========== EVENT HANDLERS ==========
  canvas.addEventListener('mousemove', (e) => {
    state.mouse.x = e.clientX;
    state.mouse.y = e.clientY;
    const world = screenToWorld(e.clientX, e.clientY);
    state.mouse.worldX = world.x;
    state.mouse.worldY = world.y;

    if (state.dragging) {
      const dx = (e.clientX - state.dragStart.x) / state.camera.zoom;
      const dy = (e.clientY - state.dragStart.y) / state.camera.zoom;
      state.camera.targetX -= dx;
      state.camera.targetY -= dy;
      state.camera.x -= dx;
      state.camera.y -= dy;
      state.dragStart.x = e.clientX;
      state.dragStart.y = e.clientY;
      return;
    }

    if (!state.activeConstellation) {
      const hit = hitTestConstellations(world.x, world.y);
      state.hoveredConstellation = hit;
      canvas.style.cursor = hit ? 'pointer' : 'crosshair';
    }
  });

  canvas.addEventListener('mousedown', (e) => {
    state.dragStart.x = e.clientX;
    state.dragStart.y = e.clientY;
    state.dragging = true;
    state._dragMoved = false;
  });

  canvas.addEventListener('mousemove', (e) => {
    if (state.dragging) {
      const dx = e.clientX - state.dragStart.x;
      const dy = e.clientY - state.dragStart.y;
      if (Math.abs(dx) > 3 || Math.abs(dy) > 3) {
        state._dragMoved = true;
      }
    }
  });

  window.addEventListener('mouseup', (e) => {
    if (state.dragging && !state._dragMoved) {
      // It was a click, not a drag
      const world = screenToWorld(e.clientX, e.clientY);
      if (!state.activeConstellation) {
        const hit = hitTestConstellations(world.x, world.y);
        if (hit) activateConstellation(hit);
      }
    }
    state.dragging = false;
  });

  canvas.addEventListener('wheel', (e) => {
    e.preventDefault();
    const zoomFactor = e.deltaY > 0 ? 0.92 : 1.08;
    let newZoom = state.camera.targetZoom * zoomFactor;
    newZoom = Math.max(0.3, Math.min(4, newZoom));
    state.camera.targetZoom = newZoom;
  }, { passive: false });

  // Touch support
  let lastTouchDist = 0;
  canvas.addEventListener('touchstart', (e) => {
    if (e.touches.length === 1) {
      state.dragStart.x = e.touches[0].clientX;
      state.dragStart.y = e.touches[0].clientY;
      state.dragging = true;
      state._dragMoved = false;
    }
    if (e.touches.length === 2) {
      lastTouchDist = Math.hypot(
        e.touches[1].clientX - e.touches[0].clientX,
        e.touches[1].clientY - e.touches[0].clientY
      );
    }
  });

  canvas.addEventListener('touchmove', (e) => {
    e.preventDefault();
    if (e.touches.length === 1 && state.dragging) {
      const dx = (e.touches[0].clientX - state.dragStart.x) / state.camera.zoom;
      const dy = (e.touches[0].clientY - state.dragStart.y) / state.camera.zoom;
      if (Math.abs(dx) > 2 || Math.abs(dy) > 2) state._dragMoved = true;
      state.camera.targetX -= dx;
      state.camera.targetY -= dy;
      state.camera.x -= dx;
      state.camera.y -= dy;
      state.dragStart.x = e.touches[0].clientX;
      state.dragStart.y = e.touches[0].clientY;
    }
    if (e.touches.length === 2) {
      const dist = Math.hypot(
        e.touches[1].clientX - e.touches[0].clientX,
        e.touches[1].clientY - e.touches[0].clientY
      );
      if (lastTouchDist > 0) {
        const scale = dist / lastTouchDist;
        state.camera.targetZoom = Math.max(0.3, Math.min(4, state.camera.targetZoom * scale));
      }
      lastTouchDist = dist;
    }
  }, { passive: false });

  canvas.addEventListener('touchend', (e) => {
    if (state.dragging && !state._dragMoved && e.changedTouches.length === 1) {
      const world = screenToWorld(e.changedTouches[0].clientX, e.changedTouches[0].clientY);
      if (!state.activeConstellation) {
        const hit = hitTestConstellations(world.x, world.y);
        if (hit) activateConstellation(hit);
      }
    }
    state.dragging = false;
    lastTouchDist = 0;
  });

  // Back button
  document.getElementById('backBtn').addEventListener('click', deactivate);

  // Legend navigation
  document.querySelectorAll('.legend-item').forEach(item => {
    item.addEventListener('click', () => {
      const key = item.dataset.constellation;
      if (key) activateConstellation(key);
    });
  });

  // Keyboard
  window.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') deactivate();
  });

  // ========== SHOOTING STARS ==========
  function triggerShootingStar() {
    const el = document.getElementById('shootingStar' + (Math.random() < 0.5 ? '1' : '2'));
    if (el.classList.contains('active')) return;

    const startX = Math.random() * W * 0.8;
    const startY = Math.random() * H * 0.4;
    const angle = 20 + Math.random() * 30;

    el.style.left = startX + 'px';
    el.style.top = startY + 'px';
    el.style.width = (80 + Math.random() * 100) + 'px';
    el.style.transform = `rotate(${angle}deg)`;
    el.classList.add('active');

    setTimeout(() => el.classList.remove('active'), 1300);
  }

  // Random shooting stars
  function scheduleShootingStar() {
    const delay = 3000 + Math.random() * 8000;
    setTimeout(() => {
      triggerShootingStar();
      scheduleShootingStar();
    }, delay);
  }
  scheduleShootingStar();

  // ========== INITIALIZATION ==========
  function init() {
    resetCamera();
    // Snap camera immediately for first frame
    state.camera.x = state.camera.targetX;
    state.camera.y = state.camera.targetY;
    state.camera.zoom = state.camera.targetZoom;

    render();

    // Fade out loading
    setTimeout(() => {
      document.getElementById('loading').classList.add('fade-out');
      setTimeout(() => document.getElementById('loading').style.display = 'none', 1000);
      state.loaded = true;
    }, 800);
  }

  // Wait for fonts
  if (document.fonts && document.fonts.ready) {
    document.fonts.ready.then(init);
  } else {
    window.addEventListener('load', init);
  }

})();
</script>
</body>
</html>
