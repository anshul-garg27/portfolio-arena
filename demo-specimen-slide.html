<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Specimen Slide | Anshull Garg</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@300;400;500;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  *,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
  :root{
    --micro-blue:#0A1628;
    --stain-teal:#88B5C4;
    --fluor-lavender:#E2D8F0;
    --slide-white:#F5EFE0;
    --eosin-pink:#C84B6A;
    --golgi-gold:#D4A843;
    --nissl-violet:#7B5EA7;
    --gram-green:#6B9E78;
  }
  html,body{height:100%;overflow:hidden;background:var(--micro-blue);font-family:'Inter',sans-serif;color:var(--slide-white)}

  /* ── MAIN LAYOUT ── */
  .microscope-shell{position:relative;width:100vw;height:100vh;display:flex;align-items:center;justify-content:center;overflow:hidden}

  /* Outer ring / eyepiece bezel */
  .eyepiece-bezel{
    position:relative;width:min(82vh,82vw);height:min(82vh,82vw);border-radius:50%;
    background:radial-gradient(circle,transparent 46%,#0d1f35 47%,#0d1f35 49%,#06101e 50%,#040c17 100%);
    box-shadow:inset 0 0 80px rgba(0,0,0,.8),0 0 120px rgba(0,0,0,.6);
    flex-shrink:0;
  }

  /* Viewport circle */
  .viewport{
    position:absolute;inset:4%;border-radius:50%;overflow:hidden;
    background:var(--slide-white);
    box-shadow:inset 0 0 40px rgba(10,22,40,.15);
    transition:filter .3s ease;
  }

  /* Focus blur */
  .viewport.blurred-1{filter:blur(1px)}
  .viewport.blurred-2{filter:blur(3px)}
  .viewport.blurred-3{filter:blur(6px)}

  /* Crosshair overlay */
  .crosshair{
    position:absolute;inset:0;pointer-events:none;z-index:50;
  }
  .crosshair::before,.crosshair::after{
    content:'';position:absolute;background:rgba(10,22,40,.12);
  }
  .crosshair::before{left:50%;top:20%;width:1px;height:60%;transform:translateX(-50%)}
  .crosshair::after{top:50%;left:20%;height:1px;width:60%;transform:translateY(-50%)}
  .crosshair-center{
    position:absolute;left:50%;top:50%;width:12px;height:12px;
    border:1px solid rgba(10,22,40,.15);border-radius:50%;
    transform:translate(-50%,-50%);
  }

  /* Lens vignette */
  .lens-vignette{
    position:absolute;inset:0;border-radius:50%;pointer-events:none;z-index:40;
    background:radial-gradient(circle,transparent 55%,rgba(10,22,40,.06) 70%,rgba(10,22,40,.2) 85%,rgba(10,22,40,.5) 100%);
  }

  /* ── SLIDE CONTENT AREA ── */
  .slide-content{
    position:absolute;inset:0;
    transition:transform .6s cubic-bezier(.25,.46,.45,.94);
    will-change:transform;
  }

  /* ── MAGNIFICATION LEVELS ── */

  /* --- 1x: BLOBS --- */
  .mag-blobs{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;transition:opacity .5s ease,transform .5s ease}
  .blob-cluster{position:relative;width:80%;height:80%;margin:auto}
  .blob{
    position:absolute;border-radius:50%;opacity:.7;
    transition:all .4s ease;cursor:pointer;
  }
  .blob:hover{opacity:1;transform:scale(1.1)}
  .blob .blob-label{
    position:absolute;inset:0;display:flex;align-items:center;justify-content:center;
    font-family:'JetBrains Mono',monospace;font-size:8px;color:rgba(10,22,40,.5);
    text-transform:uppercase;letter-spacing:1px;opacity:0;transition:opacity .3s
  }
  .blob:hover .blob-label{opacity:1}

  /* --- 10x: TITLES --- */
  .mag-titles{position:absolute;inset:0;padding:12%;display:grid;grid-template-columns:1fr 1fr;gap:16px;align-content:center;transition:opacity .5s ease,transform .5s ease}
  .title-card{
    background:rgba(10,22,40,.04);border:1px solid rgba(136,181,196,.2);
    border-radius:8px;padding:16px;cursor:pointer;transition:all .3s ease;
  }
  .title-card:hover{background:rgba(136,181,196,.08);border-color:var(--stain-teal);transform:scale(1.03)}
  .title-card h3{font-family:'Space Grotesk',sans-serif;font-size:13px;font-weight:600;color:var(--micro-blue);margin-bottom:4px}
  .title-card .specimen-id{font-family:'JetBrains Mono',monospace;font-size:9px;color:var(--eosin-pink);letter-spacing:1px;text-transform:uppercase}
  .title-card .thumb-bar{height:3px;border-radius:2px;margin-top:8px;opacity:.6}

  /* --- 100x: DETAILS --- */
  .mag-details{position:absolute;inset:0;padding:14%;display:flex;flex-direction:column;gap:14px;overflow-y:auto;transition:opacity .5s ease,transform .5s ease;scrollbar-width:none}
  .mag-details::-webkit-scrollbar{display:none}
  .detail-card{
    background:rgba(10,22,40,.03);border:1px solid rgba(136,181,196,.15);
    border-radius:10px;padding:20px;flex-shrink:0;
  }
  .detail-card .card-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px}
  .detail-card h3{font-family:'Space Grotesk',sans-serif;font-size:15px;font-weight:700;color:var(--micro-blue)}
  .detail-card .spec-label{
    font-family:'JetBrains Mono',monospace;font-size:8px;
    background:var(--eosin-pink);color:#fff;padding:2px 8px;border-radius:10px;
    letter-spacing:.5px;white-space:nowrap;
  }
  .detail-card p{font-size:12px;line-height:1.6;color:rgba(10,22,40,.7);margin-bottom:10px}
  .tech-tags{display:flex;flex-wrap:wrap;gap:4px}
  .tech-tag{
    font-family:'JetBrains Mono',monospace;font-size:9px;
    padding:3px 8px;border-radius:4px;
    background:rgba(136,181,196,.15);color:var(--micro-blue);
    border:1px solid rgba(136,181,196,.25);
  }

  /* --- 1000x: CODE --- */
  .mag-code{position:absolute;inset:0;padding:10%;display:flex;flex-direction:column;gap:12px;overflow-y:auto;transition:opacity .5s ease,transform .5s ease;scrollbar-width:none}
  .mag-code::-webkit-scrollbar{display:none}
  .code-block{
    background:var(--micro-blue);border-radius:8px;padding:16px 20px;flex-shrink:0;
    border:1px solid rgba(136,181,196,.2);position:relative;overflow:hidden;
  }
  .code-block::before{
    content:'';position:absolute;left:0;top:0;bottom:0;width:3px;
  }
  .code-block .code-file{
    font-family:'JetBrains Mono',monospace;font-size:9px;color:var(--stain-teal);
    margin-bottom:8px;letter-spacing:.5px;opacity:.7;
  }
  .code-block pre{
    font-family:'JetBrains Mono',monospace;font-size:10px;line-height:1.7;
    color:var(--fluor-lavender);white-space:pre-wrap;word-break:break-all;
  }
  .code-block .kw{color:var(--eosin-pink)}
  .code-block .fn{color:var(--golgi-gold)}
  .code-block .str{color:var(--gram-green)}
  .code-block .cm{color:rgba(136,181,196,.4);font-style:italic}
  .code-block .type{color:var(--stain-teal)}
  .code-block .num{color:var(--nissl-violet)}

  /* Visibility states */
  .mag-layer{pointer-events:none;opacity:0;transform:scale(.92)}
  .mag-layer.active{pointer-events:auto;opacity:1;transform:scale(1)}

  /* ── MAGNIFICATION DIAL (right side) ── */
  .mag-dial{
    position:fixed;right:32px;top:50%;transform:translateY(-50%);
    display:flex;flex-direction:column;align-items:center;gap:0;z-index:100;
  }
  .mag-dial-label{
    font-family:'JetBrains Mono',monospace;font-size:9px;letter-spacing:2px;
    text-transform:uppercase;color:var(--stain-teal);margin-bottom:12px;opacity:.6;
  }
  .mag-track{
    position:relative;width:4px;height:200px;
    background:rgba(136,181,196,.15);border-radius:2px;
    cursor:pointer;
  }
  .mag-fill{
    position:absolute;bottom:0;left:0;right:0;
    background:linear-gradient(to top,var(--stain-teal),var(--eosin-pink));
    border-radius:2px;transition:height .4s cubic-bezier(.25,.46,.45,.94);
  }
  .mag-knob{
    position:absolute;left:50%;width:24px;height:24px;
    background:var(--slide-white);border:2px solid var(--stain-teal);
    border-radius:50%;transform:translate(-50%,-50%);
    cursor:grab;transition:bottom .4s cubic-bezier(.25,.46,.45,.94);
    box-shadow:0 2px 8px rgba(0,0,0,.3);
  }
  .mag-knob:active{cursor:grabbing;border-color:var(--eosin-pink)}
  .mag-stops{
    position:absolute;left:-40px;top:0;bottom:0;
    display:flex;flex-direction:column;justify-content:space-between;
  }
  .mag-stop{
    font-family:'JetBrains Mono',monospace;font-size:10px;font-weight:500;
    color:rgba(136,181,196,.35);cursor:pointer;transition:all .3s;
    padding:4px 8px;text-align:right;
  }
  .mag-stop:hover{color:var(--stain-teal)}
  .mag-stop.active{color:var(--slide-white);font-weight:700}

  /* ── TOP-LEFT PANEL (Specimen Info) ── */
  .specimen-info{
    position:fixed;left:28px;top:28px;z-index:100;
  }
  .specimen-info .name{
    font-family:'Space Grotesk',sans-serif;font-size:20px;font-weight:700;
    color:var(--slide-white);letter-spacing:-0.5px;
  }
  .specimen-info .role{
    font-family:'Inter',sans-serif;font-size:12px;color:var(--stain-teal);
    margin-top:2px;font-weight:400;
  }
  .specimen-info .sample-id{
    font-family:'JetBrains Mono',monospace;font-size:10px;
    color:var(--eosin-pink);margin-top:10px;letter-spacing:1.5px;
    text-transform:uppercase;opacity:.8;
  }
  .specimen-info .date-stamp{
    font-family:'JetBrains Mono',monospace;font-size:9px;
    color:rgba(136,181,196,.4);margin-top:3px;letter-spacing:.5px;
  }

  /* ── BOTTOM-LEFT PANEL (Readout) ── */
  .readout{
    position:fixed;left:28px;bottom:28px;z-index:100;
  }
  .readout-row{
    font-family:'JetBrains Mono',monospace;font-size:10px;
    color:rgba(136,181,196,.5);letter-spacing:.5px;margin-bottom:3px;
    display:flex;gap:8px;
  }
  .readout-row .label{color:var(--stain-teal);min-width:70px}
  .readout-row .value{color:var(--fluor-lavender)}

  /* ── FOCUS INDICATOR (bottom right) ── */
  .focus-indicator{
    position:fixed;right:32px;bottom:28px;z-index:100;
    text-align:center;
  }
  .focus-label{
    font-family:'JetBrains Mono',monospace;font-size:9px;
    color:rgba(136,181,196,.4);letter-spacing:2px;text-transform:uppercase;
    margin-bottom:8px;
  }
  .focus-ring{
    width:40px;height:40px;border:2px solid rgba(136,181,196,.2);
    border-radius:50%;display:flex;align-items:center;justify-content:center;
    margin:0 auto;position:relative;cursor:ns-resize;
  }
  .focus-dot{
    width:6px;height:6px;background:var(--stain-teal);border-radius:50%;
    transition:all .3s;
  }
  .focus-ring.sharp .focus-dot{background:#5fdb7e;box-shadow:0 0 8px rgba(95,219,126,.4)}
  .focus-ring.blurred .focus-dot{background:var(--eosin-pink);box-shadow:0 0 8px rgba(200,75,106,.3)}
  .focus-value{
    font-family:'JetBrains Mono',monospace;font-size:10px;
    color:var(--slide-white);margin-top:6px;
  }

  /* ── SLIDE CAROUSEL (bottom center) ── */
  .slide-carousel{
    position:fixed;bottom:20px;left:50%;transform:translateX(-50%);
    display:flex;gap:6px;z-index:100;
    background:rgba(10,22,40,.6);backdrop-filter:blur(12px);
    padding:8px 14px;border-radius:30px;border:1px solid rgba(136,181,196,.1);
  }
  .slide-tab{
    font-family:'JetBrains Mono',monospace;font-size:9px;
    padding:6px 14px;border-radius:20px;cursor:pointer;
    color:rgba(136,181,196,.5);border:1px solid transparent;
    transition:all .3s ease;letter-spacing:.5px;text-transform:uppercase;
    background:none;outline:none;
  }
  .slide-tab:hover{color:var(--stain-teal);border-color:rgba(136,181,196,.2)}
  .slide-tab.active{
    color:var(--slide-white);background:rgba(136,181,196,.15);
    border-color:var(--stain-teal);
  }
  .slide-tab .tab-dot{
    display:inline-block;width:6px;height:6px;border-radius:50%;
    margin-right:6px;vertical-align:middle;
  }

  /* ── GRID OVERLAY (subtle) ── */
  .grid-overlay{
    position:absolute;inset:0;pointer-events:none;z-index:30;opacity:.03;
    background-image:
      linear-gradient(rgba(10,22,40,1) 1px, transparent 1px),
      linear-gradient(90deg, rgba(10,22,40,1) 1px, transparent 1px);
    background-size:40px 40px;
    border-radius:50%;
  }

  /* ── SCALE BAR ── */
  .scale-bar{
    position:absolute;bottom:15%;right:18%;z-index:45;pointer-events:none;
    display:flex;align-items:center;gap:6px;
  }
  .scale-line{width:50px;height:2px;background:rgba(10,22,40,.2)}
  .scale-text{font-family:'JetBrains Mono',monospace;font-size:8px;color:rgba(10,22,40,.3)}

  /* ── AMBIENT PARTICLES ── */
  .particle{
    position:absolute;border-radius:50%;pointer-events:none;z-index:5;
    animation:drift linear infinite;opacity:.15;
  }
  @keyframes drift{
    0%{transform:translate(0,0) rotate(0deg)}
    25%{transform:translate(20px,-15px) rotate(90deg)}
    50%{transform:translate(-10px,25px) rotate(180deg)}
    75%{transform:translate(15px,10px) rotate(270deg)}
    100%{transform:translate(0,0) rotate(360deg)}
  }

  /* ── MAG INDICATOR IN VIEWPORT ── */
  .mag-badge{
    position:absolute;top:12%;left:50%;transform:translateX(-50%);z-index:45;
    font-family:'JetBrains Mono',monospace;font-size:10px;
    color:rgba(10,22,40,.25);letter-spacing:2px;
    transition:all .4s;
  }

  /* ── ANIMATIONS ── */
  @keyframes pulse-ring{
    0%,100%{box-shadow:0 0 0 0 rgba(136,181,196,.1)}
    50%{box-shadow:0 0 0 6px rgba(136,181,196,0)}
  }
  .eyepiece-bezel::after{
    content:'';position:absolute;inset:-4px;border-radius:50%;
    border:1px solid rgba(136,181,196,.08);
    animation:pulse-ring 4s ease infinite;
  }

  /* ── INTRO ANIMATION ── */
  .microscope-shell.intro .eyepiece-bezel{animation:intro-zoom 1.2s cubic-bezier(.25,.46,.45,.94) forwards}
  @keyframes intro-zoom{
    0%{transform:scale(.3);opacity:0}
    100%{transform:scale(1);opacity:1}
  }

  /* Responsive */
  @media(max-width:768px){
    .eyepiece-bezel{width:min(90vw,90vh);height:min(90vw,90vh)}
    .mag-dial{right:12px;transform:translateY(-50%) scale(.85)}
    .specimen-info{left:12px;top:12px}
    .specimen-info .name{font-size:16px}
    .readout{left:12px;bottom:60px}
    .slide-carousel{bottom:8px;padding:6px 10px}
    .slide-tab{font-size:8px;padding:4px 10px}
    .focus-indicator{right:12px;bottom:60px}
    .mag-titles{grid-template-columns:1fr;padding:18%}
  }
</style>
</head>
<body>

<div class="microscope-shell intro" id="shell">

  <!-- Specimen Info -->
  <div class="specimen-info">
    <div class="name">Anshull Garg</div>
    <div class="role">Software Developer, Walmart</div>
    <div class="sample-id">Sample: AG-2026-01</div>
    <div class="date-stamp">Prepared: 2026.02.08 | Stain: H&amp;E Modified</div>
  </div>

  <!-- Readout -->
  <div class="readout">
    <div class="readout-row"><span class="label">MAG</span><span class="value" id="readout-mag">1x</span></div>
    <div class="readout-row"><span class="label">FOCUS</span><span class="value" id="readout-focus">100%</span></div>
    <div class="readout-row"><span class="label">SLIDE</span><span class="value" id="readout-slide">ALL</span></div>
    <div class="readout-row"><span class="label">FIELD</span><span class="value">BRIGHT</span></div>
    <div class="readout-row"><span class="label">TEMP</span><span class="value">21.4C</span></div>
  </div>

  <!-- Eyepiece -->
  <div class="eyepiece-bezel">
    <div class="viewport" id="viewport">

      <!-- Magnification badge -->
      <div class="mag-badge" id="mag-badge">1x</div>

      <!-- Grid overlay -->
      <div class="grid-overlay"></div>

      <!-- Crosshair -->
      <div class="crosshair"><div class="crosshair-center"></div></div>

      <!-- Lens vignette -->
      <div class="lens-vignette"></div>

      <!-- Scale bar -->
      <div class="scale-bar">
        <div class="scale-line"></div>
        <div class="scale-text" id="scale-text">500 um</div>
      </div>

      <!-- Ambient particles -->
      <div id="particles"></div>

      <!-- Slide content container -->
      <div class="slide-content" id="slide-content">

        <!-- === 1x BLOBS === -->
        <div class="mag-blobs mag-layer active" id="layer-1x">
          <div class="blob-cluster" id="blob-cluster"></div>
        </div>

        <!-- === 10x TITLES === -->
        <div class="mag-titles mag-layer" id="layer-10x"></div>

        <!-- === 100x DETAILS === -->
        <div class="mag-details mag-layer" id="layer-100x"></div>

        <!-- === 1000x CODE === -->
        <div class="mag-code mag-layer" id="layer-1000x"></div>

      </div>
    </div>
  </div>

  <!-- Magnification Dial -->
  <div class="mag-dial">
    <div class="mag-dial-label">Mag</div>
    <div class="mag-track" id="mag-track">
      <div class="mag-fill" id="mag-fill" style="height:0%"></div>
      <div class="mag-knob" id="mag-knob" style="bottom:0%"></div>
      <div class="mag-stops">
        <div class="mag-stop" data-mag="1000" data-pos="100">1000x</div>
        <div class="mag-stop" data-mag="100" data-pos="66">100x</div>
        <div class="mag-stop" data-mag="10" data-pos="33">10x</div>
        <div class="mag-stop active" data-mag="1" data-pos="0">1x</div>
      </div>
    </div>
  </div>

  <!-- Focus indicator -->
  <div class="focus-indicator">
    <div class="focus-label">Focus</div>
    <div class="focus-ring sharp" id="focus-ring"><div class="focus-dot"></div></div>
    <div class="focus-value" id="focus-value">100%</div>
  </div>

  <!-- Slide Carousel -->
  <div class="slide-carousel" id="slide-carousel"></div>

</div>

<script>
// ── DATA ──
const CATEGORIES = [
  { id:'all', name:'All', color:'var(--stain-teal)' },
  { id:'frontend', name:'Frontend', color:'var(--eosin-pink)' },
  { id:'backend', name:'Backend', color:'var(--stain-teal)' },
  { id:'infra', name:'Infra', color:'var(--golgi-gold)' },
  { id:'data', name:'Data', color:'var(--nissl-violet)' },
];

const PROJECTS = [
  {
    id:'AG-2026-01',
    title:'Walmart Checkout Orchestrator',
    category:'frontend',
    color:'var(--eosin-pink)',
    blobSize:90,
    blobX:25, blobY:30,
    desc:'Rebuilt the checkout flow serving 240M+ weekly customers. Implemented micro-frontend architecture with module federation, reducing page load by 40% and increasing conversion by 2.3%.',
    tech:['React 18','TypeScript','Module Federation','GraphQL','Zustand','Playwright'],
    file:'checkout/Orchestrator.tsx',
    code:`<span class="kw">import</span> { <span class="fn">useCheckoutState</span> } <span class="kw">from</span> <span class="str">'@walmart/checkout-core'</span>;
<span class="kw">import</span> { <span class="fn">PaymentGateway</span> } <span class="kw">from</span> <span class="str">'./gateways'</span>;

<span class="cm">// Orchestrates multi-step checkout with</span>
<span class="cm">// optimistic updates and rollback support</span>
<span class="kw">export const</span> <span class="fn">CheckoutOrchestrator</span>: <span class="type">FC</span> = () => {
  <span class="kw">const</span> { cart, step, <span class="fn">advance</span> } =
    <span class="fn">useCheckoutState</span>();
  <span class="kw">const</span> [pending, <span class="fn">setPending</span>] =
    <span class="fn">useState</span><<span class="type">boolean</span>>(<span class="num">false</span>);

  <span class="kw">const</span> <span class="fn">handlePayment</span> = <span class="kw">async</span> () => {
    <span class="fn">setPending</span>(<span class="num">true</span>);
    <span class="kw">await</span> <span class="type">PaymentGateway</span>.<span class="fn">process</span>({
      items: cart.items,
      total: cart.<span class="fn">getTotal</span>(),
    });
    <span class="fn">advance</span>(<span class="str">'confirmation'</span>);
  };
};`
  },
  {
    id:'AG-2026-02',
    title:'Real-Time Inventory Sync Engine',
    category:'backend',
    color:'var(--stain-teal)',
    blobSize:80,
    blobX:60, blobY:25,
    desc:'Event-driven inventory synchronization across 4,700+ stores. Processes 2M+ events/min via Kafka streams with exactly-once semantics. Reduced stock discrepancies by 67%.',
    tech:['Java 21','Kafka Streams','Redis','gRPC','Kubernetes','Prometheus'],
    file:'inventory/SyncEngine.java',
    code:`<span class="cm">/**
 * Processes inventory deltas from store POS
 * systems with exactly-once delivery semantics.
 */</span>
<span class="kw">public class</span> <span class="type">SyncEngine</span>
    <span class="kw">implements</span> <span class="type">StreamProcessor</span> {

  <span class="kw">private final</span> <span class="type">KafkaStreams</span> streams;
  <span class="kw">private final</span> <span class="type">StateStore</span>&lt;<span class="type">String</span>,
    <span class="type">InventoryDelta</span>&gt; store;

  @<span class="fn">Override</span>
  <span class="kw">public void</span> <span class="fn">process</span>(
      <span class="type">Record</span>&lt;<span class="type">String</span>, <span class="type">Delta</span>&gt; record) {
    <span class="type">InventoryDelta</span> delta =
      record.<span class="fn">value</span>();
    store.<span class="fn">put</span>(delta.<span class="fn">sku</span>(),
      delta.<span class="fn">merge</span>(store.<span class="fn">get</span>(
        delta.<span class="fn">sku</span>())));
    context.<span class="fn">forward</span>(record);
  }
}`
  },
  {
    id:'AG-2026-03',
    title:'Predictive Search Autocomplete',
    category:'frontend',
    color:'var(--eosin-pink)',
    blobSize:70,
    blobX:38, blobY:58,
    desc:'ML-powered search autocomplete handling 50K+ queries/sec. Implemented trie-based suggestion engine with personalized ranking, debounced input, and virtual scrolling for results.',
    tech:['React','TypeScript','WebWorkers','Trie DS','TensorFlow.js','Virtuoso'],
    file:'search/Autocomplete.tsx',
    code:`<span class="cm">// Debounced search with Web Worker</span>
<span class="cm">// trie lookups for sub-ms suggestions</span>
<span class="kw">const</span> <span class="fn">useSearch</span> = (query: <span class="type">string</span>) => {
  <span class="kw">const</span> worker = <span class="fn">useRef</span>(
    <span class="kw">new</span> <span class="type">Worker</span>(<span class="str">'/search.worker.js'</span>)
  );
  <span class="kw">const</span> [results, <span class="fn">setResults</span>] =
    <span class="fn">useState</span>&lt;<span class="type">Suggestion</span>[]&gt;([]);

  <span class="fn">useEffect</span>(() => {
    <span class="kw">const</span> id = <span class="fn">setTimeout</span>(() => {
      worker.current.<span class="fn">postMessage</span>({
        type: <span class="str">'SEARCH'</span>,
        payload: { query, limit: <span class="num">20</span> }
      });
    }, <span class="num">150</span>);
    <span class="kw">return</span> () => <span class="fn">clearTimeout</span>(id);
  }, [query]);

  <span class="kw">return</span> results;
};`
  },
  {
    id:'AG-2026-04',
    title:'CI/CD Pipeline Optimizer',
    category:'infra',
    color:'var(--golgi-gold)',
    blobSize:65,
    blobX:72, blobY:55,
    desc:'Intelligent build pipeline that analyzes code change graphs to skip unnecessary test suites. Reduced average pipeline time from 45min to 12min across 300+ microservices.',
    tech:['Go','GitHub Actions','Docker','BuildKit','Terraform','Grafana'],
    file:'pipeline/optimizer.go',
    code:`<span class="cm">// BuildGraph analyzes changed files to</span>
<span class="cm">// determine minimum required test suites</span>
<span class="kw">func</span> (<span class="type">bg</span> *<span class="type">BuildGraph</span>) <span class="fn">Optimize</span>(
  changes []<span class="type">FileChange</span>,
) []<span class="type">TestSuite</span> {
  affected := <span class="fn">make</span>(<span class="kw">map</span>[<span class="type">string</span>]<span class="type">bool</span>)

  <span class="kw">for</span> _, c := <span class="kw">range</span> changes {
    deps := bg.graph.<span class="fn">Dependents</span>(
      c.Path,
    )
    <span class="kw">for</span> _, d := <span class="kw">range</span> deps {
      affected[d] = <span class="num">true</span>
    }
  }

  suites := bg.<span class="fn">ResolveSuites</span>(affected)
  <span class="fn">sort</span>.<span class="fn">Slice</span>(suites, <span class="kw">func</span>(i, j <span class="type">int</span>) <span class="type">bool</span> {
    <span class="kw">return</span> suites[i].Priority >
      suites[j].Priority
  })
  <span class="kw">return</span> suites
}`
  },
  {
    id:'AG-2026-05',
    title:'Customer Analytics Dashboard',
    category:'data',
    color:'var(--nissl-violet)',
    blobSize:75,
    blobX:18, blobY:65,
    desc:'Real-time analytics dashboard processing petabytes of customer interaction data. Built with streaming aggregations, custom D3 visualizations, and sub-second query response times.',
    tech:['React','D3.js','Apache Flink','ClickHouse','WebSocket','Recharts'],
    file:'analytics/StreamAgg.ts',
    code:`<span class="cm">// Streaming window aggregation for</span>
<span class="cm">// real-time customer behavior metrics</span>
<span class="kw">interface</span> <span class="type">WindowConfig</span> {
  size: <span class="type">Duration</span>;
  slide: <span class="type">Duration</span>;
  watermark: <span class="type">Duration</span>;
}

<span class="kw">class</span> <span class="type">StreamAggregator</span>&lt;<span class="type">T</span>&gt; {
  <span class="kw">private</span> windows: <span class="type">Map</span>&lt;<span class="type">number</span>,
    <span class="type">WindowState</span>&lt;<span class="type">T</span>&gt;&gt; = <span class="kw">new</span> <span class="type">Map</span>();

  <span class="fn">ingest</span>(event: <span class="type">TimestampedEvent</span>&lt;<span class="type">T</span>&gt;) {
    <span class="kw">const</span> windowKey = <span class="type">Math</span>.<span class="fn">floor</span>(
      event.ts / <span class="kw">this</span>.config.slide
    );
    <span class="kw">const</span> state = <span class="kw">this</span>.windows
      .<span class="fn">get</span>(windowKey) ?? <span class="fn">empty</span>();
    state.<span class="fn">accumulate</span>(event.payload);
    <span class="kw">this</span>.<span class="fn">emit</span>(windowKey, state);
  }
}`
  },
  {
    id:'AG-2026-06',
    title:'Design System Component Library',
    category:'frontend',
    color:'var(--eosin-pink)',
    blobSize:72,
    blobX:50, blobY:42,
    desc:'Enterprise design system used across 40+ Walmart internal applications. 120+ accessible components with theme support, RTL, and comprehensive Storybook documentation.',
    tech:['React','TypeScript','Radix UI','Tailwind CSS','Storybook','Chromatic'],
    file:'components/Button.tsx',
    code:`<span class="cm">// Polymorphic button with compound</span>
<span class="cm">// variants and accessibility built-in</span>
<span class="kw">type</span> <span class="type">ButtonProps</span>&lt;<span class="type">C</span> <span class="kw">extends</span>
  <span class="type">ElementType</span>&gt; = {
  as?: <span class="type">C</span>;
  variant: <span class="str">'primary'</span> | <span class="str">'ghost'</span> | <span class="str">'danger'</span>;
  size: <span class="str">'sm'</span> | <span class="str">'md'</span> | <span class="str">'lg'</span>;
  loading?: <span class="type">boolean</span>;
} & <span class="type">ComponentPropsWithoutRef</span>&lt;<span class="type">C</span>&gt;;

<span class="kw">export const</span> <span class="fn">Button</span> = <span class="kw">forwardRef</span>(
  &lt;<span class="type">C</span> <span class="kw">extends</span> <span class="type">ElementType</span> = <span class="str">"button"</span>&gt;(
    { as, variant, size, loading,
      children, ...props }: <span class="type">ButtonProps</span>&lt;<span class="type">C</span>&gt;,
    ref: <span class="type">Ref</span>&lt;<span class="type">C</span>&gt;
  ) => {
    <span class="kw">const</span> Comp = as || <span class="str">"button"</span>;
    <span class="kw">return</span> (
      &lt;<span class="type">Comp</span>
        ref={ref}
        aria-busy={loading}
        className={<span class="fn">cn</span>(styles[variant],
          styles[size])}
        {...props}
      &gt;{children}&lt;/<span class="type">Comp</span>&gt;
    );
  }
);`
  },
];

// ── STATE ──
let currentMag = 1;   // 1, 10, 100, 1000
let currentFocus = 100; // 0-100
let currentSlide = 'all';
let dragActive = false;

// ── INIT ──
document.addEventListener('DOMContentLoaded', () => {
  buildCarousel();
  buildParticles();
  renderAllLayers();
  setMagnification(1);

  // Remove intro class after animation
  setTimeout(() => {
    document.getElementById('shell').classList.remove('intro');
  }, 1300);
});

// ── BUILD SLIDE CAROUSEL ──
function buildCarousel() {
  const el = document.getElementById('slide-carousel');
  CATEGORIES.forEach((cat, i) => {
    const btn = document.createElement('button');
    btn.className = 'slide-tab' + (i === 0 ? ' active' : '');
    btn.dataset.cat = cat.id;
    btn.innerHTML = `<span class="tab-dot" style="background:${cat.color}"></span>${cat.name}`;
    btn.addEventListener('click', () => switchSlide(cat.id));
    el.appendChild(btn);
  });
}

// ── BUILD PARTICLES ──
function buildParticles() {
  const container = document.getElementById('particles');
  for (let i = 0; i < 12; i++) {
    const p = document.createElement('div');
    p.className = 'particle';
    const size = 2 + Math.random() * 6;
    const colors = ['var(--stain-teal)','var(--eosin-pink)','var(--fluor-lavender)','var(--golgi-gold)'];
    p.style.cssText = `
      width:${size}px;height:${size}px;
      background:${colors[Math.floor(Math.random()*colors.length)]};
      left:${10 + Math.random()*80}%;top:${10 + Math.random()*80}%;
      animation-duration:${8 + Math.random()*12}s;
      animation-delay:${-Math.random()*10}s;
    `;
    container.appendChild(p);
  }
}

// ── RENDER LAYERS ──
function renderAllLayers() {
  renderBlobs();
  renderTitles();
  renderDetails();
  renderCode();
}

function getFilteredProjects() {
  if (currentSlide === 'all') return PROJECTS;
  return PROJECTS.filter(p => p.category === currentSlide);
}

function renderBlobs() {
  const cluster = document.getElementById('blob-cluster');
  cluster.innerHTML = '';
  const projects = getFilteredProjects();
  projects.forEach(p => {
    const blob = document.createElement('div');
    blob.className = 'blob';
    blob.style.cssText = `
      width:${p.blobSize}px;height:${p.blobSize}px;
      left:${p.blobX}%;top:${p.blobY}%;
      background:${p.color};
      filter:blur(2px);
    `;
    blob.innerHTML = `<div class="blob-label">${p.id}</div>`;
    blob.addEventListener('click', () => setMagnification(10));
    cluster.appendChild(blob);
  });
}

function renderTitles() {
  const el = document.getElementById('layer-10x');
  el.innerHTML = '';
  const projects = getFilteredProjects();
  projects.forEach(p => {
    const card = document.createElement('div');
    card.className = 'title-card';
    card.innerHTML = `
      <div class="specimen-id">${p.id}</div>
      <h3>${p.title}</h3>
      <div class="thumb-bar" style="background:${p.color};width:${30+Math.random()*50}%"></div>
    `;
    card.addEventListener('click', () => setMagnification(100));
    el.appendChild(card);
  });
}

function renderDetails() {
  const el = document.getElementById('layer-100x');
  el.innerHTML = '';
  const projects = getFilteredProjects();
  projects.forEach(p => {
    const card = document.createElement('div');
    card.className = 'detail-card';
    card.innerHTML = `
      <div class="card-header">
        <h3>${p.title}</h3>
        <span class="spec-label">${p.id}</span>
      </div>
      <p>${p.desc}</p>
      <div class="tech-tags">
        ${p.tech.map(t => `<span class="tech-tag">${t}</span>`).join('')}
      </div>
    `;
    card.addEventListener('click', () => setMagnification(1000));
    el.appendChild(card);
  });
}

function renderCode() {
  const el = document.getElementById('layer-1000x');
  el.innerHTML = '';
  const projects = getFilteredProjects();
  projects.forEach(p => {
    const block = document.createElement('div');
    block.className = 'code-block';
    block.innerHTML = `
      <div class="code-file">// ${p.file} &mdash; ${p.id}</div>
      <pre>${p.code}</pre>
    `;
    // Left accent bar
    const bar = document.createElement('div');
    bar.style.cssText = `position:absolute;left:0;top:0;bottom:0;width:3px;background:${p.color};border-radius:3px 0 0 3px;`;
    block.appendChild(bar);
    el.appendChild(block);
  });
}

// ── SET MAGNIFICATION ──
function setMagnification(mag) {
  currentMag = mag;
  const levels = [1, 10, 100, 1000];
  const idx = levels.indexOf(mag);

  // Update layers
  document.querySelectorAll('.mag-layer').forEach(l => l.classList.remove('active'));
  const layerIds = ['layer-1x','layer-10x','layer-100x','layer-1000x'];
  document.getElementById(layerIds[idx]).classList.add('active');

  // Update dial
  const positions = [0, 33, 66, 100];
  const pos = positions[idx];
  document.getElementById('mag-fill').style.height = pos + '%';
  document.getElementById('mag-knob').style.bottom = pos + '%';

  // Update stops
  document.querySelectorAll('.mag-stop').forEach(s => {
    s.classList.toggle('active', parseInt(s.dataset.mag) === mag);
  });

  // Update badge + readout
  document.getElementById('mag-badge').textContent = mag + 'x';
  document.getElementById('readout-mag').textContent = mag + 'x';

  // Scale text
  const scales = ['500 um','50 um','5 um','500 nm'];
  document.getElementById('scale-text').textContent = scales[idx];

  // Grid density
  const gridSizes = ['40px 40px','30px 30px','20px 20px','14px 14px'];
  document.querySelector('.grid-overlay').style.backgroundSize = gridSizes[idx];
}

// ── SLIDE SWITCHING ──
function switchSlide(catId) {
  currentSlide = catId;
  document.querySelectorAll('.slide-tab').forEach(t => {
    t.classList.toggle('active', t.dataset.cat === catId);
  });
  document.getElementById('readout-slide').textContent = catId.toUpperCase();
  renderAllLayers();
  // Re-apply current mag layer
  setMagnification(currentMag);
}

// ── FOCUS KNOB (scroll wheel) ──
document.addEventListener('wheel', (e) => {
  e.preventDefault();
  currentFocus = Math.max(0, Math.min(100, currentFocus - e.deltaY * 0.3));
  applyFocus();
}, { passive: false });

function applyFocus() {
  const vp = document.getElementById('viewport');
  vp.classList.remove('blurred-1','blurred-2','blurred-3');
  if (currentFocus < 30) vp.classList.add('blurred-3');
  else if (currentFocus < 60) vp.classList.add('blurred-2');
  else if (currentFocus < 85) vp.classList.add('blurred-1');

  const ring = document.getElementById('focus-ring');
  ring.classList.toggle('sharp', currentFocus >= 85);
  ring.classList.toggle('blurred', currentFocus < 85);

  document.getElementById('focus-value').textContent = Math.round(currentFocus) + '%';
  document.getElementById('readout-focus').textContent = Math.round(currentFocus) + '%';
}

// ── MAG DIAL INTERACTION ──
// Click stops
document.querySelectorAll('.mag-stop').forEach(s => {
  s.addEventListener('click', () => {
    setMagnification(parseInt(s.dataset.mag));
  });
});

// Drag knob
const magKnob = document.getElementById('mag-knob');
const magTrack = document.getElementById('mag-track');

magKnob.addEventListener('mousedown', (e) => {
  e.preventDefault();
  dragActive = true;
});
document.addEventListener('mousemove', (e) => {
  if (!dragActive) return;
  const rect = magTrack.getBoundingClientRect();
  const pct = 1 - (e.clientY - rect.top) / rect.height;
  const clamped = Math.max(0, Math.min(1, pct));
  // Snap to nearest stop
  const stops = [0, 0.33, 0.66, 1];
  const mags = [1, 10, 100, 1000];
  let closest = 0;
  let minDist = Infinity;
  stops.forEach((s, i) => {
    const d = Math.abs(clamped - s);
    if (d < minDist) { minDist = d; closest = i; }
  });
  setMagnification(mags[closest]);
});
document.addEventListener('mouseup', () => { dragActive = false; });

// Touch support for mag dial
magKnob.addEventListener('touchstart', (e) => {
  e.preventDefault();
  dragActive = true;
});
document.addEventListener('touchmove', (e) => {
  if (!dragActive) return;
  const touch = e.touches[0];
  const rect = magTrack.getBoundingClientRect();
  const pct = 1 - (touch.clientY - rect.top) / rect.height;
  const clamped = Math.max(0, Math.min(1, pct));
  const stops = [0, 0.33, 0.66, 1];
  const mags = [1, 10, 100, 1000];
  let closest = 0;
  let minDist = Infinity;
  stops.forEach((s, i) => {
    const d = Math.abs(clamped - s);
    if (d < minDist) { minDist = d; closest = i; }
  });
  setMagnification(mags[closest]);
});
document.addEventListener('touchend', () => { dragActive = false; });

// ── KEYBOARD NAV ──
document.addEventListener('keydown', (e) => {
  const levels = [1, 10, 100, 1000];
  const idx = levels.indexOf(currentMag);
  if (e.key === 'ArrowUp' || e.key === '+' || e.key === '=') {
    if (idx < 3) setMagnification(levels[idx + 1]);
  } else if (e.key === 'ArrowDown' || e.key === '-') {
    if (idx > 0) setMagnification(levels[idx - 1]);
  } else if (e.key >= '1' && e.key <= '5') {
    const catIdx = parseInt(e.key) - 1;
    if (catIdx < CATEGORIES.length) switchSlide(CATEGORIES[catIdx].id);
  }
});
</script>

</body>
</html>
