<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Anshull Garg | Clockwork Portfolio</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#1A1A1E;--bg-light:#222228;--brass:#B8860B;--brass-light:#D4A853;
  --brass-dark:#8B6508;--copper:#C87941;--steel:#8B8B8B;--steel-dark:#5A5A5A;
  --steel-light:#ABABAB;--gold:#FFD700;--text:#E8E0D0;--text-dim:#9A9080;
  --panel-bg:#1E1E24;
  --speed:1;
}
html,body{height:100%;overflow:hidden;background:var(--bg);color:var(--text);font-family:'Inter',sans-serif}
body{position:relative}

/* === AGED METAL BACKGROUND === */
.bg-texture{position:fixed;inset:0;z-index:0;pointer-events:none}
.bg-texture::before{content:'';position:absolute;inset:0;
  background:
    radial-gradient(ellipse 80% 60% at 50% 40%,rgba(184,134,11,0.04),transparent),
    radial-gradient(ellipse 40% 30% at 20% 70%,rgba(200,121,65,0.03),transparent),
    radial-gradient(ellipse 50% 40% at 80% 30%,rgba(139,139,139,0.03),transparent);
}
.bg-texture::after{content:'';position:absolute;inset:0;
  background-image:url("data:image/svg+xml,%3Csvg width='200' height='200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='200' height='200' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
  opacity:0.5;
}

/* === CLOCK FACE TICK MARKS === */
.clock-frame{position:fixed;inset:0;z-index:1;pointer-events:none}
.tick-mark{position:absolute;background:var(--steel-dark);opacity:0.3}

/* === MAIN MECHANISM === */
.mechanism{position:fixed;inset:0;z-index:2;display:flex;align-items:center;justify-content:center}
.mechanism-inner{position:relative;width:100vw;height:100vh}

/* === CONNECTION LINES BETWEEN GEARS === */
.gear-connections{position:fixed;inset:0;z-index:3;pointer-events:none}

/* === BACKGROUND DECORATIVE GEARS === */
.bg-gear{position:absolute;z-index:1;pointer-events:none;opacity:0.04}
.bg-gear svg{display:block}
.bg-gear.spin-slow svg{animation:spinCW 60s linear infinite}
.bg-gear.spin-slow-r svg{animation:spinCCW 45s linear infinite}

/* === GEAR STYLES === */
.gear-wrapper{position:absolute;cursor:pointer;z-index:5;transform:translate(-50%,-50%);
  transition:transform 0.3s cubic-bezier(0.4,0,0.2,1)}
.gear-wrapper:hover{transform:translate(-50%,-50%) scale(1.04)}
.gear-wrapper:hover .gear-body{filter:brightness(1.25) drop-shadow(0 0 20px rgba(184,134,11,0.5))}
.gear-wrapper.selected{transform:translate(-50%,-50%) scale(1.06)}
.gear-wrapper.selected .gear-body{filter:brightness(1.35) drop-shadow(0 0 30px rgba(200,121,65,0.7)) drop-shadow(0 0 60px rgba(200,121,65,0.3))}
.gear-wrapper.selected .gear-label{color:#E8A050}
.gear-svg{display:block}
.gear-body{transition:filter 0.4s ease}

/* Gear rotation */
@keyframes spinCW{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
@keyframes spinCCW{from{transform:rotate(0deg)}to{transform:rotate(-360deg)}}
.gear-spin-cw .gear-svg{animation:spinCW calc(20s / var(--speed)) linear infinite}
.gear-spin-ccw .gear-svg{animation:spinCCW calc(20s / var(--speed)) linear infinite}
.gear-spin-cw.size-sm .gear-svg{animation-duration:calc(12s / var(--speed))}
.gear-spin-ccw.size-sm .gear-svg{animation-duration:calc(12s / var(--speed))}
.gear-spin-cw.size-lg .gear-svg{animation-duration:calc(30s / var(--speed))}
.gear-spin-ccw.size-lg .gear-svg{animation-duration:calc(30s / var(--speed))}

/* Slowdown when panel is open */
.mechanism-inner.panel-active .gear-wrapper:not(.selected) .gear-svg{
  animation-duration:calc(60s / var(--speed)) !important;
}

/* Gear label (stays still while gear rotates) */
.gear-label-wrap{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;pointer-events:none;z-index:6}
.gear-label{font-family:'Cinzel',serif;font-weight:700;color:var(--brass-light);
  text-shadow:0 2px 4px rgba(0,0,0,0.9),0 0 20px rgba(0,0,0,0.5);
  letter-spacing:0.08em;text-align:center;line-height:1.2;transition:color 0.4s,text-shadow 0.4s}
.gear-wrapper.selected .gear-label{text-shadow:0 2px 4px rgba(0,0,0,0.9),0 0 30px rgba(200,121,65,0.3)}
.gear-sublabel{font-family:'JetBrains Mono',monospace;font-size:0.55em;color:var(--text-dim);font-weight:300;display:block;margin-top:4px;letter-spacing:0.15em}

/* === DECORATIVE ELEMENTS === */
/* Pendulum */
.pendulum-wrap{position:fixed;top:0;right:60px;z-index:3;pointer-events:none}
.pendulum{transform-origin:50% 0%;animation:swing 3s ease-in-out infinite}
@keyframes swing{0%,100%{transform:rotate(12deg)}50%{transform:rotate(-12deg)}}
.pendulum line{stroke:var(--steel);stroke-width:2}

/* Steam particles */
.steam-container{position:fixed;bottom:0;left:0;width:100%;height:100%;z-index:1;pointer-events:none;overflow:hidden}
.steam{position:absolute;border-radius:50%;animation:rise linear infinite}
@keyframes rise{
  0%{transform:translateY(0) translateX(0) scale(1);opacity:0}
  10%{opacity:0.2}
  50%{opacity:0.1;transform:translateY(-150px) translateX(20px) scale(2)}
  100%{transform:translateY(-350px) translateX(-10px) scale(3.5);opacity:0}
}

/* Winding key */
.winding-key{position:fixed;top:30px;left:30px;z-index:20;cursor:pointer;display:flex;align-items:center;gap:12px;
  background:linear-gradient(145deg,#2A2A30 0%,#1E1E24 100%);
  border:1px solid var(--steel-dark);border-radius:10px;padding:12px 20px;
  transition:all 0.3s;user-select:none;
  box-shadow:0 2px 10px rgba(0,0,0,0.3),inset 0 1px 0 rgba(255,255,255,0.03)}
.winding-key:hover{border-color:var(--brass);background:linear-gradient(145deg,#2E2E34,#222228);
  box-shadow:0 2px 20px rgba(184,134,11,0.15),inset 0 1px 0 rgba(255,255,255,0.05)}
.winding-key:active{transform:scale(0.96)}
.winding-key .key-icon{transition:transform 0.3s}
.winding-key:hover .key-icon{transform:rotate(45deg)}
.winding-key .key-label{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--text-dim);letter-spacing:0.12em;text-transform:uppercase}
.winding-key .key-speed{font-family:'JetBrains Mono',monospace;font-size:14px;color:var(--brass-light);font-weight:700;margin-top:1px}

/* Decorative springs */
.spring{position:fixed;z-index:1;pointer-events:none;opacity:0.12}

/* === CONTENT PANEL === */
.content-panel{position:fixed;top:0;right:0;width:480px;max-width:92vw;height:100vh;
  background:linear-gradient(180deg,#1F1F25 0%,#19191E 50%,#1A1A20 100%);
  border-left:1px solid rgba(184,134,11,0.25);
  z-index:50;transform:translateX(100%);transition:transform 0.5s cubic-bezier(0.4,0,0.2,1);
  overflow-y:auto;overflow-x:hidden;
  box-shadow:-20px 0 60px rgba(0,0,0,0.6),-5px 0 20px rgba(0,0,0,0.3)}
.content-panel.open{transform:translateX(0)}
.content-panel::before{content:'';position:absolute;top:0;left:0;width:3px;height:100%;
  background:linear-gradient(180deg,transparent,var(--brass),var(--copper),var(--brass),transparent);opacity:0.4}

.panel-close{position:sticky;top:0;float:right;margin:20px 20px 0 0;width:40px;height:40px;
  border:1px solid var(--steel-dark);border-radius:50%;background:var(--bg);
  color:var(--steel-light);cursor:pointer;font-size:18px;
  display:flex;align-items:center;justify-content:center;
  transition:all 0.3s;z-index:51}
.panel-close:hover{border-color:var(--copper);color:var(--copper);transform:rotate(90deg);
  box-shadow:0 0 15px rgba(200,121,65,0.2)}

.panel-content{padding:20px 40px 60px}
.panel-section{font-family:'Cinzel',serif;font-size:28px;color:var(--brass-light);
  letter-spacing:0.12em;margin-bottom:8px;font-weight:700;
  background:linear-gradient(135deg,var(--brass-light),var(--copper));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.panel-divider{width:80px;height:2px;margin-bottom:30px;position:relative;
  background:linear-gradient(90deg,var(--copper),var(--brass),transparent)}
.panel-divider::after{content:'';position:absolute;left:0;top:-2px;width:6px;height:6px;
  border-radius:50%;background:var(--copper)}
.panel-text{font-family:'Inter',sans-serif;font-size:14px;line-height:1.85;color:var(--text-dim);margin-bottom:20px}
.panel-text strong{color:var(--text);font-weight:600}

/* Panel cards */
.info-card{background:linear-gradient(135deg,rgba(184,134,11,0.05) 0%,rgba(200,121,65,0.02) 100%);
  border:1px solid rgba(184,134,11,0.12);border-radius:10px;padding:22px 26px;margin-bottom:16px;
  transition:all 0.3s;position:relative;overflow:hidden}
.info-card::before{content:'';position:absolute;top:0;left:0;width:3px;height:100%;
  background:linear-gradient(180deg,var(--brass),var(--copper));opacity:0;transition:opacity 0.3s}
.info-card:hover{border-color:rgba(184,134,11,0.3);
  background:linear-gradient(135deg,rgba(184,134,11,0.08),rgba(200,121,65,0.04));
  transform:translateX(4px)}
.info-card:hover::before{opacity:1}
.info-card-title{font-family:'Cinzel',serif;font-size:16px;color:var(--brass-light);margin-bottom:6px;font-weight:700}
.info-card-sub{font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--copper);letter-spacing:0.06em;margin-bottom:10px}
.info-card-text{font-family:'Inter',sans-serif;font-size:13px;line-height:1.75;color:var(--text-dim)}

/* Skills */
.skill-row{display:flex;align-items:center;gap:12px;margin-bottom:16px}
.skill-name{font-family:'JetBrains Mono',monospace;font-size:12px;color:var(--text);width:130px;flex-shrink:0}
.skill-bar{flex:1;height:7px;background:rgba(139,139,139,0.1);border-radius:4px;overflow:hidden;position:relative}
.skill-fill{height:100%;border-radius:4px;
  background:linear-gradient(90deg,var(--brass-dark),var(--brass),var(--brass-light));
  transition:width 1.2s cubic-bezier(0.25,0.46,0.45,0.94);width:0;
  box-shadow:0 0 8px rgba(184,134,11,0.3)}
.skill-pct{font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--copper);width:36px;text-align:right;font-weight:500}

/* Contact */
.contact-link{display:flex;align-items:center;gap:16px;padding:16px 20px;
  border:1px solid rgba(139,139,139,0.12);border-radius:10px;margin-bottom:12px;
  text-decoration:none;color:var(--text);transition:all 0.3s;cursor:pointer}
.contact-link:hover{border-color:var(--brass);background:rgba(184,134,11,0.05);
  transform:translateX(4px);box-shadow:0 2px 15px rgba(184,134,11,0.08)}
.contact-icon{width:40px;height:40px;border-radius:50%;
  background:linear-gradient(135deg,var(--brass-dark),var(--brass));
  display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0;
  box-shadow:0 2px 8px rgba(0,0,0,0.3)}
.contact-label{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--text-dim);letter-spacing:0.08em;text-transform:uppercase}
.contact-value{font-family:'Inter',sans-serif;font-size:14px;color:var(--text);margin-top:3px}

/* Rivet decoration */
.rivet{width:8px;height:8px;border-radius:50%;
  background:radial-gradient(circle at 35% 35%,var(--steel-light),var(--steel-dark));
  box-shadow:inset 0 1px 2px rgba(255,255,255,0.15),0 1px 3px rgba(0,0,0,0.5);
  position:absolute;z-index:4}

/* Decorative corner brackets in panel */
.panel-bracket{position:absolute;width:16px;height:16px;opacity:0.2}
.panel-bracket.tl{top:12px;left:12px;border-top:1px solid var(--brass);border-left:1px solid var(--brass)}
.panel-bracket.br{bottom:12px;right:12px;border-bottom:1px solid var(--brass);border-right:1px solid var(--brass)}

/* Intro overlay */
.intro-overlay{position:fixed;inset:0;z-index:100;background:var(--bg);
  display:flex;align-items:center;justify-content:center;flex-direction:column;
  transition:opacity 1.2s ease,visibility 1.2s ease}
.intro-overlay.hidden{opacity:0;visibility:hidden;pointer-events:none}
.intro-title{font-family:'Cinzel',serif;font-size:clamp(26px,5vw,52px);color:var(--brass-light);
  letter-spacing:0.18em;margin-bottom:10px;opacity:0;animation:fadeUp 1s 0.5s forwards;
  background:linear-gradient(135deg,var(--brass-light),#E8C860,var(--copper));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.intro-sub{font-family:'JetBrains Mono',monospace;font-size:clamp(10px,1.5vw,13px);color:var(--text-dim);
  letter-spacing:0.3em;text-transform:uppercase;opacity:0;animation:fadeUp 1s 1s forwards}
.intro-hint{font-family:'Inter',sans-serif;font-size:12px;color:var(--steel);margin-top:50px;
  opacity:0;animation:fadeUp 1s 2.2s forwards;letter-spacing:0.1em}
.intro-gear{opacity:0;animation:fadeUp 1s 0.2s forwards;margin-bottom:20px}
@keyframes fadeUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}

/* Scrollbar */
.content-panel::-webkit-scrollbar{width:5px}
.content-panel::-webkit-scrollbar-track{background:transparent}
.content-panel::-webkit-scrollbar-thumb{background:var(--steel-dark);border-radius:3px}
.content-panel::-webkit-scrollbar-thumb:hover{background:var(--steel)}

/* Responsive */
@media(max-width:768px){
  .content-panel{width:100vw;max-width:100vw}
  .panel-content{padding:20px 20px 60px}
  .winding-key{top:auto;bottom:20px;left:20px;padding:8px 14px}
  .pendulum-wrap{display:none}
  .gear-label{font-size:0.75em !important}
  .spring{display:none}
}
@media(max-width:480px){
  .panel-section{font-size:22px}
  .skill-name{width:100px;font-size:11px}
}
</style>
</head>
<body>

<!-- Background texture -->
<div class="bg-texture"></div>

<!-- Clock face tick marks -->
<div class="clock-frame" id="clockFrame"></div>

<!-- Connection lines between gears -->
<svg class="gear-connections" id="gearConnections" style="position:fixed;inset:0;z-index:3;pointer-events:none"></svg>

<!-- Steam particles -->
<div class="steam-container" id="steamContainer"></div>

<!-- Background decorative gears -->
<div id="bgGears"></div>

<!-- Decorative springs -->
<svg class="spring" style="bottom:80px;left:50px" width="28" height="110" viewBox="0 0 28 110">
  <path d="M4,0 Q24,9 4,18 Q-16,27 4,36 Q24,45 4,54 Q-16,63 4,72 Q24,81 4,90 Q-16,99 4,108"
    fill="none" stroke="#8B8B8B" stroke-width="1.5" stroke-linecap="round"/>
</svg>
<svg class="spring" style="top:100px;right:530px" width="22" height="80" viewBox="0 0 22 80">
  <path d="M3,0 Q19,7 3,14 Q-13,21 3,28 Q19,35 3,42 Q-13,49 3,56 Q19,63 3,70"
    fill="none" stroke="#5A5A5A" stroke-width="1" stroke-linecap="round"/>
</svg>
<svg class="spring" style="bottom:180px;right:50px" width="18" height="70" viewBox="0 0 18 70">
  <path d="M3,0 Q15,6 3,12 Q-9,18 3,24 Q15,30 3,36 Q-9,42 3,48 Q15,54 3,60"
    fill="none" stroke="#6A6A6A" stroke-width="0.8" stroke-linecap="round"/>
</svg>

<!-- Pendulum -->
<div class="pendulum-wrap">
  <svg class="pendulum" width="40" height="320" viewBox="0 0 40 320">
    <defs>
      <radialGradient id="pendulumGrad" cx="38%" cy="32%">
        <stop offset="0%" stop-color="#E8C860"/>
        <stop offset="60%" stop-color="#B8860B"/>
        <stop offset="100%" stop-color="#7A5A08"/>
      </radialGradient>
      <radialGradient id="pendulumCenter" cx="45%" cy="40%">
        <stop offset="0%" stop-color="#333"/>
        <stop offset="100%" stop-color="#1A1A1E"/>
      </radialGradient>
    </defs>
    <!-- Rod -->
    <line x1="20" y1="0" x2="20" y2="265" stroke="#8B8B8B" stroke-width="2"/>
    <line x1="20" y1="0" x2="20" y2="265" stroke="#ABABAB" stroke-width="0.5" opacity="0.3"/>
    <!-- Bob -->
    <circle cx="20" cy="282" r="22" fill="url(#pendulumGrad)" stroke="#6A4A08" stroke-width="0.8"/>
    <circle cx="20" cy="282" r="14" fill="none" stroke="#9A7A20" stroke-width="0.5" opacity="0.4"/>
    <circle cx="20" cy="282" r="7" fill="url(#pendulumCenter)" stroke="#555" stroke-width="0.5"/>
    <!-- Screw on bob -->
    <line x1="17" y1="282" x2="23" y2="282" stroke="#666" stroke-width="1.2" stroke-linecap="round"/>
    <!-- Pivot -->
    <circle cx="20" cy="4" r="4" fill="#8B8B8B" stroke="#666" stroke-width="0.5"/>
  </svg>
</div>

<!-- Winding Key -->
<div class="winding-key" id="windingKey" title="Click to change speed" role="button" tabindex="0" aria-label="Winding key: change gear speed">
  <svg class="key-icon" width="26" height="26" viewBox="0 0 26 26" fill="none">
    <rect x="9" y="1" width="8" height="11" rx="2.5" stroke="#D4A853" stroke-width="1.5"/>
    <circle cx="13" cy="17" r="6" stroke="#D4A853" stroke-width="1.5"/>
    <circle cx="13" cy="17" r="2.5" fill="#B8860B"/>
    <line x1="13" y1="11.5" x2="13" y2="12.5" stroke="#D4A853" stroke-width="1.5"/>
    <circle cx="13" cy="17" r="4" stroke="#8B6508" stroke-width="0.4" opacity="0.5"/>
  </svg>
  <div>
    <div class="key-label">Winding Key</div>
    <div class="key-speed" id="speedDisplay">1.0x</div>
  </div>
</div>

<!-- Rivets scattered around the viewport -->
<div class="rivet" style="top:18px;left:calc(50% - 2px)"></div>
<div class="rivet" style="bottom:18px;left:calc(50% - 2px)"></div>
<div class="rivet" style="top:calc(50% - 2px);left:18px"></div>
<div class="rivet" style="top:calc(50% - 2px);right:18px"></div>
<div class="rivet" style="top:50px;left:100px"></div>
<div class="rivet" style="top:50px;right:100px"></div>
<div class="rivet" style="bottom:50px;left:100px"></div>
<div class="rivet" style="bottom:50px;right:100px"></div>
<div class="rivet" style="top:50%;left:calc(50% + 200px)"></div>
<div class="rivet" style="top:30%;left:calc(50% - 250px)"></div>

<!-- Main Mechanism -->
<div class="mechanism">
  <div class="mechanism-inner" id="mechanismInner"></div>
</div>

<!-- Content Panel -->
<div class="content-panel" id="contentPanel">
  <button class="panel-close" id="panelClose" aria-label="Close panel">&times;</button>
  <div class="panel-bracket tl"></div>
  <div class="panel-bracket br"></div>
  <div class="panel-content" id="panelContent"></div>
</div>

<!-- Intro Overlay -->
<div class="intro-overlay" id="introOverlay">
  <div class="intro-gear">
    <svg width="100" height="100" viewBox="0 0 100 100">
      <defs>
        <linearGradient id="introGrad1" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stop-color="#D4A853"/>
          <stop offset="100%" stop-color="#8B6508"/>
        </linearGradient>
        <linearGradient id="introGrad2" x1="100%" y1="0%" x2="0%" y2="100%">
          <stop offset="0%" stop-color="#C87941"/>
          <stop offset="100%" stop-color="#B8860B"/>
        </linearGradient>
      </defs>
      <g transform="translate(50,50)">
        <circle r="35" fill="none" stroke="url(#introGrad1)" stroke-width="1.2" opacity="0.6">
          <animateTransform attributeName="transform" type="rotate" from="0" to="360" dur="12s" repeatCount="indefinite"/>
        </circle>
        <circle r="22" fill="none" stroke="url(#introGrad2)" stroke-width="1.5" opacity="0.7">
          <animateTransform attributeName="transform" type="rotate" from="360" to="0" dur="8s" repeatCount="indefinite"/>
        </circle>
        <circle r="12" fill="none" stroke="#D4A853" stroke-width="0.8" opacity="0.4" stroke-dasharray="2,3">
          <animateTransform attributeName="transform" type="rotate" from="0" to="360" dur="5s" repeatCount="indefinite"/>
        </circle>
        <circle r="4" fill="#B8860B" opacity="0.8"/>
        <circle r="1.5" fill="#1A1A1E"/>
      </g>
    </svg>
  </div>
  <div class="intro-title">ANSHULL GARG</div>
  <div class="intro-sub">Software Developer &bull; Clockwork Portfolio</div>
  <div class="intro-hint">Click anywhere to engage the mechanism</div>
</div>

<script>
// ============================================================
// CONFIGURATION
// ============================================================
const GEARS = [
  { id:'main',    label:'ANSHULL\nGARG',     sub:'SOFTWARE DEV',  size:160, x:0.46, y:0.47, dir:1,  section:'main' },
  { id:'about',   label:'ABOUT',             sub:'WHO I AM',      size:110, x:0.27, y:0.33, dir:-1, section:'about',    meshTo:'main' },
  { id:'projects',label:'PROJECTS',          sub:'MY WORK',       size:118, x:0.66, y:0.30, dir:-1, section:'projects', meshTo:'main' },
  { id:'skills',  label:'SKILLS',            sub:'EXPERTISE',     size:108, x:0.63, y:0.68, dir:-1, section:'skills',   meshTo:'main' },
  { id:'exp',     label:'EXPERIENCE',        sub:'CAREER',        size: 80, x:0.14, y:0.60, dir:1,  section:'experience', meshTo:'about' },
  { id:'contact', label:'CONTACT',           sub:'REACH ME',      size: 78, x:0.80, y:0.54, dir:1,  section:'contact',  meshTo:'skills' },
];

// Meshing connections for drawing lines
const CONNECTIONS = [
  ['main','about'],['main','projects'],['main','skills'],
  ['about','exp'],['skills','contact']
];

const SECTION_CONTENT = {
  main: `
    <div class="panel-section">ANSHULL GARG</div>
    <div class="panel-divider"></div>
    <p class="panel-text">
      <strong>Software Developer at Walmart</strong><br><br>
      A precision-engineered developer who builds systems that work like clockwork --
      reliable, efficient, and elegant. Every component meshes perfectly with the next,
      creating software that runs with mechanical precision.
    </p>
    <div class="info-card">
      <div class="info-card-title">Current Role</div>
      <div class="info-card-sub">Walmart &bull; Software Developer</div>
      <div class="info-card-text">Building scalable solutions that power one of the world's largest retailers.
      Focused on high-performance systems that serve millions of users daily.</div>
    </div>
    <div class="info-card">
      <div class="info-card-title">Philosophy</div>
      <div class="info-card-sub">Precision &bull; Reliability &bull; Elegance</div>
      <div class="info-card-text">Like a master watchmaker, I believe every gear matters. Clean architecture,
      tested code, and thoughtful design create systems that stand the test of time.</div>
    </div>
    <div class="info-card">
      <div class="info-card-title">The Mechanism</div>
      <div class="info-card-sub">Click any gear to explore</div>
      <div class="info-card-text">Each gear in this clockwork mechanism represents a facet of my professional identity.
      Click on About, Projects, Skills, Experience, or Contact to learn more. Use the winding key
      in the top-left corner to change the mechanism's speed.</div>
    </div>
  `,
  about: `
    <div class="panel-section">ABOUT</div>
    <div class="panel-divider"></div>
    <p class="panel-text">
      I am <strong>Anshull Garg</strong>, a Software Developer at <strong>Walmart</strong> who thrives on building
      robust, scalable applications. With a passion for clean code and elegant architecture,
      I approach every problem like a clockmaker approaches a new timepiece -- with patience,
      precision, and an eye for how all the pieces fit together.
    </p>
    <div class="info-card">
      <div class="info-card-title">Background</div>
      <div class="info-card-text">Computer Science graduate with deep expertise in full-stack development.
      Experienced in designing systems that handle enterprise-scale workloads while maintaining
      code quality and developer experience.</div>
    </div>
    <div class="info-card">
      <div class="info-card-title">What Drives Me</div>
      <div class="info-card-text">The satisfaction of seeing complex systems work seamlessly.
      Whether it is optimizing a database query or crafting a pixel-perfect UI, I find joy in
      the details that make software truly excellent.</div>
    </div>
    <div class="info-card">
      <div class="info-card-title">Beyond Code</div>
      <div class="info-card-text">When not building software, I explore new technologies, contribute to
      open-source projects, and stay curious about the ever-evolving landscape of software engineering.</div>
    </div>
  `,
  projects: `
    <div class="panel-section">PROJECTS</div>
    <div class="panel-divider"></div>
    <div class="info-card">
      <div class="info-card-title">E-Commerce Platform Engine</div>
      <div class="info-card-sub">React &bull; Node.js &bull; Microservices</div>
      <div class="info-card-text">Architected a high-throughput order processing system capable of handling
      thousands of transactions per second. Implemented event-driven architecture with real-time
      inventory synchronization across distributed warehouses.</div>
    </div>
    <div class="info-card">
      <div class="info-card-title">Real-Time Analytics Dashboard</div>
      <div class="info-card-sub">TypeScript &bull; D3.js &bull; WebSocket</div>
      <div class="info-card-text">Built a live metrics dashboard processing millions of data points.
      Features interactive visualizations, anomaly detection alerts, and customizable reporting
      with sub-second refresh rates.</div>
    </div>
    <div class="info-card">
      <div class="info-card-title">Supply Chain Optimizer</div>
      <div class="info-card-sub">Python &bull; ML &bull; REST API</div>
      <div class="info-card-text">Developed a machine learning-powered tool to optimize supply chain logistics,
      reducing delivery times by 18% and cutting operational costs. Integrated with existing
      ERP systems via robust API layer.</div>
    </div>
    <div class="info-card">
      <div class="info-card-title">Developer Productivity Toolkit</div>
      <div class="info-card-sub">CLI &bull; Automation &bull; CI/CD</div>
      <div class="info-card-text">Created an internal suite of developer tools that automated repetitive tasks,
      standardized deployment pipelines, and improved team velocity by 30%. Adopted across
      multiple engineering teams.</div>
    </div>
  `,
  skills: `
    <div class="panel-section">SKILLS</div>
    <div class="panel-divider"></div>
    <p class="panel-text" style="margin-bottom:28px">Each skill is a gear in the mechanism -- precisely calibrated and essential to the whole.</p>
    <div id="skillsContainer">
      <div class="skill-row"><span class="skill-name">JavaScript</span><div class="skill-bar"><div class="skill-fill" data-width="95"></div></div><span class="skill-pct">95%</span></div>
      <div class="skill-row"><span class="skill-name">TypeScript</span><div class="skill-bar"><div class="skill-fill" data-width="90"></div></div><span class="skill-pct">90%</span></div>
      <div class="skill-row"><span class="skill-name">React</span><div class="skill-bar"><div class="skill-fill" data-width="92"></div></div><span class="skill-pct">92%</span></div>
      <div class="skill-row"><span class="skill-name">Node.js</span><div class="skill-bar"><div class="skill-fill" data-width="88"></div></div><span class="skill-pct">88%</span></div>
      <div class="skill-row"><span class="skill-name">Python</span><div class="skill-bar"><div class="skill-fill" data-width="85"></div></div><span class="skill-pct">85%</span></div>
      <div class="skill-row"><span class="skill-name">Java</span><div class="skill-bar"><div class="skill-fill" data-width="82"></div></div><span class="skill-pct">82%</span></div>
      <div class="skill-row"><span class="skill-name">SQL / NoSQL</span><div class="skill-bar"><div class="skill-fill" data-width="87"></div></div><span class="skill-pct">87%</span></div>
      <div class="skill-row"><span class="skill-name">AWS / Cloud</span><div class="skill-bar"><div class="skill-fill" data-width="83"></div></div><span class="skill-pct">83%</span></div>
      <div class="skill-row"><span class="skill-name">Docker / K8s</span><div class="skill-bar"><div class="skill-fill" data-width="80"></div></div><span class="skill-pct">80%</span></div>
      <div class="skill-row"><span class="skill-name">System Design</span><div class="skill-bar"><div class="skill-fill" data-width="88"></div></div><span class="skill-pct">88%</span></div>
      <div class="skill-row"><span class="skill-name">CI / CD</span><div class="skill-bar"><div class="skill-fill" data-width="85"></div></div><span class="skill-pct">85%</span></div>
      <div class="skill-row"><span class="skill-name">GraphQL</span><div class="skill-bar"><div class="skill-fill" data-width="78"></div></div><span class="skill-pct">78%</span></div>
    </div>
  `,
  experience: `
    <div class="panel-section">EXPERIENCE</div>
    <div class="panel-divider"></div>
    <div class="info-card">
      <div class="info-card-title">Software Developer</div>
      <div class="info-card-sub">Walmart &bull; Present</div>
      <div class="info-card-text">
        Developing and maintaining large-scale distributed systems serving millions of customers.
        Key contributions include performance optimization of critical services, implementing
        new microservices architecture, and mentoring junior developers.<br><br>
        &bull; Reduced API response times by 40% through caching and query optimization<br>
        &bull; Led migration of legacy monolith to microservices architecture<br>
        &bull; Implemented CI/CD pipelines reducing deployment time from hours to minutes<br>
        &bull; Collaborated with cross-functional teams across multiple time zones
      </div>
    </div>
    <div class="info-card">
      <div class="info-card-title">Software Engineering Intern</div>
      <div class="info-card-sub">Previous Role</div>
      <div class="info-card-text">
        Built foundational skills in agile development, code review practices, and production-grade
        software delivery. Contributed to customer-facing features used by thousands of users daily.<br><br>
        &bull; Developed RESTful APIs and integrated third-party services<br>
        &bull; Wrote comprehensive unit and integration tests<br>
        &bull; Participated in sprint planning and retrospectives
      </div>
    </div>
  `,
  contact: `
    <div class="panel-section">CONTACT</div>
    <div class="panel-divider"></div>
    <p class="panel-text" style="margin-bottom:28px">Every great mechanism needs a point of connection. Reach out through any of these channels.</p>
    <a class="contact-link" href="mailto:anshull.garg@gmail.com">
      <div class="contact-icon">&#9993;</div>
      <div><div class="contact-label">Email</div><div class="contact-value">anshull.garg@gmail.com</div></div>
    </a>
    <a class="contact-link" href="https://linkedin.com/in/anshullgarg" target="_blank" rel="noopener">
      <div class="contact-icon">in</div>
      <div><div class="contact-label">LinkedIn</div><div class="contact-value">linkedin.com/in/anshullgarg</div></div>
    </a>
    <a class="contact-link" href="https://github.com/anshullgarg" target="_blank" rel="noopener">
      <div class="contact-icon">&lt;/&gt;</div>
      <div><div class="contact-label">GitHub</div><div class="contact-value">github.com/anshullgarg</div></div>
    </a>
    <a class="contact-link" href="#">
      <div class="contact-icon">&#9742;</div>
      <div><div class="contact-label">Location</div><div class="contact-value">Available for collaboration</div></div>
    </a>
  `
};

// ============================================================
// GEAR SVG GENERATOR
// ============================================================
function generateGearSVG(radius, numTeeth, toothDepth, id) {
  const innerR = radius - toothDepth;
  const anglePerTooth = (2 * Math.PI) / numTeeth;

  let path = '';
  for (let i = 0; i < numTeeth; i++) {
    const a0 = i * anglePerTooth;
    const a1 = a0 + anglePerTooth * 0.12;
    const a2 = a0 + anglePerTooth * 0.18;
    const a3 = a0 + anglePerTooth * 0.50;
    const a4 = a0 + anglePerTooth * 0.56;
    const a5 = a0 + anglePerTooth;

    const p = (angle, r) => `${(Math.cos(angle) * r).toFixed(2)},${(Math.sin(angle) * r).toFixed(2)}`;

    if (i === 0) path += `M${p(a0, innerR)} `;
    // Rise to tooth
    path += `L${p(a1, innerR)} L${p(a2, radius)} `;
    // Tooth top
    path += `L${p(a3, radius)} `;
    // Fall from tooth
    path += `L${p(a4, innerR)} `;
    // Valley
    path += `L${p(a5, innerR)} `;
  }
  path += 'Z';

  const holeR = innerR * 0.26;
  const crossW = holeR * 0.38;
  const svgSize = (radius + 12) * 2;
  const center = radius + 12;

  // Spoke positions for decorative elements
  const spokeCount = Math.min(6, Math.max(3, Math.floor(numTeeth / 4)));
  let spokes = '';
  for (let i = 0; i < spokeCount; i++) {
    const angle = (2 * Math.PI / spokeCount) * i;
    const x1 = center + Math.cos(angle) * (holeR + 8);
    const y1 = center + Math.sin(angle) * (holeR + 8);
    const x2 = center + Math.cos(angle) * (innerR * 0.82);
    const y2 = center + Math.sin(angle) * (innerR * 0.82);
    spokes += `<line x1="${x1.toFixed(1)}" y1="${y1.toFixed(1)}" x2="${x2.toFixed(1)}" y2="${y2.toFixed(1)}"
      stroke="#7A5A08" stroke-width="0.6" opacity="0.25"/>`;
  }

  return `<svg class="gear-svg" width="${svgSize}" height="${svgSize}" viewBox="0 0 ${svgSize} ${svgSize}">
    <defs>
      <linearGradient id="brassGrad_${id}" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stop-color="#DAB155"/>
        <stop offset="25%" stop-color="#B8860B"/>
        <stop offset="50%" stop-color="#C89B3C"/>
        <stop offset="75%" stop-color="#A07A0A"/>
        <stop offset="100%" stop-color="#8B6508"/>
      </linearGradient>
      <radialGradient id="brassRadial_${id}" cx="38%" cy="33%">
        <stop offset="0%" stop-color="#ECD070"/>
        <stop offset="40%" stop-color="#C49A2A"/>
        <stop offset="80%" stop-color="#8B6508"/>
        <stop offset="100%" stop-color="#6A4A06"/>
      </radialGradient>
      <radialGradient id="screwGrad_${id}" cx="35%" cy="30%">
        <stop offset="0%" stop-color="#BBB"/>
        <stop offset="50%" stop-color="#888"/>
        <stop offset="100%" stop-color="#555"/>
      </radialGradient>
      <filter id="gearShadow_${id}">
        <feDropShadow dx="0" dy="3" stdDeviation="4" flood-color="#000" flood-opacity="0.55"/>
      </filter>
    </defs>
    <g class="gear-body" filter="url(#gearShadow_${id})">
      <!-- Main gear body -->
      <path d="${path}" transform="translate(${center},${center})" fill="url(#brassGrad_${id})" stroke="#6A4A08" stroke-width="0.8"/>

      <!-- Outer engraved ring -->
      <circle cx="${center}" cy="${center}" r="${innerR * 0.92}" fill="none" stroke="#9A7A20" stroke-width="0.6" opacity="0.35"/>

      <!-- Inner ring -->
      <circle cx="${center}" cy="${center}" r="${innerR * 0.78}" fill="none" stroke="#A08A30" stroke-width="0.5" opacity="0.3"/>

      <!-- Engraved dotted circle -->
      <circle cx="${center}" cy="${center}" r="${innerR * 0.62}" fill="none" stroke="#7A5A08" stroke-width="0.5" opacity="0.3" stroke-dasharray="2,4"/>

      <!-- Decorative spokes -->
      ${spokes}

      <!-- Center hub -->
      <circle cx="${center}" cy="${center}" r="${holeR + 6}" fill="url(#brassRadial_${id})" stroke="#5A4008" stroke-width="0.8"/>
      <circle cx="${center}" cy="${center}" r="${holeR + 6}" fill="none" stroke="#DAB155" stroke-width="0.3" opacity="0.3"/>

      <!-- Cross cutout -->
      <rect x="${center - crossW / 2}" y="${center - holeR}" width="${crossW}" height="${holeR * 2}" rx="1.5" fill="#12121A" opacity="0.85"/>
      <rect x="${center - holeR}" y="${center - crossW / 2}" width="${holeR * 2}" height="${crossW}" rx="1.5" fill="#12121A" opacity="0.85"/>

      <!-- Center screw -->
      <circle cx="${center}" cy="${center}" r="${holeR * 0.38}" fill="url(#screwGrad_${id})" stroke="#444" stroke-width="0.5"/>
      <!-- Screw slot -->
      <line x1="${center - holeR * 0.26}" y1="${center}" x2="${center + holeR * 0.26}" y2="${center}"
        stroke="#333" stroke-width="1.8" stroke-linecap="round"/>

      <!-- Decorative rivets on the gear face -->
      ${generateRivets(center, innerR * 0.68, Math.min(numTeeth, 6), holeR * 0.14)}
    </g>
  </svg>`;
}

function generateRivets(cx, r, count, rivetR) {
  let rivets = '';
  for (let i = 0; i < count; i++) {
    const angle = (2 * Math.PI / count) * i;
    const x = cx + Math.cos(angle) * r;
    const y = cx + Math.sin(angle) * r;
    rivets += `<circle cx="${x.toFixed(1)}" cy="${y.toFixed(1)}" r="${rivetR.toFixed(1)}"
      fill="#8B8B8B" stroke="#666" stroke-width="0.4" opacity="0.5"/>
      <circle cx="${(x - rivetR * 0.25).toFixed(1)}" cy="${(y - rivetR * 0.25).toFixed(1)}" r="${(rivetR * 0.25).toFixed(1)}"
      fill="#CCC" opacity="0.25"/>`;
  }
  return rivets;
}

// Simple gear for background decoration
function generateSimpleGearSVG(radius, numTeeth) {
  const innerR = radius * 0.85;
  const anglePerTooth = (2 * Math.PI) / numTeeth;
  let path = '';
  for (let i = 0; i < numTeeth; i++) {
    const a0 = i * anglePerTooth;
    const a1 = a0 + anglePerTooth * 0.15;
    const a2 = a0 + anglePerTooth * 0.50;
    const a3 = a0 + anglePerTooth * 0.55;
    const a4 = a0 + anglePerTooth;
    const p = (a, r) => `${(Math.cos(a) * r).toFixed(1)},${(Math.sin(a) * r).toFixed(1)}`;
    if (i === 0) path += `M${p(a0, innerR)} `;
    path += `L${p(a1, innerR)} L${p(a1, radius)} L${p(a2, radius)} L${p(a3, innerR)} L${p(a4, innerR)} `;
  }
  path += 'Z';
  const s = (radius + 4) * 2;
  const c = radius + 4;
  return `<svg width="${s}" height="${s}" viewBox="0 0 ${s} ${s}"><path d="${path}" transform="translate(${c},${c})" fill="#8B8B8B" stroke="none"/><circle cx="${c}" cy="${c}" r="${radius * 0.3}" fill="#1A1A1E"/></svg>`;
}

// ============================================================
// BUILD BACKGROUND DECORATIVE GEARS
// ============================================================
function buildBgGears() {
  const container = document.getElementById('bgGears');
  container.innerHTML = '';
  const bgGearDefs = [
    { x: '8%',  y: '15%', r: 50, t: 14, cls: 'spin-slow' },
    { x: '92%', y: '80%', r: 40, t: 12, cls: 'spin-slow-r' },
    { x: '5%',  y: '85%', r: 35, t: 10, cls: 'spin-slow' },
    { x: '88%', y: '12%', r: 45, t: 13, cls: 'spin-slow-r' },
    { x: '50%', y: '92%', r: 30, t: 9,  cls: 'spin-slow' },
  ];
  bgGearDefs.forEach(g => {
    const div = document.createElement('div');
    div.className = `bg-gear ${g.cls}`;
    div.style.cssText = `position:fixed;left:${g.x};top:${g.y};transform:translate(-50%,-50%)`;
    div.innerHTML = generateSimpleGearSVG(g.r, g.t);
    container.appendChild(div);
  });
}

// ============================================================
// BUILD THE MECHANISM
// ============================================================
const mechanismEl = document.getElementById('mechanismInner');
let selectedGear = null;
let currentSpeed = 1;
const gearPositions = {}; // store px positions for connection lines

function buildGears() {
  mechanismEl.innerHTML = '';

  GEARS.forEach(g => {
    const wrapper = document.createElement('div');
    wrapper.className = `gear-wrapper ${g.dir === 1 ? 'gear-spin-cw' : 'gear-spin-ccw'} ${g.size > 120 ? 'size-lg' : g.size < 90 ? 'size-sm' : 'size-md'}`;
    wrapper.dataset.section = g.section;
    wrapper.dataset.id = g.id;

    const px = g.x * window.innerWidth;
    const py = g.y * window.innerHeight;
    wrapper.style.left = px + 'px';
    wrapper.style.top = py + 'px';

    gearPositions[g.id] = { x: px, y: py, r: g.size };

    const numTeeth = Math.round(g.size * 0.16);
    const toothDepth = g.size * 0.13;

    wrapper.innerHTML = generateGearSVG(g.size, numTeeth, toothDepth, g.id);

    // Label overlay (does not rotate)
    const labelWrap = document.createElement('div');
    labelWrap.className = 'gear-label-wrap';
    const svgSize = (g.size + 12) * 2;
    labelWrap.style.width = svgSize + 'px';
    labelWrap.style.height = svgSize + 'px';

    const fontSize = g.size > 120 ? 19 : g.size > 90 ? 14 : 11;
    labelWrap.innerHTML = `<div class="gear-label" style="font-size:${fontSize}px">
      ${g.label.replace('\n', '<br>')}<span class="gear-sublabel">${g.sub}</span>
    </div>`;
    wrapper.appendChild(labelWrap);

    wrapper.addEventListener('click', () => selectGear(g.section, wrapper));
    mechanismEl.appendChild(wrapper);
  });

  drawConnections();
}

// ============================================================
// DRAW CONNECTION LINES BETWEEN MESHING GEARS
// ============================================================
function drawConnections() {
  const svg = document.getElementById('gearConnections');
  svg.setAttribute('width', window.innerWidth);
  svg.setAttribute('height', window.innerHeight);
  let lines = `<defs>
    <linearGradient id="connGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#5A5A5A" stop-opacity="0"/>
      <stop offset="50%" stop-color="#5A5A5A" stop-opacity="0.25"/>
      <stop offset="100%" stop-color="#5A5A5A" stop-opacity="0"/>
    </linearGradient>
  </defs>`;

  CONNECTIONS.forEach(([a, b]) => {
    const pa = gearPositions[a];
    const pb = gearPositions[b];
    if (!pa || !pb) return;
    // Draw a subtle line between gear centers
    lines += `<line x1="${pa.x}" y1="${pa.y}" x2="${pb.x}" y2="${pb.y}"
      stroke="url(#connGrad)" stroke-width="1" stroke-dasharray="4,6" opacity="0.4"/>`;
    // Draw a small circle at the midpoint (like a pin)
    const mx = (pa.x + pb.x) / 2;
    const my = (pa.y + pb.y) / 2;
    lines += `<circle cx="${mx}" cy="${my}" r="2.5" fill="#5A5A5A" opacity="0.3"/>`;
  });

  svg.innerHTML = lines;
}

// ============================================================
// GEAR SELECTION
// ============================================================
function selectGear(section, el) {
  // Deselect previous
  document.querySelectorAll('.gear-wrapper.selected').forEach(g => g.classList.remove('selected'));

  if (el) el.classList.add('selected');
  selectedGear = section;

  // Slow other gears
  mechanismEl.classList.add('panel-active');

  // Show panel
  const panel = document.getElementById('contentPanel');
  const content = document.getElementById('panelContent');
  content.innerHTML = SECTION_CONTENT[section] || '';
  panel.classList.add('open');

  // Scroll panel to top
  panel.scrollTop = 0;

  // Animate skill bars if skills section
  if (section === 'skills') {
    setTimeout(() => {
      document.querySelectorAll('.skill-fill').forEach(bar => {
        bar.style.width = bar.dataset.width + '%';
      });
    }, 350);
  }

  // Mechanical click flash effect
  if (el) {
    el.style.transition = 'none';
    el.style.filter = 'brightness(2.5) drop-shadow(0 0 40px rgba(212,168,83,0.8))';
    requestAnimationFrame(() => {
      requestAnimationFrame(() => {
        el.style.transition = 'filter 0.4s ease';
        el.style.filter = '';
      });
    });
  }
}

function closePanel() {
  document.getElementById('contentPanel').classList.remove('open');
  document.querySelectorAll('.gear-wrapper.selected').forEach(g => g.classList.remove('selected'));
  mechanismEl.classList.remove('panel-active');
  selectedGear = null;
}

document.getElementById('panelClose').addEventListener('click', closePanel);
document.addEventListener('keydown', e => { if (e.key === 'Escape') closePanel(); });

// Close panel when clicking on mechanism background (not on a gear)
mechanismEl.addEventListener('click', e => {
  if (e.target === mechanismEl && selectedGear) closePanel();
});

// ============================================================
// WINDING KEY - SPEED CONTROL
// ============================================================
const speeds = [0.3, 0.5, 1, 1.5, 2, 3];
let speedIdx = 2;

function handleWindingKey() {
  speedIdx = (speedIdx + 1) % speeds.length;
  currentSpeed = speeds[speedIdx];
  document.documentElement.style.setProperty('--speed', currentSpeed);
  document.getElementById('speedDisplay').textContent = currentSpeed.toFixed(1) + 'x';

  // Visual feedback - brief glow
  const key = document.getElementById('windingKey');
  key.style.borderColor = '#D4A853';
  key.style.boxShadow = '0 2px 20px rgba(184,134,11,0.3)';
  setTimeout(() => {
    key.style.borderColor = '';
    key.style.boxShadow = '';
  }, 400);
}

document.getElementById('windingKey').addEventListener('click', handleWindingKey);
document.getElementById('windingKey').addEventListener('keydown', e => {
  if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); handleWindingKey(); }
});

// ============================================================
// CLOCK FACE TICK MARKS
// ============================================================
function buildClockFace() {
  const frame = document.getElementById('clockFrame');
  frame.innerHTML = '';
  const cx = window.innerWidth / 2;
  const cy = window.innerHeight / 2;
  const r = Math.min(cx, cy) - 15;

  for (let i = 0; i < 60; i++) {
    const angle = (i / 60) * 2 * Math.PI - Math.PI / 2;
    const isMajor = i % 5 === 0;
    const len = isMajor ? 22 : 8;
    const w = isMajor ? 2 : 1;
    const x1 = cx + Math.cos(angle) * r;
    const y1 = cy + Math.sin(angle) * r;
    const x2 = cx + Math.cos(angle) * (r - len);
    const y2 = cy + Math.sin(angle) * (r - len);

    const tick = document.createElement('div');
    tick.className = 'tick-mark';
    const dx = x2 - x1;
    const dy = y2 - y1;
    const length = Math.sqrt(dx * dx + dy * dy);
    const angleDeg = Math.atan2(dy, dx) * (180 / Math.PI);

    tick.style.width = length + 'px';
    tick.style.height = w + 'px';
    tick.style.left = x1 + 'px';
    tick.style.top = y1 + 'px';
    tick.style.transform = `rotate(${angleDeg}deg)`;
    tick.style.transformOrigin = '0 50%';
    if (isMajor) tick.style.opacity = '0.45';
    frame.appendChild(tick);
  }
}

// ============================================================
// STEAM PARTICLES
// ============================================================
function createSteamParticles() {
  const container = document.getElementById('steamContainer');
  const sources = [
    { x: '12%', baseY: 88 },
    { x: '30%', baseY: 92 },
    { x: '55%', baseY: 90 },
    { x: '75%', baseY: 87 },
    { x: '90%', baseY: 91 },
  ];

  function spawnSteam() {
    if (document.hidden) { setTimeout(spawnSteam, 800); return; }
    const src = sources[Math.floor(Math.random() * sources.length)];
    const particle = document.createElement('div');
    particle.className = 'steam';
    particle.style.left = src.x;
    particle.style.bottom = (100 - src.baseY + Math.random() * 4) + '%';
    const size = (5 + Math.random() * 12) + 'px';
    particle.style.width = size;
    particle.style.height = size;
    particle.style.background = `radial-gradient(circle, rgba(${180 + Math.random() * 40},${180 + Math.random() * 40},${180 + Math.random() * 40},${0.08 + Math.random() * 0.1}), transparent)`;
    particle.style.animationDuration = (5 + Math.random() * 5) + 's';
    container.appendChild(particle);
    setTimeout(() => particle.remove(), 10000);
    setTimeout(spawnSteam, 400 + Math.random() * 600);
  }
  spawnSteam();
}

// ============================================================
// INTRO
// ============================================================
let introGone = false;
function dismissIntro() {
  if (introGone) return;
  introGone = true;
  document.getElementById('introOverlay').classList.add('hidden');
}
document.getElementById('introOverlay').addEventListener('click', dismissIntro);
setTimeout(dismissIntro, 4500);

// ============================================================
// RESPONSIVE REBUILD
// ============================================================
let resizeTimeout;
window.addEventListener('resize', () => {
  clearTimeout(resizeTimeout);
  resizeTimeout = setTimeout(() => {
    buildGears();
    buildClockFace();
    if (selectedGear) {
      const el = document.querySelector(`[data-section="${selectedGear}"]`);
      if (el) el.classList.add('selected');
    }
  }, 250);
});

// ============================================================
// KEYBOARD NAVIGATION FOR GEARS
// ============================================================
document.addEventListener('keydown', e => {
  if (e.key >= '1' && e.key <= '6') {
    const idx = parseInt(e.key) - 1;
    if (GEARS[idx]) {
      const el = document.querySelector(`[data-id="${GEARS[idx].id}"]`);
      if (el) selectGear(GEARS[idx].section, el);
    }
  }
});

// ============================================================
// INIT
// ============================================================
buildGears();
buildClockFace();
buildBgGears();
createSteamParticles();
</script>
</body>
</html>
